(function(){var q=this,Z=q._,M={},A=Array.prototype,T=Object.prototype,m=A.slice,Q=A.unshift,R=T.toString,I=T.hasOwnProperty,O=A.forEach,H=A.map,e=A.reduce,h=A.reduceRight,k=A.filter,y=A.every,C=A.some,J=A.indexOf,U=A.lastIndexOf;T=Array.isArray;var aa=Object.keys,n=Function.prototype.bind,l=function(i){return new B(i)};typeof module!=="undefined"&&module.exports?(module.exports=l,l._=l):q._=l;l.VERSION="1.1.7";var D=l.each=l.forEach=function(i,r,z){if(i!=null)if(O&&i.forEach===O)i.forEach(r,z);else if(i.length===
+i.length)for(var F=0,P=i.length;F<P;F++){if(F in i&&r.call(z,i[F],F,i)===M)break}else for(F in i)if(I.call(i,F)&&r.call(z,i[F],F,i)===M)break};l.map=function(i,r,z){var F=[];if(i==null)return F;if(H&&i.map===H)return i.map(r,z);D(i,function(P,X,ga){F[F.length]=r.call(z,P,X,ga)});return F};l.reduce=l.foldl=l.inject=function(i,r,z,F){var P=z!==void 0;i==null&&(i=[]);if(e&&i.reduce===e)return F&&(r=l.bind(r,F)),P?i.reduce(r,z):i.reduce(r);D(i,function(X,ga,ba){P?z=r.call(F,z,X,ga,ba):(z=X,P=true)});
if(!P)throw new TypeError("Reduce of empty array with no initial value");return z};l.reduceRight=l.foldr=function(i,r,z,F){i==null&&(i=[]);if(h&&i.reduceRight===h)return F&&(r=l.bind(r,F)),z!==void 0?i.reduceRight(r,z):i.reduceRight(r);i=(l.isArray(i)?i.slice():l.toArray(i)).reverse();return l.reduce(i,r,z,F)};l.find=l.detect=function(i,r,z){var F;v(i,function(P,X,ga){if(r.call(z,P,X,ga))return F=P,true});return F};l.filter=l.select=function(i,r,z){var F=[];if(i==null)return F;if(k&&i.filter===k)return i.filter(r,
z);D(i,function(P,X,ga){r.call(z,P,X,ga)&&(F[F.length]=P)});return F};l.reject=function(i,r,z){var F=[];if(i==null)return F;D(i,function(P,X,ga){r.call(z,P,X,ga)||(F[F.length]=P)});return F};l.every=l.all=function(i,r,z){var F=true;if(i==null)return F;if(y&&i.every===y)return i.every(r,z);D(i,function(P,X,ga){if(!(F=F&&r.call(z,P,X,ga)))return M});return F};var v=l.some=l.any=function(i,r,z){r=r||l.identity;var F=false;if(i==null)return F;if(C&&i.some===C)return i.some(r,z);D(i,function(P,X,ga){if(F|=
r.call(z,P,X,ga))return M});return!!F};l.include=l.contains=function(i,r){var z=false;if(i==null)return z;if(J&&i.indexOf===J)return i.indexOf(r)!=-1;v(i,function(F){if(z=F===r)return true});return z};l.invoke=function(i,r){var z=m.call(arguments,2);return l.map(i,function(F){return(r.call?r||F:F[r]).apply(F,z)})};l.pluck=function(i,r){return l.map(i,function(z){return z[r]})};l.max=function(i,r,z){if(!r&&l.isArray(i))return Math.max.apply(Math,i);var F={computed:-Infinity};D(i,function(P,X,ga){X=
r?r.call(z,P,X,ga):P;X>=F.computed&&(F={value:P,computed:X})});return F.value};l.min=function(i,r,z){if(!r&&l.isArray(i))return Math.min.apply(Math,i);var F={computed:Infinity};D(i,function(P,X,ga){X=r?r.call(z,P,X,ga):P;X<F.computed&&(F={value:P,computed:X})});return F.value};l.sortBy=function(i,r,z){return l.pluck(l.map(i,function(F,P,X){return{value:F,criteria:r.call(z,F,P,X)}}).sort(function(F,P){var X=F.criteria,ga=P.criteria;return X<ga?-1:X>ga?1:0}),"value")};l.groupBy=function(i,r){var z=
{};D(i,function(F,P){var X=r(F,P);(z[X]||(z[X]=[])).push(F)});return z};l.sortedIndex=function(i,r,z){z||(z=l.identity);for(var F=0,P=i.length;F<P;){var X=F+P>>1;z(i[X])<z(r)?F=X+1:P=X}return F};l.toArray=function(i){if(!i)return[];if(i.toArray)return i.toArray();if(l.isArray(i))return m.call(i);if(l.isArguments(i))return m.call(i);return l.values(i)};l.size=function(i){return l.toArray(i).length};l.first=l.head=function(i,r,z){return r!=null&&!z?m.call(i,0,r):i[0]};l.rest=l.tail=function(i,r,z){return m.call(i,
r==null||z?1:r)};l.last=function(i){return i[i.length-1]};l.compact=function(i){return l.filter(i,function(r){return!!r})};l.flatten=function(i){return l.reduce(i,function(r,z){if(l.isArray(z))return r.concat(l.flatten(z));r[r.length]=z;return r},[])};l.without=function(i){return l.difference(i,m.call(arguments,1))};l.uniq=l.unique=function(i,r){return l.reduce(i,function(z,F,P){if(0==P||(r===true?l.last(z)!=F:!l.include(z,F)))z[z.length]=F;return z},[])};l.union=function(){return l.uniq(l.flatten(arguments))};
l.intersection=l.intersect=function(i){var r=m.call(arguments,1);return l.filter(l.uniq(i),function(z){return l.every(r,function(F){return l.indexOf(F,z)>=0})})};l.difference=function(i,r){return l.filter(i,function(z){return!l.include(r,z)})};l.zip=function(){for(var i=m.call(arguments),r=l.max(l.pluck(i,"length")),z=Array(r),F=0;F<r;F++)z[F]=l.pluck(i,""+F);return z};l.indexOf=function(i,r,z){if(i==null)return-1;var F;if(z)return z=l.sortedIndex(i,r),i[z]===r?z:-1;if(J&&i.indexOf===J)return i.indexOf(r);
z=0;for(F=i.length;z<F;z++)if(i[z]===r)return z;return-1};l.lastIndexOf=function(i,r){if(i==null)return-1;if(U&&i.lastIndexOf===U)return i.lastIndexOf(r);for(var z=i.length;z--;)if(i[z]===r)return z;return-1};l.range=function(i,r,z){arguments.length<=1&&(r=i||0,i=0);z=arguments[2]||1;for(var F=Math.max(Math.ceil((r-i)/z),0),P=0,X=Array(F);P<F;){X[P++]=i;i+=z}return X};l.bind=function(i,r){if(i.bind===n&&n)return n.apply(i,m.call(arguments,1));var z=m.call(arguments,2);return function(){return i.apply(r,
z.concat(m.call(arguments)))}};l.bindAll=function(i){var r=m.call(arguments,1);r.length==0&&(r=l.functions(i));D(r,function(z){i[z]=l.bind(i[z],i)});return i};l.memoize=function(i,r){var z={};r||(r=l.identity);return function(){var F=r.apply(this,arguments);return I.call(z,F)?z[F]:z[F]=i.apply(this,arguments)}};l.delay=function(i,r){var z=m.call(arguments,2);return setTimeout(function(){return i.apply(i,z)},r)};l.defer=function(i){return l.delay.apply(l,[i,1].concat(m.call(arguments,1)))};var p=function(i,
r,z){var F;return function(){var P=this,X=arguments,ga=function(){F=null;i.apply(P,X)};z&&clearTimeout(F);if(z||!F)F=setTimeout(ga,r)}};l.throttle=function(i,r){return p(i,r,false)};l.debounce=function(i,r){return p(i,r,true)};l.once=function(i){var r=false,z;return function(){if(r)return z;r=true;return z=i.apply(this,arguments)}};l.wrap=function(i,r){return function(){var z=[i].concat(m.call(arguments));return r.apply(this,z)}};l.compose=function(){var i=m.call(arguments);return function(){for(var r=
m.call(arguments),z=i.length-1;z>=0;z--)r=[i[z].apply(this,r)];return r[0]}};l.after=function(i,r){return function(){if(--i<1)return r.apply(this,arguments)}};l.keys=aa||function(i){if(i!==Object(i))throw new TypeError("Invalid object");var r=[],z;for(z in i)I.call(i,z)&&(r[r.length]=z);return r};l.values=function(i){return l.map(i,l.identity)};l.functions=l.methods=function(i){var r=[],z;for(z in i)l.isFunction(i[z])&&r.push(z);return r.sort()};l.extend=function(i){D(m.call(arguments,1),function(r){for(var z in r)r[z]!==
void 0&&(i[z]=r[z])});return i};l.defaults=function(i){D(m.call(arguments,1),function(r){for(var z in r)i[z]==null&&(i[z]=r[z])});return i};l.clone=function(i){return l.isArray(i)?i.slice():l.extend({},i)};l.tap=function(i,r){r(i);return i};l.isEqual=function(i,r){if(i===r)return true;var z=typeof i;if(z!=typeof r)return false;if(i==r)return true;if(!i&&r||i&&!r)return false;if(i._chain)i=i._wrapped;if(r._chain)r=r._wrapped;if(i.isEqual)return i.isEqual(r);if(r.isEqual)return r.isEqual(i);if(l.isDate(i)&&
l.isDate(r))return i.getTime()===r.getTime();if(l.isNaN(i)&&l.isNaN(r))return false;if(l.isRegExp(i)&&l.isRegExp(r))return i.source===r.source&&i.global===r.global&&i.ignoreCase===r.ignoreCase&&i.multiline===r.multiline;if(z!=="object")return false;if(i.length&&i.length!==r.length)return false;z=l.keys(i);var F=l.keys(r);if(z.length!=F.length)return false;for(var P in i)if(!(P in r)||!l.isEqual(i[P],r[P]))return false;return true};l.isEmpty=function(i){if(l.isArray(i)||l.isString(i))return i.length===
0;for(var r in i)if(I.call(i,r))return false;return true};l.isElement=function(i){return!!(i&&i.nodeType==1)};l.isArray=T||function(i){return R.call(i)==="[object Array]"};l.isObject=function(i){return i===Object(i)};l.isArguments=function(i){return!(!i||!I.call(i,"callee"))};l.isFunction=function(i){return!(!i||!i.constructor||!i.call||!i.apply)};l.isString=function(i){return!!(i===""||i&&i.charCodeAt&&i.substr)};l.isNumber=function(i){return!!(i===0||i&&i.toExponential&&i.toFixed)};l.isNaN=function(i){return i!==
i};l.isBoolean=function(i){return i===true||i===false};l.isDate=function(i){return!(!i||!i.getTimezoneOffset||!i.setUTCFullYear)};l.isRegExp=function(i){return!(!i||!i.test||!i.exec||!(i.ignoreCase||i.ignoreCase===false))};l.isNull=function(i){return i===null};l.isUndefined=function(i){return i===void 0};l.noConflict=function(){q._=Z;return this};l.identity=function(i){return i};l.times=function(i,r,z){for(var F=0;F<i;F++)r.call(z,F)};l.mixin=function(i){D(l.functions(i),function(r){N(r,l[r]=i[r])})};
var x=0;l.uniqueId=function(i){var r=x++;return i?i+r:r};l.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};l.template=function(i,r){var z=l.templateSettings;z="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+i.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(z.interpolate,function(F,P){return"',"+P.replace(/\\'/g,"'")+",'"}).replace(z.evaluate||null,function(F,P){return"');"+P.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,
"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";z=new Function("obj",z);return r?z(r):z};var B=function(i){this._wrapped=i};l.prototype=B.prototype;var E=function(i,r){return r?l(i).chain():i},N=function(i,r){B.prototype[i]=function(){var z=m.call(arguments);Q.call(z,this._wrapped);return E(r.apply(l,z),this._chain)}};l.mixin(l);D(["pop","push","reverse","shift","sort","splice","unshift"],function(i){var r=A[i];B.prototype[i]=function(){r.apply(this._wrapped,arguments);
return E(this._wrapped,this._chain)}});D(["concat","join","slice"],function(i){var r=A[i];B.prototype[i]=function(){return E(r.apply(this._wrapped,arguments),this._chain)}});B.prototype.chain=function(){this._chain=true;return this};B.prototype.value=function(){return this._wrapped}})();(function(){var q=this,Z=q.Backbone,M;M=typeof exports!=="undefined"?exports:q.Backbone={};M.VERSION="0.5.3";var A=q._;if(!A&&typeof require!=="undefined")A=require("underscore")._;var T=q.jQuery||q.Zepto;M.noConflict=function(){q.Backbone=Z;return this};M.emulateHTTP=false;M.emulateJSON=false;M.Events={bind:function(n,l,D){var v=this._callbacks||(this._callbacks={});(v[n]||(v[n]=[])).push([l,D]);return this},unbind:function(n,l){var D;if(n){if(D=this._callbacks)if(l){D=D[n];if(!D)return this;for(var v=
0,p=D.length;v<p;v++)if(D[v]&&l===D[v][0]){D[v]=null;break}}else D[n]=[]}else this._callbacks={};return this},trigger:function(n){var l,D,v,p,x=2;if(!(D=this._callbacks))return this;for(;x--;)if(l=x?n:"all",l=D[l])for(var B=0,E=l.length;B<E;B++)(v=l[B])?(p=x?Array.prototype.slice.call(arguments,1):arguments,v[0].apply(v[1]||this,p)):(l.splice(B,1),B--,E--);return this}};M.Model=function(n,l){var D;n||(n={});if(D=this.defaults){A.isFunction(D)&&(D=D.call(this));n=A.extend({},D,n)}this.attributes={};
this._escapedAttributes={};this.cid=A.uniqueId("c");this.set(n,{silent:true});this._changed=false;this._previousAttributes=A.clone(this.attributes);if(l&&l.collection)this.collection=l.collection;this.initialize(n,l)};A.extend(M.Model.prototype,M.Events,{_previousAttributes:null,_changed:false,idAttribute:"id",initialize:function(){},toJSON:function(){return A.clone(this.attributes)},get:function(n){return this.attributes[n]},escape:function(n){var l;if(l=this._escapedAttributes[n])return l;l=this.attributes[n];
return this._escapedAttributes[n]=(l==null?"":""+l).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},has:function(n){return this.attributes[n]!=null},set:function(n,l){l||(l={});if(!n)return this;if(n.attributes)n=n.attributes;var D=this.attributes,v=this._escapedAttributes;if(!l.silent&&this.validate&&!this._performValidation(n,l))return false;if(this.idAttribute in n)this.id=n[this.idAttribute];
var p=this._changing;this._changing=true;for(var x in n){var B=n[x];if(!A.isEqual(D[x],B)){D[x]=B;delete v[x];this._changed=true;l.silent||this.trigger("change:"+x,this,B,l)}}!p&&!l.silent&&this._changed&&this.change(l);this._changing=false;return this},unset:function(n,l){if(!(n in this.attributes))return this;l||(l={});var D={};D[n]=void 0;if(!l.silent&&this.validate&&!this._performValidation(D,l))return false;delete this.attributes[n];delete this._escapedAttributes[n];n==this.idAttribute&&delete this.id;
this._changed=true;l.silent||(this.trigger("change:"+n,this,void 0,l),this.change(l));return this},clear:function(n){n||(n={});var l,D=this.attributes,v={};for(l in D)v[l]=void 0;if(!n.silent&&this.validate&&!this._performValidation(v,n))return false;this.attributes={};this._escapedAttributes={};this._changed=true;if(!n.silent){for(l in D)this.trigger("change:"+l,this,void 0,n);this.change(n)}return this},fetch:function(n){n||(n={});var l=this,D=n.success;n.success=function(v,p,x){if(!l.set(l.parse(v,
x),n))return false;D&&D(l,v)};n.error=aa(n.error,l,n);return(this.sync||M.sync).call(this,"read",this,n)},save:function(n,l){l||(l={});if(n&&!this.set(n,l))return false;var D=this,v=l.success;l.success=function(x,B,E){if(!D.set(D.parse(x,E),l))return false;v&&v(D,x,E)};l.error=aa(l.error,D,l);var p=this.isNew()?"create":"update";return(this.sync||M.sync).call(this,p,this,l)},destroy:function(n){n||(n={});if(this.isNew())return this.trigger("destroy",this,this.collection,n);var l=this,D=n.success;
n.success=function(v){l.trigger("destroy",l,l.collection,n);D&&D(l,v)};n.error=aa(n.error,l,n);return(this.sync||M.sync).call(this,"delete",this,n)},url:function(){var n=J(this.collection)||this.urlRoot||U();if(this.isNew())return n;return n+(n.charAt(n.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(n){return n},clone:function(){return new this.constructor(this)},isNew:function(){return this.id==null},change:function(n){this.trigger("change",this,n);this._previousAttributes=A.clone(this.attributes);
this._changed=false},hasChanged:function(n){if(n)return this._previousAttributes[n]!=this.attributes[n];return this._changed},changedAttributes:function(n){n||(n=this.attributes);var l=this._previousAttributes,D=false,v;for(v in n)A.isEqual(l[v],n[v])||(D=D||{},D[v]=n[v]);return D},previous:function(n){if(!n||!this._previousAttributes)return null;return this._previousAttributes[n]},previousAttributes:function(){return A.clone(this._previousAttributes)},_performValidation:function(n,l){var D=this.validate(n);
if(D)return l.error?l.error(this,D,l):this.trigger("error",this,D,l),false;return true}});M.Collection=function(n,l){l||(l={});if(l.comparator)this.comparator=l.comparator;A.bindAll(this,"_onModelEvent","_removeReference");this._reset();n&&this.reset(n,{silent:true});this.initialize.apply(this,arguments)};A.extend(M.Collection.prototype,M.Events,{model:M.Model,initialize:function(){},toJSON:function(){return this.map(function(n){return n.toJSON()})},add:function(n,l){if(A.isArray(n))for(var D=0,v=
n.length;D<v;D++)this._add(n[D],l);else this._add(n,l);return this},remove:function(n,l){if(A.isArray(n))for(var D=0,v=n.length;D<v;D++)this._remove(n[D],l);else this._remove(n,l);return this},get:function(n){if(n==null)return null;return this._byId[n.id!=null?n.id:n]},getByCid:function(n){return n&&this._byCid[n.cid||n]},at:function(n){return this.models[n]},sort:function(n){n||(n={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");this.models=this.sortBy(this.comparator);
n.silent||this.trigger("reset",this,n);return this},pluck:function(n){return A.map(this.models,function(l){return l.get(n)})},reset:function(n,l){n||(n=[]);l||(l={});this.each(this._removeReference);this._reset();this.add(n,{silent:true});l.silent||this.trigger("reset",this,l);return this},fetch:function(n){n||(n={});var l=this,D=n.success;n.success=function(v,p,x){l[n.add?"add":"reset"](l.parse(v,x),n);D&&D(l,v)};n.error=aa(n.error,l,n);return(this.sync||M.sync).call(this,"read",this,n)},create:function(n,
l){var D=this;l||(l={});n=this._prepareModel(n,l);if(!n)return false;var v=l.success;l.success=function(p,x,B){D.add(p,l);v&&v(p,x,B)};n.save(null,l);return n},parse:function(n){return n},chain:function(){return A(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(n,l){if(n instanceof M.Model){if(!n.collection)n.collection=this}else{var D=n;n=new this.model(D,{collection:this});n.validate&&!n._performValidation(D,l)&&(n=false)}return n},
_add:function(n,l){l||(l={});n=this._prepareModel(n,l);if(!n)return false;var D=this.getByCid(n);if(D)throw Error(["Can't add the same model to a set twice",D.id]);this._byId[n.id]=n;this._byCid[n.cid]=n;this.models.splice(l.at!=null?l.at:this.comparator?this.sortedIndex(n,this.comparator):this.length,0,n);n.bind("all",this._onModelEvent);this.length++;l.silent||n.trigger("add",n,this,l);return n},_remove:function(n,l){l||(l={});n=this.getByCid(n)||this.get(n);if(!n)return null;delete this._byId[n.id];
delete this._byCid[n.cid];this.models.splice(this.indexOf(n),1);this.length--;l.silent||n.trigger("remove",n,this,l);this._removeReference(n);return n},_removeReference:function(n){this==n.collection&&delete n.collection;n.unbind("all",this._onModelEvent)},_onModelEvent:function(n,l,D,v){(n=="add"||n=="remove")&&D!=this||(n=="destroy"&&this._remove(l,v),l&&n==="change:"+l.idAttribute&&(delete this._byId[l.previous(l.idAttribute)],this._byId[l.id]=l),this.trigger.apply(this,arguments))}});A.each(["forEach",
"each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty","groupBy"],function(n){M.Collection.prototype[n]=function(){return A[n].apply(A,[this.models].concat(A.toArray(arguments)))}});M.Router=function(n){n||(n={});if(n.routes)this.routes=n.routes;this._bindRoutes();this.initialize.apply(this,arguments)};
var m=/:([\w\d]+)/g,Q=/\*([\w\d]+)/g,R=/[-[\]{}()+?.,\\^$|#\s]/g;A.extend(M.Router.prototype,M.Events,{initialize:function(){},route:function(n,l,D){M.history||(M.history=new M.History);A.isRegExp(n)||(n=this._routeToRegExp(n));M.history.route(n,A.bind(function(v){v=this._extractParameters(n,v);D.apply(this,v);this.trigger.apply(this,["route:"+l].concat(v))},this))},navigate:function(n,l){M.history.navigate(n,l)},_bindRoutes:function(){if(this.routes){var n=[],l;for(l in this.routes)n.unshift([l,
this.routes[l]]);l=0;for(var D=n.length;l<D;l++)this.route(n[l][0],n[l][1],this[n[l][1]])}},_routeToRegExp:function(n){n=n.replace(R,"\\$&").replace(m,"([^/]*)").replace(Q,"(.*?)");return RegExp("^"+n+"$")},_extractParameters:function(n,l){return n.exec(l).slice(1)}});M.History=function(){this.handlers=[];A.bindAll(this,"checkUrl")};var I=/^#*/,O=/msie [\w.]+/,H=false;A.extend(M.History.prototype,{interval:50,getFragment:function(n,l){if(n==null)if(this._hasPushState||l){n=window.location.pathname;
var D=window.location.search;D&&(n+=D);n.indexOf(this.options.root)==0&&(n=n.substr(this.options.root.length))}else n=window.location.hash;return decodeURIComponent(n.replace(I,""))},start:function(n){if(H)throw Error("Backbone.history has already been started");this.options=A.extend({},{root:"/"},this.options,n);this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);n=this.getFragment();var l=document.documentMode;if(l=
O.exec(navigator.userAgent.toLowerCase())&&(!l||l<=7)){this.iframe=T('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(n)}this._hasPushState?T(window).bind("popstate",this.checkUrl):"onhashchange"in window&&!l?T(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval);this.fragment=n;H=true;n=window.location;l=n.pathname==this.options.root;if(this._wantsPushState&&!this._hasPushState&&!l)return this.fragment=this.getFragment(null,
true),window.location.replace(this.options.root+"#"+this.fragment),true;else if(this._wantsPushState&&this._hasPushState&&l&&n.hash){this.fragment=n.hash.replace(I,"");window.history.replaceState({},document.title,n.protocol+"//"+n.host+this.options.root+this.fragment)}if(!this.options.silent)return this.loadUrl()},route:function(n,l){this.handlers.unshift({route:n,callback:l})},checkUrl:function(){var n=this.getFragment();n==this.fragment&&this.iframe&&(n=this.getFragment(this.iframe.location.hash));
if(n==this.fragment||n==decodeURIComponent(this.fragment))return false;this.iframe&&this.navigate(n);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(n){var l=this.fragment=this.getFragment(n);return A.any(this.handlers,function(D){if(D.route.test(l))return D.callback(l),true})},navigate:function(n,l){var D=(n||"").replace(I,"");if(!(this.fragment==D||this.fragment==decodeURIComponent(D))){if(this._hasPushState){var v=window.location;D.indexOf(this.options.root)!=0&&(D=this.options.root+
D);this.fragment=D;window.history.pushState({},document.title,v.protocol+"//"+v.host+D)}else if(window.location.hash=this.fragment=D,this.iframe&&D!=this.getFragment(this.iframe.location.hash)){this.iframe.document.open().close();this.iframe.location.hash=D}l&&this.loadUrl(n)}}});M.View=function(n){this.cid=A.uniqueId("view");this._configure(n||{});this._ensureElement();this.delegateEvents();this.initialize.apply(this,arguments)};var e=/^(\S+)\s*(.*)$/,h=["model","collection","el","id","attributes",
"className","tagName"];A.extend(M.View.prototype,M.Events,{tagName:"div",$:function(n){return T(n,this.el)},initialize:function(){},render:function(){return this},remove:function(){T(this.el).remove();return this},make:function(n,l,D){n=document.createElement(n);l&&T(n).attr(l);D&&T(n).html(D);return n},delegateEvents:function(n){if(n||(n=this.events))for(var l in A.isFunction(n)&&(n=n.call(this)),T(this.el).unbind(".delegateEvents"+this.cid),n){var D=this[n[l]];if(!D)throw Error('Event "'+n[l]+'" does not exist');
var v=l.match(e),p=v[1];v=v[2];D=A.bind(D,this);p+=".delegateEvents"+this.cid;v===""?T(this.el).bind(p,D):T(this.el).delegate(v,p,D)}},_configure:function(n){this.options&&(n=A.extend({},this.options,n));for(var l=0,D=h.length;l<D;l++){var v=h[l];n[v]&&(this[v]=n[v])}this.options=n},_ensureElement:function(){if(this.el){if(A.isString(this.el))this.el=T(this.el).get(0)}else{var n=this.attributes||{};if(this.id)n.id=this.id;if(this.className)n["class"]=this.className;this.el=this.make(this.tagName,
n)}}});M.Model.extend=M.Collection.extend=M.Router.extend=M.View.extend=function(n,l){var D=C(this,n,l);D.extend=this.extend;return D};var k={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};M.sync=function(n,l,D){var v=k[n];D=A.extend({type:v,dataType:"json"},D);if(!D.url)D.url=J(l)||U();if(!D.data&&l&&(n=="create"||n=="update")){D.contentType="application/json";D.data=JSON.stringify(l.toJSON())}if(M.emulateJSON){D.contentType="application/x-www-form-urlencoded";D.data=D.data?{model:D.data}:
{}}if(M.emulateHTTP&&(v==="PUT"||v==="DELETE")){if(M.emulateJSON)D.data._method=v;D.type="POST";D.beforeSend=function(p){p.setRequestHeader("X-HTTP-Method-Override",v)}}if(D.type!=="GET"&&!M.emulateJSON)D.processData=false;return T.ajax(D)};var y=function(){},C=function(n,l,D){var v;v=l&&l.hasOwnProperty("constructor")?l.constructor:function(){return n.apply(this,arguments)};A.extend(v,n);y.prototype=n.prototype;v.prototype=new y;l&&A.extend(v.prototype,l);D&&A.extend(v,D);v.prototype.constructor=
v;v.__super__=n.prototype;return v},J=function(n){if(!n||!n.url)return null;return A.isFunction(n.url)?n.url():n.url},U=function(){throw Error('A "url" property or function must be specified');},aa=function(n,l,D){return function(v){n?n(l,v,D):l.trigger("error",l,v,D)}}}).call(this);/*
 
 JavaScript Debug - v0.4 - 6/22/2010
 http://benalman.com/projects/javascript-debug-console-log/

 Copyright (c) 2010 "Cowboy" Ben Alman
 Dual licensed under the MIT and GPL licenses.
 http://benalman.com/about/license/

 With lots of help from Paul Irish!
 http://paulirish.com/
*/
window.debug=function(){function q(h){if(m&&(Q||!A||!A.log))m.apply(Z,h)}for(var Z=this,M=Array.prototype.slice,A=Z.console,T={},m,Q,R=9,I=["error","warn","info","debug","log"],O="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),H=O.length,e=[];--H>=0;)(function(h){T[h]=function(){R!==0&&A&&A[h]&&A[h].apply(A,arguments)}})(O[H]);for(H=I.length;--H>=0;)(function(h,k){T[k]=function(){var y=M.call(arguments),C=[k].concat(y);
e.push(C);q(C);if(A&&(R>0?R>h:I.length+R<=h))A.firebug?A[k].apply(Z,y):A[k]?A[k](y):A.log(y)}})(H,I[H]);T.setLevel=function(h){R=typeof h==="number"?h:9};T.setCallback=function(){var h=M.call(arguments),k=e.length,y=k;m=h.shift()||null;Q=typeof h[0]==="boolean"?h.shift():false;for(y-=typeof h[0]==="number"?h.shift():k;y<k;)q(e[y++])};return T}();/*

 jQuery Templates Plugin 1.0.0pre
 http://github.com/jquery/jquery-tmpl
 Requires jQuery 1.4.2

 Copyright Software Freedom Conservancy, Inc.
 Dual licensed under the MIT or GPL Version 2 licenses.
 http://jquery.org/license
*/
(function(q){function Z(p,x,B,E){E={data:E||E===0||E===false?E:x?x.data:{},_wrap:x?x._wrap:null,tmpl:null,parent:x||null,nodes:[],calls:I,nest:O,wrap:H,html:e,update:h};p&&q.extend(E,p,{nodes:[],parent:x});if(B){E.tmpl=B;E._ctnt=E._ctnt||E.tmpl(q,E);E.key=++l;(v.length?U:J)[l]=E}return E}function M(p,x,B){var E;B=B?q.map(B,function(N){return typeof N==="string"?p.key?N.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+y+'="'+p.key+'" $2'):N:M(N,p,N._ctnt)}):p;if(x)return B;B=B.join("");B.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,
function(N,i,r,z){E=q(r).get();R(E);if(i)E=A(i).concat(E);if(z)E=E.concat(A(z))});return E?E:A(B)}function A(p){var x=document.createElement("div");x.innerHTML=p;return q.makeArray(x.childNodes)}function T(p){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+q.trim(p).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(x,B,E,N,i,r,z){x=q.tmpl.tag[E];if(!x)throw"Unknown template tag: "+E;E=x._default||[];if(r&&!/\w$/.test(i)){i+=r;r=""}if(i){i=Q(i);z=z?","+Q(z)+")":r?")":"";z=r?i.indexOf(".")>-1?i+Q(r):"("+i+").call($item"+z:i;r=r?z:"(typeof("+i+")==='function'?("+i+").call($item):("+i+"))"}else r=z=E.$1||"null";N=Q(N);return"');"+x[B?"close":"open"].split("$notnull_1").join(i?"typeof("+i+")!=='undefined' && ("+i+")!=null":"true").split("$1a").join(r).split("$1").join(z).split("$2").join(N||E.$2||"")+"__.push('"})+
"');}return __;")}function m(p,x){p._wrap=M(p,true,q.isArray(x)?x:[C.test(x)?x:q(x).html()]).join("")}function Q(p){return p?p.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function R(p){function x(P){function X(ha){ha+=B;fa=i[ha]=i[ha]||Z(fa,J[fa.parent.key+B]||fa.parent)}var ga,ba=P,fa,la;if(la=P.getAttribute(y)){for(;ba.parentNode&&(ba=ba.parentNode).nodeType===1&&!(ga=ba.getAttribute(y)););if(ga!==la){ba=ba.parentNode?ba.nodeType===11?0:ba.getAttribute(y)||0:0;if(!(fa=J[la])){fa=U[la];fa=Z(fa,
J[ba]||U[ba]);fa.key=++l;J[l]=fa}D&&X(la)}P.removeAttribute(y)}else if(D&&(fa=q.data(P,"tmplItem"))){X(fa.key);J[fa.key]=fa;ba=(ba=q.data(P.parentNode,"tmplItem"))?ba.key:0}if(fa){for(ga=fa;ga&&ga.key!=ba;){ga.nodes.push(P);ga=ga.parent}delete fa._ctnt;delete fa._wrap;q.data(P,"tmplItem",fa)}}var B="_"+D,E,N,i={},r,z,F;r=0;for(z=p.length;r<z;r++)if((E=p[r]).nodeType===1){N=E.getElementsByTagName("*");for(F=N.length-1;F>=0;F--)x(N[F]);x(E)}}function I(p,x,B,E){if(!p)return v.pop();v.push({_:p,tmpl:x,
item:this,data:B,options:E})}function O(p,x,B){return q.tmpl(q.template(p),x,B,this)}function H(p,x){var B=p.options||{};B.wrapped=x;return q.tmpl(q.template(p.tmpl),p.data,B,p.item)}function e(p,x){var B=this._wrap;return q.map(q(q.isArray(B)?B.join(""):B).filter(p||"*"),function(E){if(x)E=E.innerText||E.textContent;else{var N;if(!(N=E.outerHTML)){N=document.createElement("div");N.appendChild(E.cloneNode(true));N=N.innerHTML}E=N}return E})}function h(){var p=this.nodes;q.tmpl(null,null,null,this).insertBefore(p[0]);
q(p).remove()}var k=q.fn.domManip,y="_tmplitem",C=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,J={},U={},aa,n={key:0,data:{}},l=0,D=0,v=[];q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(p,x){q.fn[p]=function(B){var E=[];B=q(B);var N,i,r;N=this.length===1&&this[0].parentNode;aa=J||{};if(N&&N.nodeType===11&&N.childNodes.length===1&&B.length===1){B[x](this[0]);E=this}else{i=0;for(r=B.length;i<r;i++){D=i;N=(i>0?this.clone(true):this).get();
q(B[i])[x](N);E=E.concat(N)}D=0;E=this.pushStack(E,p,B.selector)}B=aa;aa=null;q.tmpl.complete(B);return E}});q.fn.extend({tmpl:function(p,x,B){return q.tmpl(this[0],p,x,B)},tmplItem:function(){return q.tmplItem(this[0])},template:function(p){return q.template(p,this[0])},domManip:function(p,x,B){if(p[0]&&q.isArray(p[0])){for(var E=q.makeArray(arguments),N=p[0],i=N.length,r=0,z;r<i&&!(z=q.data(N[r++],"tmplItem")););if(z&&D)E[2]=function(F){q.tmpl.afterManip(this,F,B)};k.apply(this,E)}else k.apply(this,
arguments);D=0;aa||q.tmpl.complete(J);return this}});q.extend({tmpl:function(p,x,B,E){var N=!E;if(N){E=n;p=q.template[p]||q.template(null,p);U={}}else if(!p){p=E.tmpl;J[E.key]=E;E.nodes=[];E.wrapped&&m(E,E.wrapped);return q(M(E,null,E.tmpl(q,E)))}if(!p)return[];if(typeof x==="function")x=x.call(E||{});B&&B.wrapped&&m(B,B.wrapped);x=q.isArray(x)?q.map(x,function(i){return i?Z(B,E,p,i):null}):[Z(B,E,p,x)];return N?q(M(E,null,x)):x},tmplItem:function(p){var x;if(p instanceof q)p=p[0];for(;p&&p.nodeType===
1&&!(x=q.data(p,"tmplItem"))&&(p=p.parentNode););return x||n},template:function(p,x){if(x){if(typeof x==="string")x=T(x);else if(x instanceof q)x=x[0]||{};if(x.nodeType)x=q.data(x,"tmpl")||q.data(x,"tmpl",T(x.innerHTML));return typeof p==="string"?q.template[p]=x:x}return p?typeof p!=="string"?q.template(null,p):q.template[p]||q.template(null,C.test(p)?p:q(p)):null},encode:function(p){return(""+p).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});
q.extend(q.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},
"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){J={}},afterManip:function(p,x,B){var E=x.nodeType===11?q.makeArray(x.childNodes):x.nodeType===1?[x]:[];B.call(p,x);R(E);D++}})})(jQuery);/*

 Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
 Licensed under the MIT License (LICENSE.txt).

 Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 Thanks to: Seamus Leahy for adding deltaX and deltaY

 Version: 3.0.4

 Requires: 1.2.2+
*/
(function(q){function Z(A){var T=A||window.event,m=[].slice.call(arguments,1),Q=0,R=0,I=0;A=q.event.fix(T);A.type="mousewheel";if(A.wheelDelta)Q=A.wheelDelta/120;if(A.detail)Q=-A.detail/3;I=Q;if(T.axis!==undefined&&T.axis===T.HORIZONTAL_AXIS){I=0;R=-1*Q}if(T.wheelDeltaY!==undefined)I=T.wheelDeltaY/120;if(T.wheelDeltaX!==undefined)R=-1*T.wheelDeltaX/120;m.unshift(A,Q,R,I);return q.event.handle.apply(this,m)}var M=["DOMMouseScroll","mousewheel"];q.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var A=
M.length;A;)this.addEventListener(M[--A],Z,false);else this.onmousewheel=Z},teardown:function(){if(this.removeEventListener)for(var A=M.length;A;)this.removeEventListener(M[--A],Z,false);else this.onmousewheel=null}};q.fn.extend({mousewheel:function(A){return A?this.bind("mousewheel",A):this.trigger("mousewheel")},unmousewheel:function(A){return this.unbind("mousewheel",A)}})})(jQuery);/*

 jQuery.UI.iPad plugin
 Copyright (c) 2010 Stephen von Takach
 licensed under MIT.
 Date: 27/8/2010

 Project Home: 
 http://code.google.com/p/jquery-ui-for-ipad-and-iphone/
*/
(function(q){function Z(){if(I){window.clearTimeout(H);I=false;O=null}}function M(h){if(!I){I=true;O=h.changedTouches[0];H=window.setTimeout(function(){I=false;var k=O,y=document.createEvent("MouseEvent");y.initMouseEvent("mouseup",true,true,window,1,k.screenX,k.screenY,k.clientX,k.clientY,false,false,false,false,0,null);k.target.dispatchEvent(y);y=document.createEvent("MouseEvent");y.initMouseEvent("mousedown",true,true,window,1,k.screenX,k.screenY,k.clientX,k.clientY,false,false,false,false,2,null);
k.target.dispatchEvent(y);y=document.createEvent("MouseEvent");y.initMouseEvent("contextmenu",true,true,window,1,k.screenX+50,k.screenY+5,k.clientX+50,k.clientY+5,false,false,false,false,2,null);k.target.dispatchEvent(y);e=true;O=null},800)}}function A(h){var k=h.changedTouches[0],y="mouseover",C=document.createEvent("MouseEvent");C.initMouseEvent(y,true,true,window,1,k.screenX,k.screenY,k.clientX,k.clientY,false,false,false,false,0,null);k.target.dispatchEvent(C);y="mousedown";C=document.createEvent("MouseEvent");
C.initMouseEvent(y,true,true,window,1,k.screenX,k.screenY,k.clientX,k.clientY,false,false,false,false,0,null);k.target.dispatchEvent(C);if(Q){window.clearTimeout(R);if(k.target==m){m=null;Q=false;y="click";C=document.createEvent("MouseEvent");C.initMouseEvent(y,true,true,window,1,k.screenX,k.screenY,k.clientX,k.clientY,false,false,false,false,0,null);k.target.dispatchEvent(C);y="dblclick";C=document.createEvent("MouseEvent");C.initMouseEvent(y,true,true,window,1,k.screenX,k.screenY,k.clientX,k.clientY,
false,false,false,false,0,null);k.target.dispatchEvent(C)}else{m=k.target;Q=true;R=window.setTimeout(function(){Q=false},600);M(h)}}else{m=k.target;Q=true;R=window.setTimeout(function(){Q=false},600);M(h)}}function T(h){var k="";if(!(h.touches.length>1)){switch(h.type){case "gesturestart":h.preventDefault();break;case "touchstart":if(q(h.changedTouches[0].target).is("select"))return;A(h);h.preventDefault();return false;case "touchmove":Z();k="mousemove";h.preventDefault();break;case "touchend":if(e){e=
false;h.preventDefault();return false}Z();k="mouseup";break;default:return}h=h.changedTouches[0];var y=document.createEvent("MouseEvent");y.initMouseEvent(k,true,true,window,1,h.screenX,h.screenY,h.clientX,h.clientY,false,false,false,false,0,null);h.target.dispatchEvent(y);if(k=="mouseup"&&Q&&h.target==m){y=document.createEvent("MouseEvent");y.initMouseEvent("click",true,true,window,1,h.screenX,h.screenY,h.clientX,h.clientY,false,false,false,false,0,null);h.target.dispatchEvent(y)}}}q.extend(q.support,
{touch:typeof Touch=="object"});q.fn.addTouch=function(){q.support.touch&&this.each(function(h,k){k.addEventListener("touchstart",T,false);k.addEventListener("touchmove",T,false);k.addEventListener("touchend",T,false);k.addEventListener("touchcancel",T,false)})};var m=null,Q=false,R=null,I=false,O=null,H=null,e=false})(jQuery);
/iPad|iPhone/.test(navigator.userAgent)&&function(q){var Z=q.ui.mouse.prototype,M=Z._mouseInit;q.extend(Z,{_mouseInit:function(){this.element.bind("touchstart."+this.widgetName,q.proxy(this,"_touchStart"));M.apply(this,arguments)},_touchStart:function(A){if(A.originalEvent.targetTouches.length!=1)return false;this.element.bind("touchmove."+this.widgetName,q.proxy(this,"_touchMove")).bind("touchend."+this.widgetName,q.proxy(this,"_touchEnd"));this._modifyEvent(A);this._mouseDown(A);return false},_touchMove:function(A){this._modifyEvent(A);
this._mouseMove(A)},_touchEnd:function(A){this.element.unbind("touchmove."+this.widgetName).unbind("touchend."+this.widgetName);this._mouseUp(A)},_modifyEvent:function(A){A.which=1;var T=A.originalEvent.targetTouches[0];A.pageX=T.clientX;A.pageY=T.clientY}})}(jQuery);/*

 Raphael 1.5.2 - JavaScript Vector Library

 Copyright (c) 2010 Dmitry Baranovskiy (http://raphaeljs.com)
 Licensed under the MIT (http://raphaeljs.com/license.html) license.
*/
(function(){function q(){if(q.is(arguments[0],P)){for(var a=arguments[0],c=Na[J](q,a.splice(0,3+q.is(a[0],F))),d=c.set(),g=0,j=a[p];g<j;g++){var f=a[g]||{};R[H](f.type)&&d[ba](c[f.type]().attr(f))}return d}return Na[J](q,arguments)}function Z(){for(var a=[],c=0;c<32;c++)a[c]=(~~(B.random()*16))[X](16);a[12]=4;a[16]=(a[16]&3|8)[X](16);return"r-"+a[v]("")}function M(a,c,d){function g(){var j=Array[O].slice.call(arguments,0),f=j[v]("\u25ba"),o=g.cache=g.cache||{},s=g.count=g.count||[];if(o[H](f))return d?
d(o[f]):o[f];s[p]>=1E3&&delete o[s.shift()];s[ba](f);o[f]=a[J](c,j);return d?d(o[f]):o[f]}return g}function A(){return this.x+aa+this.y}function T(a){return function(c,d,g,j){var f={back:a};q.is(g,"function")?j=g:f.rot=g;c&&c.constructor==ja&&(c=c.attrs.path);c&&(f.along=c);return this.animate(f,d,j)}}function m(a,c,d,g,j,f){function o(V,ea){var W,S,$,ka;$=V;for(S=0;S<8;S++){ka=((w*$+u)*$+s)*$-V;if(i(ka)<ea)return $;W=(3*w*$+2*u)*$+s;if(i(W)<1.0E-6)break;$-=ka/W}W=0;S=1;$=V;if($<W)return W;if($>S)return S;
for(;W<S;){ka=((w*$+u)*$+s)*$;if(i(ka-V)<ea)break;V>ka?W=$:S=$;$=(S-W)/2+W}return $}var s=3*c,u=3*(g-c)-s,w=1-s-u,G=3*d,K=3*(j-d)-G,L=1-G-K;return function(V,ea){var W=o(V,ea);return((L*W+K)*W+G)*W}(a,1/(200*f))}q.version="1.5.2";var Q=/[, ]+/,R={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},I=/\{(\d+)\}/g,O="prototype",H="hasOwnProperty",e=document,h=window,k={was:Object[O][H].call(h,"Raphael"),is:h.Raphael},y=function(){this.customAttributes={}},C,J="apply",U="createTouch"in e,aa=" ",n=String,
l="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend".split(aa),D={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},v="join",p="length",x=n[O].toLowerCase,B=Math,E=B.max,N=B.min,i=B.abs,r=B.pow,z=B.PI,F="number",P="array",X="toString",ga=Object[O][X],ba="push",fa=/^url\(['"]?([^\)]+?)['"]?\)$/i,la=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,
ha={NaN:1,Infinity:1,"-Infinity":1},ra=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,ca=B.round,Y=parseFloat,na=parseInt,wa=n[O].toUpperCase,Ea={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt",
"stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},Oa={along:"along",blur:F,"clip-rect":"csv",cx:F,cy:F,fill:"colour","fill-opacity":F,"font-size":F,height:F,opacity:F,path:"path",r:F,rotation:"csv",rx:F,ry:F,scale:"csv",stroke:"colour","stroke-opacity":F,"stroke-width":F,translation:"csv",width:F,x:F,y:F},ub=/^(from|to|\d+%?)$/,Pa=/\s*,\s*/,vb={hs:1,rg:1},wb=/,?([achlmqrstvxz]),?/gi,
xb=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,yb=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,Za=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,Ab=function(a,c){return a.key-c.key};q.type=h.SVGAngle||e.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(q.type=="VML"){var ta=e.createElement("div");ta.innerHTML='<v:shape adj="1"/>';ta=ta.firstChild;ta.style.behavior="url(#default#VML)";if(!(ta&&typeof ta.adj=="object"))return q.type=null;ta=null}q.svg=
!(q.vml=q.type=="VML");y[O]=q[O];C=y[O];q._id=0;q._oid=0;q.fn={};q.is=function(a,c){c=x.call(c);if(c=="finite")return!ha[H](+a);return c=="null"&&a===null||c==typeof a||c=="object"&&a===Object(a)||c=="array"&&Array.isArray&&Array.isArray(a)||ga.call(a).slice(8,-1).toLowerCase()==c};q.angle=function(a,c,d,g,j,f){if(j==null){a-=d;c-=g;if(!a&&!c)return 0;return((a<0)*180+B.atan(-c/-a)*180/z+360)%360}return q.angle(a,c,j,f)-q.angle(d,g,j,f)};q.rad=function(a){return a%360*z/180};q.deg=function(a){return a*
180/z%360};q.snapTo=function(a,c,d){d=q.is(d,"finite")?d:10;if(q.is(a,P))for(var g=a.length;g--;){if(i(a[g]-c)<=d)return a[g]}else{a=+a;g=c%a;if(g<d)return c-g;if(g>a-d)return c-g+a}return c};q.setWindow=function(a){h=a;e=h.document};var Fa=function(a){if(q.vml){var c=/^\s+|\s+$/g,d;try{var g=new ActiveXObject("htmlfile");g.write("<body>");g.close();d=g.body}catch(j){d=createPopup().document.body}var f=d.createTextRange();Fa=M(function(s){try{d.style.color=n(s).replace(c,"");var u=f.queryCommandValue("ForeColor");
return"#"+("000000"+((u&255)<<16|u&65280|(u&16711680)>>>16)[X](16)).slice(-6)}catch(w){return"none"}})}else{var o=e.createElement("i");o.title="Rapha\u00ebl Colour Picker";o.style.display="none";e.body.appendChild(o);Fa=M(function(s){o.style.color=s;return e.defaultView.getComputedStyle(o,"").getPropertyValue("color")})}return Fa(a)},$a=function(){return"hsb("+[this.h,this.s,this.b]+")"},Bb=function(){return"hsl("+[this.h,this.s,this.l]+")"},Cb=function(){return this.hex};q.hsb2rgb=function(a,c,d,
g){if(q.is(a,"object")&&"h"in a&&"s"in a&&"b"in a){d=a.b;c=a.s;a=a.h;g=a.o}return q.hsl2rgb(a,c,d/2,g)};q.hsl2rgb=function(a,c,d,g){if(q.is(a,"object")&&"h"in a&&"s"in a&&"l"in a){d=a.l;c=a.s;a=a.h}if(a>1||c>1||d>1){a/=360;c/=100;d/=100}var j={},f=["r","g","b"],o;if(c){d<0.5?o=d*(1+c):o=d+c-d*c;c=2*d-o;for(var s=0;s<3;s++){d=a+1/3*-(s-1);d<0&&d++;d>1&&d--;d*6<1?j[f[s]]=c+(o-c)*6*d:d*2<1?j[f[s]]=o:d*3<2?j[f[s]]=c+(o-c)*(2/3-d)*6:j[f[s]]=c}}else j={r:d,g:d,b:d};j.r*=255;j.g*=255;j.b*=255;j.hex="#"+
(16777216|j.b|j.g<<8|j.r<<16).toString(16).slice(1);q.is(g,"finite")&&(j.opacity=g);j.toString=Cb;return j};q.rgb2hsb=function(a,c,d){if(c==null&&q.is(a,"object")&&"r"in a&&"g"in a&&"b"in a){d=a.b;c=a.g;a=a.r}if(c==null&&q.is(a,"string")){d=q.getRGB(a);a=d.r;c=d.g;d=d.b}if(a>1||c>1||d>1){a/=255;c/=255;d/=255}var g=E(a,c,d),j=N(a,c,d),f;if(j==g)return{h:0,s:0,b:g,toString:$a};j=g-j;a==g?f=(c-d)/j:c==g?f=2+(d-a)/j:f=4+(a-c)/j;f/=6;f<0&&f++;f>1&&f--;return{h:f,s:j/g,b:g,toString:$a}};q.rgb2hsl=function(a,
c,d){if(c==null&&q.is(a,"object")&&"r"in a&&"g"in a&&"b"in a){d=a.b;c=a.g;a=a.r}if(c==null&&q.is(a,"string")){d=q.getRGB(a);a=d.r;c=d.g;d=d.b}if(a>1||c>1||d>1){a/=255;c/=255;d/=255}var g=E(a,c,d),j=N(a,c,d),f,o=(g+j)/2;if(j==g)a={h:0,s:0,l:o};else{var s=g-j;a==g?f=(c-d)/s:c==g?f=2+(d-a)/s:f=4+(a-c)/s;f/=6;f<0&&f++;f>1&&f--;a={h:f,s:o<0.5?s/(g+j):s/(2-g-j),l:o}}a.toString=Bb;return a};q._path2string=function(){return this.join(",").replace(wb,"$1")};q.getRGB=M(function(a){if(!a||(a=n(a)).indexOf("-")+
1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if(a=="none")return{r:-1,g:-1,b:-1,hex:"none"};!(vb[H](a.toLowerCase().substring(0,2))||a.charAt()=="#")&&(a=Fa(a));var c,d,g,j,f;if(a=a.match(la)){if(a[2]){g=na(a[2].substring(5),16);d=na(a[2].substring(3,5),16);c=na(a[2].substring(1,3),16)}if(a[3]){g=na((f=a[3].charAt(3))+f,16);d=na((f=a[3].charAt(2))+f,16);c=na((f=a[3].charAt(1))+f,16)}if(a[4]){f=a[4].split(Pa);c=Y(f[0]);f[0].slice(-1)=="%"&&(c*=2.55);d=Y(f[1]);f[1].slice(-1)=="%"&&(d*=2.55);g=Y(f[2]);
f[2].slice(-1)=="%"&&(g*=2.55);a[1].toLowerCase().slice(0,4)=="rgba"&&(j=Y(f[3]));f[3]&&f[3].slice(-1)=="%"&&(j/=100)}if(a[5]){f=a[5].split(Pa);c=Y(f[0]);f[0].slice(-1)=="%"&&(c*=2.55);d=Y(f[1]);f[1].slice(-1)=="%"&&(d*=2.55);g=Y(f[2]);f[2].slice(-1)=="%"&&(g*=2.55);(f[0].slice(-3)=="deg"||f[0].slice(-1)=="\u00b0")&&(c/=360);a[1].toLowerCase().slice(0,4)=="hsba"&&(j=Y(f[3]));f[3]&&f[3].slice(-1)=="%"&&(j/=100);return q.hsb2rgb(c,d,g,j)}if(a[6]){f=a[6].split(Pa);c=Y(f[0]);f[0].slice(-1)=="%"&&(c*=
2.55);d=Y(f[1]);f[1].slice(-1)=="%"&&(d*=2.55);g=Y(f[2]);f[2].slice(-1)=="%"&&(g*=2.55);(f[0].slice(-3)=="deg"||f[0].slice(-1)=="\u00b0")&&(c/=360);a[1].toLowerCase().slice(0,4)=="hsla"&&(j=Y(f[3]));f[3]&&f[3].slice(-1)=="%"&&(j/=100);return q.hsl2rgb(c,d,g,j)}a={r:c,g:d,b:g};a.hex="#"+(16777216|g|d<<8|c<<16).toString(16).slice(1);q.is(j,"finite")&&(a.opacity=j);return a}return{r:-1,g:-1,b:-1,hex:"none",error:1}},q);q.getColor=function(a){a=this.getColor.start=this.getColor.start||{h:0,s:1,b:a||0.75};
var c=this.hsb2rgb(a.h,a.s,a.b);a.h+=0.075;if(a.h>1){a.h=0;a.s-=0.2;a.s<=0&&(this.getColor.start={h:0,s:1,b:a.b})}return c.hex};q.getColor.reset=function(){delete this.start};q.parsePathString=M(function(a){if(!a)return null;var c={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},d=[];q.is(a,P)&&q.is(a[0],P)&&(d=Ga(a));d[p]||n(a).replace(xb,function(g,j,f){var o=[];g=x.call(j);f.replace(yb,function(s,u){u&&o[ba](+u)});if(g=="m"&&o[p]>2){d[ba]([j].concat(o.splice(0,2)));g="l";j=j=="m"?"l":"L"}for(;o[p]>=c[g];){d[ba]([j].concat(o.splice(0,
c[g])));if(!c[g])break}});d[X]=q._path2string;return d});q.findDotsAtSegment=function(a,c,d,g,j,f,o,s,u){var w=1-u,G=r(w,3)*a+r(w,2)*3*u*d+w*3*u*u*j+r(u,3)*o;w=r(w,3)*c+r(w,2)*3*u*g+w*3*u*u*f+r(u,3)*s;var K=a+2*u*(d-a)+u*u*(j-2*d+a),L=c+2*u*(g-c)+u*u*(f-2*g+c),V=d+2*u*(j-d)+u*u*(o-2*j+d),ea=g+2*u*(f-g)+u*u*(s-2*f+g);a=(1-u)*a+u*d;c=(1-u)*c+u*g;j=(1-u)*j+u*o;f=(1-u)*f+u*s;s=90-B.atan((K-V)/(L-ea))*180/z;(K>V||L<ea)&&(s+=180);return{x:G,y:w,m:{x:K,y:L},n:{x:V,y:ea},start:{x:a,y:c},end:{x:j,y:f},alpha:s}};
var Ia=M(function(a){if(!a)return{x:0,y:0,width:0,height:0};a=Ha(a);for(var c=0,d=0,g=[],j=[],f,o=0,s=a[p];o<s;o++){f=a[o];if(f[0]=="M"){c=f[1];d=f[2];g[ba](c);j[ba](d)}else{c=Db(c,d,f[1],f[2],f[3],f[4],f[5],f[6]);g=g.concat(c.min.x,c.max.x);j=j.concat(c.min.y,c.max.y);c=f[5];d=f[6]}}a=N[J](0,g);f=N[J](0,j);return{x:a,y:f,width:E[J](0,g)-a,height:E[J](0,j)-f}}),Ga=function(a){var c=[];if(!q.is(a,P)||!q.is(a&&a[0],P))a=q.parsePathString(a);for(var d=0,g=a[p];d<g;d++){c[d]=[];for(var j=0,f=a[d][p];j<
f;j++)c[d][j]=a[d][j]}c[X]=q._path2string;return c},Qa=M(function(a){if(!q.is(a,P)||!q.is(a&&a[0],P))a=q.parsePathString(a);var c=[],d=0,g=0,j=0,f=0,o=0;if(a[0][0]=="M"){d=a[0][1];g=a[0][2];j=d;f=g;o++;c[ba](["M",d,g])}for(var s=a[p];o<s;o++){var u=c[o]=[],w=a[o];if(w[0]!=x.call(w[0])){u[0]=x.call(w[0]);switch(u[0]){case "a":u[1]=w[1];u[2]=w[2];u[3]=w[3];u[4]=w[4];u[5]=w[5];u[6]=+(w[6]-d).toFixed(3);u[7]=+(w[7]-g).toFixed(3);break;case "v":u[1]=+(w[1]-g).toFixed(3);break;case "m":j=w[1];f=w[2];default:for(var G=
1,K=w[p];G<K;G++)u[G]=+(w[G]-(G%2?d:g)).toFixed(3)}}else{c[o]=[];if(w[0]=="m"){j=w[1]+d;f=w[2]+g}u=0;for(G=w[p];u<G;u++)c[o][u]=w[u]}w=c[o][p];switch(c[o][0]){case "z":d=j;g=f;break;case "h":d+=+c[o][w-1];break;case "v":g+=+c[o][w-1];break;default:d+=+c[o][w-2];g+=+c[o][w-1]}}c[X]=q._path2string;return c},0,Ga),Aa=M(function(a){if(!q.is(a,P)||!q.is(a&&a[0],P))a=q.parsePathString(a);var c=[],d=0,g=0,j=0,f=0,o=0;if(a[0][0]=="M"){d=+a[0][1];g=+a[0][2];j=d;f=g;o++;c[0]=["M",d,g]}for(var s=a[p];o<s;o++){var u=
c[o]=[],w=a[o];if(w[0]!=wa.call(w[0])){u[0]=wa.call(w[0]);switch(u[0]){case "A":u[1]=w[1];u[2]=w[2];u[3]=w[3];u[4]=w[4];u[5]=w[5];u[6]=+(w[6]+d);u[7]=+(w[7]+g);break;case "V":u[1]=+w[1]+g;break;case "H":u[1]=+w[1]+d;break;case "M":j=+w[1]+d;f=+w[2]+g;default:for(var G=1,K=w[p];G<K;G++)u[G]=+w[G]+(G%2?d:g)}}else{G=0;for(K=w[p];G<K;G++)c[o][G]=w[G]}switch(u[0]){case "Z":d=j;g=f;break;case "H":d=u[1];break;case "V":g=u[1];break;case "M":j=c[o][c[o][p]-2];f=c[o][c[o][p]-1];default:d=c[o][c[o][p]-2];g=
c[o][c[o][p]-1]}}c[X]=q._path2string;return c},null,Ga),ab=function(a,c,d,g,j,f){var o=1/3,s=2/3;return[o*a+s*d,o*c+s*g,o*j+s*d,o*f+s*g,j,f]},bb=function(a,c,d,g,j,f,o,s,u,w){var G=z*120/180,K=z/180*(+j||0),L=[],V,ea=M(function(oa,pa,ma){var ya=oa*B.cos(ma)-pa*B.sin(ma);oa=oa*B.sin(ma)+pa*B.cos(ma);return{x:ya,y:oa}});if(w){$=w[0];V=w[1];f=w[2];S=w[3]}else{V=ea(a,c,-K);a=V.x;c=V.y;V=ea(s,u,-K);s=V.x;u=V.y;B.cos(z/180*j);B.sin(z/180*j);V=(a-s)/2;$=(c-u)/2;S=V*V/(d*d)+$*$/(g*g);if(S>1){S=B.sqrt(S);
d*=S;g*=S}S=d*d;var W=g*g;S=(f==o?-1:1)*B.sqrt(i((S*W-S*$*$-W*V*V)/(S*$*$+W*V*V)));f=S*d*$/g+(a+s)/2;var S=S*-g*V/d+(c+u)/2,$=B.asin(((c-S)/g).toFixed(9));V=B.asin(((u-S)/g).toFixed(9));$=a<f?z-$:$;V=s<f?z-V:V;$<0&&($=z*2+$);V<0&&(V=z*2+V);o&&$>V&&($-=z*2);!o&&V>$&&(V-=z*2)}if(i(V-$)>G){L=V;W=s;var ka=u;V=$+G*(o&&V>$?1:-1);s=f+d*B.cos(V);u=S+g*B.sin(V);L=bb(s,u,d,g,j,0,o,W,ka,[V,L,f,S])}f=V-$;j=B.cos($);G=B.sin($);o=B.cos(V);V=B.sin(V);f=B.tan(f/4);d=4/3*d*f;f*=4/3*g;g=[a,c];a=[a+d*G,c-f*j];c=[s+
d*V,u-f*o];s=[s,u];a[0]=2*g[0]-a[0];a[1]=2*g[1]-a[1];if(w)return[a,c,s].concat(L);L=[a,c,s].concat(L)[v]().split(",");w=[];s=0;for(u=L[p];s<u;s++)w[s]=s%2?ea(L[s-1],L[s],K).y:ea(L[s],L[s+1],K).x;return w},Ja=function(a,c,d,g,j,f,o,s,u){var w=1-u;return{x:r(w,3)*a+r(w,2)*3*u*d+w*3*u*u*j+r(u,3)*o,y:r(w,3)*c+r(w,2)*3*u*g+w*3*u*u*f+r(u,3)*s}},Db=M(function(a,c,d,g,j,f,o,s){var u=j-2*d+a-(o-2*j+d),w=2*(d-a)-2*(j-d),G=a-d,K=(-w+B.sqrt(w*w-4*u*G))/2/u;u=(-w-B.sqrt(w*w-4*u*G))/2/u;var L=[c,s],V=[a,o];i(K)>
"1e12"&&(K=0.5);i(u)>"1e12"&&(u=0.5);if(K>0&&K<1){K=Ja(a,c,d,g,j,f,o,s,K);V[ba](K.x);L[ba](K.y)}if(u>0&&u<1){K=Ja(a,c,d,g,j,f,o,s,u);V[ba](K.x);L[ba](K.y)}u=f-2*g+c-(s-2*f+g);w=2*(g-c)-2*(f-g);G=c-g;K=(-w+B.sqrt(w*w-4*u*G))/2/u;u=(-w-B.sqrt(w*w-4*u*G))/2/u;i(K)>"1e12"&&(K=0.5);i(u)>"1e12"&&(u=0.5);if(K>0&&K<1){K=Ja(a,c,d,g,j,f,o,s,K);V[ba](K.x);L[ba](K.y)}if(u>0&&u<1){K=Ja(a,c,d,g,j,f,o,s,u);V[ba](K.x);L[ba](K.y)}return{min:{x:N[J](0,V),y:N[J](0,L)},max:{x:E[J](0,V),y:E[J](0,L)}}}),Ha=M(function(a,
c){var d=Aa(a),g=c&&Aa(c),j={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},f={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o=function(W,S){var $,ka;if(!W)return["C",S.x,S.y,S.x,S.y,S.x,S.y];!(W[0]in{T:1,Q:1})&&(S.qx=S.qy=null);switch(W[0]){case "M":S.X=W[1];S.Y=W[2];break;case "A":W=["C"].concat(bb[J](0,[S.x,S.y].concat(W.slice(1))));break;case "S":$=S.x+(S.x-(S.bx||S.x));ka=S.y+(S.y-(S.by||S.y));W=["C",$,ka].concat(W.slice(1));break;case "T":S.qx=S.x+(S.x-(S.qx||S.x));S.qy=S.y+(S.y-(S.qy||S.y));W=["C"].concat(ab(S.x,
S.y,S.qx,S.qy,W[1],W[2]));break;case "Q":S.qx=W[1];S.qy=W[2];W=["C"].concat(ab(S.x,S.y,W[1],W[2],W[3],W[4]));break;case "L":W=["C"].concat([S.x,S.y,W[1],W[2],W[1],W[2]]);break;case "H":W=["C"].concat([S.x,S.y,W[1],S.y,W[1],S.y]);break;case "V":W=["C"].concat([S.x,S.y,S.x,W[1],S.x,W[1]]);break;case "Z":W=["C"].concat([S.x,S.y,S.X,S.Y,S.X,S.Y])}return W},s=function(W,S){if(W[S][p]>7){W[S].shift();for(var $=W[S];$[p];)W.splice(S++,0,["C"].concat($.splice(0,6)));W.splice(S,1);G=E(d[p],g&&g[p]||0)}},u=
function(W,S,$,ka,oa){if(W&&S&&W[oa][0]=="M"&&S[oa][0]!="M"){S.splice(oa,0,["M",ka.x,ka.y]);$.bx=0;$.by=0;$.x=W[oa][1];$.y=W[oa][2];G=E(d[p],g&&g[p]||0)}},w=0,G=E(d[p],g&&g[p]||0);for(;w<G;w++){d[w]=o(d[w],j);s(d,w);g&&(g[w]=o(g[w],f));g&&s(g,w);u(d,g,j,f,w);u(g,d,f,j,w);var K=d[w],L=g&&g[w],V=K[p],ea=g&&L[p];j.x=K[V-2];j.y=K[V-1];j.bx=Y(K[V-4])||j.x;j.by=Y(K[V-3])||j.y;f.bx=g&&(Y(L[ea-4])||f.x);f.by=g&&(Y(L[ea-3])||f.y);f.x=g&&L[ea-2];f.y=g&&L[ea-1]}return g?[d,g]:d},null,Ga),cb=M(function(a){for(var c=
[],d=0,g=a[p];d<g;d++){var j={},f=a[d].match(/^([^:]*):?([\d\.]*)/);j.color=q.getRGB(f[1]);if(j.color.error)return null;j.color=j.color.hex;f[2]&&(j.offset=f[2]+"%");c[ba](j)}d=1;for(g=c[p]-1;d<g;d++)if(!c[d].offset){a=Y(c[d-1].offset||0);f=0;for(j=d+1;j<g;j++)if(c[j].offset){f=c[j].offset;break}if(!f){f=100;j=g}f=Y(f);for(f=(f-a)/(j-d+1);d<j;d++){a+=f;c[d].offset=a+"%"}}return c}),db=function(a,c,d,g){if(q.is(a,"string")||q.is(a,"object")){a=q.is(a,"string")?e.getElementById(a):a;if(a.tagName)return c==
null?{container:a,width:a.style.pixelWidth||a.offsetWidth,height:a.style.pixelHeight||a.offsetHeight}:{container:a,width:c,height:d}}else return{container:1,x:a,y:c,width:d,height:g}},Ra=function(a,c){var d=this,g;for(g in c)if(c[H](g)&&!(g in a))switch(typeof c[g]){case "function":(function(j){a[g]=a===d?j:function(){return j[J](d,arguments)}})(c[g]);break;case "object":a[g]=a[g]||{};Ra.call(this,a[g],c[g]);break;default:a[g]=c[g]}},za=function(a,c){a==c.top&&(c.top=a.prev);a==c.bottom&&(c.bottom=
a.next);a.next&&(a.next.prev=a.prev);a.prev&&(a.prev.next=a.next)},eb=function(a,c){if(c.top!==a){za(a,c);a.next=null;a.prev=c.top;c.top.next=a;c.top=a}},fb=function(a,c){if(c.bottom!==a){za(a,c);a.next=c.bottom;a.prev=null;c.bottom.prev=a;c.bottom=a}},gb=function(a,c,d){za(a,d);c==d.top&&(d.top=a);c.next&&(c.next.prev=a);a.next=c.next;a.prev=c;c.next=a},hb=function(a,c,d){za(a,d);c==d.bottom&&(d.bottom=a);c.prev&&(c.prev.next=a);a.prev=c.prev;c.prev=a;a.next=c},ib=function(a){return function(){throw Error("Rapha\u00ebl: you are calling to method \u201c"+
a+"\u201d of removed object");}};q.pathToRelative=Qa;if(q.svg){C.svgns="http://www.w3.org/2000/svg";C.xlink="http://www.w3.org/1999/xlink";ca=function(a){return+a+(~~a===a)*0.5};var da=function(a,c){if(c)for(var d in c)c[H](d)&&a.setAttribute(d,n(c[d]));else{a=e.createElementNS(C.svgns,a);a.style.webkitTapHighlightColor="rgba(0,0,0,0)";return a}};q[X]=function(){return"Your browser supports SVG.\nYou are running Rapha\u00ebl "+this.version};var jb=function(a,c){var d=da("path");c.canvas&&c.canvas.appendChild(d);
d=new ja(d,c);d.type="path";xa(d,{fill:"none",stroke:"#000",path:a});return d},Ba=function(a,c,d){var g="linear",j=0.5,f=0.5,o=a.style;c=n(c).replace(Za,function(G,K,L){g="radial";if(K&&L){j=Y(K);f=Y(L);G=(f>0.5)*2-1;r(j-0.5,2)+r(f-0.5,2)>0.25&&(f=B.sqrt(0.25-r(j-0.5,2))*G+0.5)&&f!=0.5&&(f=f.toFixed(5)-1.0E-5*G)}return""});c=c.split(/\s*\-\s*/);if(g=="linear"){var s=c.shift();s=-Y(s);if(isNaN(s))return null;s=[0,0,B.cos(s*z/180),B.sin(s*z/180)];var u=1/(E(i(s[2]),i(s[3]))||1);s[2]*=u;s[3]*=u;if(s[2]<
0){s[0]=-s[2];s[2]=0}if(s[3]<0){s[1]=-s[3];s[3]=0}}c=cb(c);if(!c)return null;u=a.getAttribute("fill");(u=u.match(/^url\(#(.*)\)$/))&&d.defs.removeChild(e.getElementById(u[1]));u=da(g+"Gradient");u.id=Z();da(u,g=="radial"?{fx:j,fy:f}:{x1:s[0],y1:s[1],x2:s[2],y2:s[3]});d.defs.appendChild(u);d=0;for(s=c[p];d<s;d++){var w=da("stop");da(w,{offset:c[d].offset?c[d].offset:d?"100%":"0%","stop-color":c[d].color||"#fff"});u.appendChild(w)}da(a,{fill:"url(#"+u.id+")",opacity:1,"fill-opacity":1});o.fill="";o.opacity=
1;return o.fillOpacity=1},Sa=function(a){var c=a.getBBox();da(a.pattern,{patternTransform:q.format("translate({0},{1})",c.x,c.y)})},xa=function(a,c){var d={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},g=a.node,j=a.attrs,f=a.rotate(),o=function(ea,W){if(W=d[x.call(W)]){for(var S=ea.attrs["stroke-width"]||"1",$={round:S,square:S,butt:0}[ea.attrs["stroke-linecap"]||c["stroke-linecap"]]||0,
ka=[],oa=W[p];oa--;)ka[oa]=W[oa]*S+(oa%2?1:-1)*$;da(g,{"stroke-dasharray":ka[v](",")})}};c[H]("rotation")&&(f=c.rotation);var s=n(f).split(Q);if(s.length-1){s[1]=+s[1];s[2]=+s[2]}else s=null;Y(f)&&a.rotate(0,true);for(var u in c)if(c[H](u))if(Ea[H](u)){var w=c[u];j[u]=w;switch(u){case "blur":a.blur(w);break;case "rotation":a.rotate(w,true);break;case "href":case "title":case "target":var G=g.parentNode;if(x.call(G.tagName)!="a"){var K=da("a");G.insertBefore(K,g);K.appendChild(g);G=K}u=="target"&&
w=="blank"?G.setAttributeNS(a.paper.xlink,"show","new"):G.setAttributeNS(a.paper.xlink,u,w);break;case "cursor":g.style.cursor=w;break;case "clip-rect":G=n(w).split(Q);if(G[p]==4){a.clip&&a.clip.parentNode.parentNode.removeChild(a.clip.parentNode);var L=da("clipPath");K=da("rect");L.id=Z();da(K,{x:G[0],y:G[1],width:G[2],height:G[3]});L.appendChild(K);a.paper.defs.appendChild(L);da(g,{"clip-path":"url(#"+L.id+")"});a.clip=K}if(!w){(w=e.getElementById(g.getAttribute("clip-path").replace(/(^url\(#|\)$)/g,
"")))&&w.parentNode.removeChild(w);da(g,{"clip-path":""});delete a.clip}break;case "path":a.type=="path"&&da(g,{d:w?j.path=Aa(w):"M0,0"});break;case "width":g.setAttribute(u,w);if(j.fx){u="x";w=j.x}else break;case "x":j.fx&&(w=-j.x-(j.width||0));case "rx":if(u=="rx"&&a.type=="rect")break;case "cx":s&&(u=="x"||u=="cx")&&(s[1]+=w-j[u]);g.setAttribute(u,w);a.pattern&&Sa(a);break;case "height":g.setAttribute(u,w);if(j.fy){u="y";w=j.y}else break;case "y":j.fy&&(w=-j.y-(j.height||0));case "ry":if(u=="ry"&&
a.type=="rect")break;case "cy":s&&(u=="y"||u=="cy")&&(s[2]+=w-j[u]);g.setAttribute(u,w);a.pattern&&Sa(a);break;case "r":a.type=="rect"?da(g,{rx:w,ry:w}):g.setAttribute(u,w);break;case "src":a.type=="image"&&g.setAttributeNS(a.paper.xlink,"href",w);break;case "stroke-width":g.style.strokeWidth=w;g.setAttribute(u,w);j["stroke-dasharray"]&&o(a,j["stroke-dasharray"]);break;case "stroke-dasharray":o(a,w);break;case "translation":w=n(w).split(Q);w[0]=+w[0]||0;w[1]=+w[1]||0;if(s){s[1]+=w[0];s[2]+=w[1]}Ka.call(a,
w[0],w[1]);break;case "scale":w=n(w).split(Q);a.scale(+w[0]||1,+w[1]||+w[0]||1,isNaN(Y(w[2]))?null:+w[2],isNaN(Y(w[3]))?null:+w[3]);break;case "fill":if(G=n(w).match(fa)){L=da("pattern");var V=da("image");L.id=Z();da(L,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});da(V,{x:0,y:0});V.setAttributeNS(a.paper.xlink,"href",G[1]);L.appendChild(V);w=e.createElement("img");w.style.cssText="position:absolute;left:-9999em;top-9999em";w.onload=function(){da(L,{width:this.offsetWidth,height:this.offsetHeight});
da(V,{width:this.offsetWidth,height:this.offsetHeight});e.body.removeChild(this);a.paper.safari()};e.body.appendChild(w);w.src=G[1];a.paper.defs.appendChild(L);g.style.fill="url(#"+L.id+")";da(g,{fill:"url(#"+L.id+")"});a.pattern=L;a.pattern&&Sa(a);break}G=q.getRGB(w);if(G.error)if(({circle:1,ellipse:1}[H](a.type)||n(w).charAt()!="r")&&Ba(g,w,a.paper)){j.gradient=w;j.fill="none";break}else{delete c.gradient;delete j.gradient;!q.is(j.opacity,"undefined")&&q.is(c.opacity,"undefined")&&da(g,{opacity:j.opacity});
!q.is(j["fill-opacity"],"undefined")&&q.is(c["fill-opacity"],"undefined")&&da(g,{"fill-opacity":j["fill-opacity"]})}G[H]("opacity")&&da(g,{"fill-opacity":G.opacity>1?G.opacity/100:G.opacity});case "stroke":G=q.getRGB(w);g.setAttribute(u,G.hex);u=="stroke"&&G[H]("opacity")&&da(g,{"stroke-opacity":G.opacity>1?G.opacity/100:G.opacity});break;case "gradient":(({circle:1,ellipse:1})[H](a.type)||n(w).charAt()!="r")&&Ba(g,w,a.paper);break;case "opacity":j.gradient&&!j[H]("stroke-opacity")&&da(g,{"stroke-opacity":w>
1?w/100:w});case "fill-opacity":if(j.gradient){if(G=e.getElementById(g.getAttribute("fill").replace(/^url\(#|\)$/g,""))){G=G.getElementsByTagName("stop");G[G[p]-1].setAttribute("stop-opacity",w)}break}default:u=="font-size"&&(w=na(w,10)+"px");G=u.replace(/(\-.)/g,function(ea){return wa.call(ea.substring(1))});g.style[G]=w;g.setAttribute(u,w)}}Eb(a,c);s?a.rotate(s.join(aa)):Y(f)&&a.rotate(f,true)},Eb=function(a,c){if(!(a.type!="text"||!(c[H]("text")||c[H]("font")||c[H]("font-size")||c[H]("x")||c[H]("y")))){var d=
a.attrs,g=a.node,j=g.firstChild?na(e.defaultView.getComputedStyle(g.firstChild,"").getPropertyValue("font-size"),10):10;if(c[H]("text")){for(d.text=c.text;g.firstChild;)g.removeChild(g.firstChild);for(var f=n(c.text).split("\n"),o=0,s=f[p];o<s;o++)if(f[o]){var u=da("tspan");o&&da(u,{dy:j*1.2,x:d.x});u.appendChild(e.createTextNode(f[o]));g.appendChild(u)}}else{f=g.getElementsByTagName("tspan");o=0;for(s=f[p];o<s;o++)o&&da(f[o],{dy:j*1.2,x:d.x})}da(g,{y:d.y});j=a.getBBox();(j=d.y-(j.y+j.height/2))&&
q.is(j,"finite")&&da(g,{y:d.y+j})}},ja=function(a,c){this[0]=a;this.id=q._oid++;this.node=a;a.raphael=this;this.paper=c;this.attrs=this.attrs||{};this.transformations=[];this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1};!c.bottom&&(c.bottom=this);(this.prev=c.top)&&(c.top.next=this);c.top=this;this.next=null},ia=ja[O];ja[O].rotate=function(a,c,d){if(this.removed)return this;if(a==null){if(this._.rt.cx)return[this._.rt.deg,this._.rt.cx,this._.rt.cy][v](aa);return this._.rt.deg}var g=this.getBBox();
a=n(a).split(Q);if(a[p]-1){c=Y(a[1]);d=Y(a[2])}a=Y(a[0]);c!=null&&c!==false?this._.rt.deg=a:this._.rt.deg+=a;d==null&&(c=null);this._.rt.cx=c;this._.rt.cy=d;c=c==null?g.x+g.width/2:c;d=d==null?g.y+g.height/2:d;if(this._.rt.deg){this.transformations[0]=q.format("rotate({0} {1} {2})",this._.rt.deg,c,d);this.clip&&da(this.clip,{transform:q.format("rotate({0} {1} {2})",-this._.rt.deg,c,d)})}else{this.transformations[0]="";this.clip&&da(this.clip,{transform:""})}da(this.node,{transform:this.transformations[v](aa)});
return this};ja[O].hide=function(){!this.removed&&(this.node.style.display="none");return this};ja[O].show=function(){!this.removed&&(this.node.style.display="");return this};ja[O].remove=function(){if(!this.removed){za(this,this.paper);this.node.parentNode.removeChild(this.node);for(var a in this)delete this[a];this.removed=true}};ja[O].getBBox=function(){if(this.removed)return this;if(this.type=="path")return Ia(this.attrs.path);if(this.node.style.display=="none"){this.show();var a=true}var c={};
try{c=this.node.getBBox()}catch(d){}finally{c=c||{}}if(this.type=="text"){c={x:c.x,y:Infinity,width:0,height:0};for(var g=0,j=this.node.getNumberOfChars();g<j;g++){var f=this.node.getExtentOfChar(g);f.y<c.y&&(c.y=f.y);f.y+f.height-c.y>c.height&&(c.height=f.y+f.height-c.y);f.x+f.width-c.x>c.width&&(c.width=f.x+f.width-c.x)}}a&&this.hide();return c};ja[O].attr=function(a,c){if(this.removed)return this;if(a==null){var d={},g;for(g in this.attrs)this.attrs[H](g)&&(d[g]=this.attrs[g]);this._.rt.deg&&(d.rotation=
this.rotate());(this._.sx!=1||this._.sy!=1)&&(d.scale=this.scale());d.gradient&&d.fill=="none"&&(d.fill=d.gradient)&&delete d.gradient;return d}if(c==null&&q.is(a,"string")){if(a=="translation")return Ka.call(this);if(a=="rotation")return this.rotate();if(a=="scale")return this.scale();if(a=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;return this.attrs[a]}if(c==null&&q.is(a,P)){g={};d=0;for(var j=a.length;d<j;d++)g[a[d]]=this.attr(a[d]);return g}if(c!=null){d={};
d[a]=c}else a!=null&&q.is(a,"object")&&(d=a);for(j in this.paper.customAttributes)if(this.paper.customAttributes[H](j)&&d[H](j)&&q.is(this.paper.customAttributes[j],"function")){g=this.paper.customAttributes[j].apply(this,[].concat(d[j]));this.attrs[j]=d[j];for(var f in g)g[H](f)&&(d[f]=g[f])}xa(this,d);return this};ja[O].toFront=function(){if(this.removed)return this;this.node.parentNode.appendChild(this.node);var a=this.paper;a.top!=this&&eb(this,a);return this};ja[O].toBack=function(){if(this.removed)return this;
if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);fb(this,this.paper)}return this};ja[O].insertAfter=function(a){if(this.removed)return this;var c=a.node||a[a.length-1].node;c.nextSibling?c.parentNode.insertBefore(this.node,c.nextSibling):c.parentNode.appendChild(this.node);gb(this,a,this.paper);return this};ja[O].insertBefore=function(a){if(this.removed)return this;var c=a.node||a[0].node;c.parentNode.insertBefore(this.node,
c);hb(this,a,this.paper);return this};ja[O].blur=function(a){if(+a!==0){var c=da("filter"),d=da("feGaussianBlur");this.attrs.blur=a;c.id=Z();da(d,{stdDeviation:+a||1.5});c.appendChild(d);this.paper.defs.appendChild(c);this._blur=c;da(this.node,{filter:"url(#"+c.id+")"})}else{if(this._blur){this._blur.parentNode.removeChild(this._blur);delete this._blur;delete this.attrs.blur}this.node.removeAttribute("filter")}};var kb=function(a,c,d,g){var j=da("circle");a.canvas&&a.canvas.appendChild(j);a=new ja(j,
a);a.attrs={cx:c,cy:d,r:g,fill:"none",stroke:"#000"};a.type="circle";da(j,a.attrs);return a},lb=function(a,c,d,g,j,f){var o=da("rect");a.canvas&&a.canvas.appendChild(o);a=new ja(o,a);a.attrs={x:c,y:d,width:g,height:j,r:f||0,rx:f||0,ry:f||0,fill:"none",stroke:"#000"};a.type="rect";da(o,a.attrs);return a},mb=function(a,c,d,g,j){var f=da("ellipse");a.canvas&&a.canvas.appendChild(f);a=new ja(f,a);a.attrs={cx:c,cy:d,rx:g,ry:j,fill:"none",stroke:"#000"};a.type="ellipse";da(f,a.attrs);return a},nb=function(a,
c,d,g,j,f){var o=da("image");da(o,{x:d,y:g,width:j,height:f,preserveAspectRatio:"none"});o.setAttributeNS(a.xlink,"href",c);a.canvas&&a.canvas.appendChild(o);a=new ja(o,a);a.attrs={x:d,y:g,width:j,height:f,src:c};a.type="image";return a},ob=function(a,c,d,g){var j=da("text");da(j,{x:c,y:d,"text-anchor":"middle"});a.canvas&&a.canvas.appendChild(j);a=new ja(j,a);a.attrs={x:c,y:d,"text-anchor":"middle",text:g,font:Ea.font,stroke:"none",fill:"#000"};a.type="text";xa(a,a.attrs);return a},pb=function(a,
c){this.width=a||this.width;this.height=c||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);return this},Na=function(){var a=db[J](0,arguments),c=a&&a.container,d=a.x,g=a.y,j=a.width;a=a.height;if(!c)throw Error("SVG container not found.");var f=da("svg");d=d||0;g=g||0;j=j||512;a=a||342;da(f,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:j,height:a});if(c==1){f.style.cssText="position:absolute;left:"+d+"px;top:"+g+"px";e.body.appendChild(f)}else c.firstChild?
c.insertBefore(f,c.firstChild):c.appendChild(f);c=new y;c.width=j;c.height=a;c.canvas=f;Ra.call(c,c,q.fn);c.clear();return c};C.clear=function(){for(var a=this.canvas;a.firstChild;)a.removeChild(a.firstChild);this.bottom=this.top=null;(this.desc=da("desc")).appendChild(e.createTextNode("Created with Rapha\u00ebl"));a.appendChild(this.desc);a.appendChild(this.defs=da("defs"))};C.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=ib(a)}}if(q.vml){var qb=
{M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Fb=/([clmz]),?([^clmz]*)/gi,Gb=/ progid:\S+Blur\([^\)]+\)/g,Hb=/-?[^,\s-]+/g,Ca=1E3+aa+1E3,Da={path:1,rect:1},Ib=function(a){var c=/[ahqstv]/ig,d=Aa;n(a).match(c)&&(d=Ha);c=/[clmz]/g;if(d==Aa&&!n(a).match(c))return a=n(a).replace(Fb,function(u,w,G){var K=[],L=x.call(w)=="m",V=qb[w];G.replace(Hb,function(ea){if(L&&K[p]==2){V+=K+qb[w=="m"?"l":"L"];K=[]}K[ba](ca(ea*10))});return V+K});c=d(a);var g;a=[];for(var j=0,f=c[p];j<f;j++){d=c[j];g=x.call(c[j][0]);
g=="z"&&(g="x");for(var o=1,s=d[p];o<s;o++)g+=ca(d[o]*10)+(o!=s-1?",":"");a[ba](g)}return a[v](aa)};q[X]=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\u00ebl "+this.version};jb=function(a,c){var d=qa("group");d.style.cssText="position:absolute;left:0;top:0;width:"+c.width+"px;height:"+c.height+"px";d.coordsize=c.coordsize;d.coordorigin=c.coordorigin;var g=qa("shape"),j=g.style;j.width=c.width+"px";j.height=c.height+"px";g.coordsize=Ca;g.coordorigin=
c.coordorigin;d.appendChild(g);g=new ja(g,d,c);j={fill:"none",stroke:"#000"};a&&(j.path=a);g.type="path";g.path=[];g.Path="";xa(g,j);c.canvas.appendChild(d);return g};xa=function(a,c){a.attrs=a.attrs||{};var d=a.node,g=a.attrs,j=d.style,f;f=(c.x!=g.x||c.y!=g.y||c.width!=g.width||c.height!=g.height||c.r!=g.r)&&a.type=="rect";for(var o in c)c[H](o)&&(g[o]=c[o]);if(f){g.path=rb(g.x,g.y,g.width,g.height,g.r);a.X=g.x;a.Y=g.y;a.W=g.width;a.H=g.height}c.href&&(d.href=c.href);c.title&&(d.title=c.title);c.target&&
(d.target=c.target);c.cursor&&(j.cursor=c.cursor);"blur"in c&&a.blur(c.blur);if(c.path&&a.type=="path"||f)d.path=Ib(g.path);c.rotation!=null&&a.rotate(c.rotation,true);if(c.translation){f=n(c.translation).split(Q);Ka.call(a,f[0],f[1]);if(a._.rt.cx!=null){a._.rt.cx+=+f[0];a._.rt.cy+=+f[1];a.setBox(a.attrs,f[0],f[1])}}if(c.scale){f=n(c.scale).split(Q);a.scale(+f[0]||1,+f[1]||+f[0]||1,+f[2]||null,+f[3]||null)}if("clip-rect"in c){f=n(c["clip-rect"]).split(Q);if(f[p]==4){f[2]=+f[2]+ +f[0];f[3]=+f[3]+ +f[1];
o=d.clipRect||e.createElement("div");var s=o.style,u=d.parentNode;s.clip=q.format("rect({1}px {2}px {3}px {0}px)",f);if(!d.clipRect){s.position="absolute";s.top=0;s.left=0;s.width=a.paper.width+"px";s.height=a.paper.height+"px";u.parentNode.insertBefore(o,u);o.appendChild(u);d.clipRect=o}}c["clip-rect"]||d.clipRect&&(d.clipRect.style.clip="")}a.type=="image"&&c.src&&(d.src=c.src);if(a.type=="image"&&c.opacity){d.filterOpacity=" progid:DXImageTransform.Microsoft.Alpha(opacity="+c.opacity*100+")";j.filter=
(d.filterMatrix||"")+(d.filterOpacity||"")}c.font&&(j.font=c.font);c["font-family"]&&(j.fontFamily='"'+c["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,"")+'"');c["font-size"]&&(j.fontSize=c["font-size"]);c["font-weight"]&&(j.fontWeight=c["font-weight"]);c["font-style"]&&(j.fontStyle=c["font-style"]);if(c.opacity!=null||c["stroke-width"]!=null||c.fill!=null||c.stroke!=null||c["stroke-width"]!=null||c["stroke-opacity"]!=null||c["fill-opacity"]!=null||c["stroke-dasharray"]!=null||c["stroke-miterlimit"]!=
null||c["stroke-linejoin"]!=null||c["stroke-linecap"]!=null){d=a.shape||d;f=d.getElementsByTagName("fill")&&d.getElementsByTagName("fill")[0];o=false;!f&&(o=f=qa("fill"));if("fill-opacity"in c||"opacity"in c){j=((+g["fill-opacity"]+1||2)-1)*((+g.opacity+1||2)-1)*((+q.getRGB(c.fill).o+1||2)-1);j=N(E(j,0),1);f.opacity=j}c.fill&&(f.on=true);if(f.on==null||c.fill=="none")f.on=false;if(f.on&&c.fill)if(j=c.fill.match(fa)){f.src=j[1];f.type="tile"}else{f.color=q.getRGB(c.fill).hex;f.src="";f.type="solid";
if(q.getRGB(c.fill).error&&(a.type in{circle:1,ellipse:1}||n(c.fill).charAt()!="r")&&Ba(a,c.fill)){g.fill="none";g.gradient=c.fill}}o&&d.appendChild(f);f=d.getElementsByTagName("stroke")&&d.getElementsByTagName("stroke")[0];o=false;!f&&(o=f=qa("stroke"));if(c.stroke&&c.stroke!="none"||c["stroke-width"]||c["stroke-opacity"]!=null||c["stroke-dasharray"]||c["stroke-miterlimit"]||c["stroke-linejoin"]||c["stroke-linecap"])f.on=true;(c.stroke=="none"||f.on==null||c.stroke==0||c["stroke-width"]==0)&&(f.on=
false);j=q.getRGB(c.stroke);f.on&&c.stroke&&(f.color=j.hex);j=((+g["stroke-opacity"]+1||2)-1)*((+g.opacity+1||2)-1)*((+j.o+1||2)-1);s=(Y(c["stroke-width"])||1)*0.75;j=N(E(j,0),1);c["stroke-width"]==null&&(s=g["stroke-width"]);c["stroke-width"]&&(f.weight=s);s&&s<1&&(j*=s)&&(f.weight=1);f.opacity=j;c["stroke-linejoin"]&&(f.joinstyle=c["stroke-linejoin"]||"miter");f.miterlimit=c["stroke-miterlimit"]||8;c["stroke-linecap"]&&(f.endcap=c["stroke-linecap"]=="butt"?"flat":c["stroke-linecap"]=="square"?"square":
"round");if(c["stroke-dasharray"]){j={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};f.dashstyle=j[H](c["stroke-dasharray"])?j[c["stroke-dasharray"]]:""}o&&d.appendChild(f)}if(a.type=="text"){j=a.paper.span.style;g.font&&(j.font=g.font);g["font-family"]&&(j.fontFamily=g["font-family"]);g["font-size"]&&(j.fontSize=g["font-size"]);g["font-weight"]&&(j.fontWeight=g["font-weight"]);
g["font-style"]&&(j.fontStyle=g["font-style"]);a.node.string&&(a.paper.span.innerHTML=n(a.node.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));a.W=g.w=a.paper.span.offsetWidth;a.H=g.h=a.paper.span.offsetHeight;a.X=g.x;a.Y=g.y+ca(a.H/2);switch(g["text-anchor"]){case "start":a.node.style["v-text-align"]="left";a.bbx=ca(a.W/2);break;case "end":a.node.style["v-text-align"]="right";a.bbx=-ca(a.W/2);break;default:a.node.style["v-text-align"]="center"}}};Ba=function(a,c){a.attrs=
a.attrs||{};var d,g="linear",j=".5 .5";a.attrs.gradient=c;c=n(c).replace(Za,function(G,K,L){g="radial";if(K&&L){K=Y(K);L=Y(L);r(K-0.5,2)+r(L-0.5,2)>0.25&&(L=B.sqrt(0.25-r(K-0.5,2))*((L>0.5)*2-1)+0.5);j=K+aa+L}return""});c=c.split(/\s*\-\s*/);if(g=="linear"){var f=c.shift();f=-Y(f);if(isNaN(f))return null}var o=cb(c);if(!o)return null;a=a.shape||a.node;d=a.getElementsByTagName("fill")[0]||qa("fill");!d.parentNode&&a.appendChild(d);if(o[p]){d.on=true;d.method="none";d.color=o[0].color;d.color2=o[o[p]-
1].color;for(var s=[],u=0,w=o[p];u<w;u++)o[u].offset&&s[ba](o[u].offset+aa+o[u].color);d.colors&&(d.colors.value=s[p]?s[v]():"0% "+d.color);if(g=="radial"){d.type="gradientradial";d.focus="100%";d.focussize=j;d.focusposition=j}else{d.type="gradient";d.angle=(270-f)%360}}return 1};ja=function(a,c,d){this[0]=a;this.id=q._oid++;this.node=a;a.raphael=this;this.Y=this.X=0;this.attrs={};this.Group=c;this.paper=d;this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1};!d.bottom&&(d.bottom=this);(this.prev=d.top)&&(d.top.next=
this);d.top=this;this.next=null};ia=ja[O];ia.rotate=function(a,c,d){if(this.removed)return this;if(a==null){if(this._.rt.cx)return[this._.rt.deg,this._.rt.cx,this._.rt.cy][v](aa);return this._.rt.deg}a=n(a).split(Q);if(a[p]-1){c=Y(a[1]);d=Y(a[2])}a=Y(a[0]);c!=null?this._.rt.deg=a:this._.rt.deg+=a;d==null&&(c=null);this._.rt.cx=c;this._.rt.cy=d;this.setBox(this.attrs,c,d);this.Group.style.rotation=this._.rt.deg;return this};ia.setBox=function(a,c,d){if(this.removed)return this;var g=this.Group.style,
j=this.shape&&this.shape.style||this.node.style;a=a||{};for(var f in a)a[H](f)&&(this.attrs[f]=a[f]);c=c||this._.rt.cx;d=d||this._.rt.cy;var o=this.attrs,s;switch(this.type){case "circle":a=o.cx-o.r;f=o.cy-o.r;s=o=o.r*2;break;case "ellipse":a=o.cx-o.rx;f=o.cy-o.ry;s=o.rx*2;o=o.ry*2;break;case "image":a=+o.x;f=+o.y;s=o.width||0;o=o.height||0;break;case "text":this.textpath.v=["m",ca(o.x),", ",ca(o.y-2),"l",ca(o.x)+1,", ",ca(o.y-2)][v]("");a=o.x-ca(this.W/2);f=o.y-this.H/2;s=this.W;o=this.H;break;case "rect":case "path":if(this.attrs.path){o=
Ia(this.attrs.path);a=o.x;f=o.y;s=o.width;o=o.height}else{f=a=0;s=this.paper.width;o=this.paper.height}break;default:f=a=0;s=this.paper.width;o=this.paper.height}c=(c==null?a+s/2:c)-this.paper.width/2;d=(d==null?f+o/2:d)-this.paper.height/2;var u;g.left!=(u=c+"px")&&(g.left=u);g.top!=(u=d+"px")&&(g.top=u);this.X=Da[H](this.type)?-c:a;this.Y=Da[H](this.type)?-d:f;this.W=s;this.H=o;if(Da[H](this.type)){j.left!=(u=-c*10+"px")&&(j.left=u);j.top!=(u=-d*10+"px")&&(j.top=u)}else if(this.type=="text"){j.left!=
(u=-c+"px")&&(j.left=u);j.top!=(u=-d+"px")&&(j.top=u)}else{g.width!=(u=this.paper.width+"px")&&(g.width=u);g.height!=(u=this.paper.height+"px")&&(g.height=u);j.left!=(u=a-c+"px")&&(j.left=u);j.top!=(u=f-d+"px")&&(j.top=u);j.width!=(u=s+"px")&&(j.width=u);j.height!=(u=o+"px")&&(j.height=u)}};ia.hide=function(){!this.removed&&(this.Group.style.display="none");return this};ia.show=function(){!this.removed&&(this.Group.style.display="block");return this};ia.getBBox=function(){if(this.removed)return this;
if(Da[H](this.type))return Ia(this.attrs.path);return{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}};ia.remove=function(){if(!this.removed){za(this,this.paper);this.node.parentNode.removeChild(this.node);this.Group.parentNode.removeChild(this.Group);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this)delete this[a];this.removed=true}};ia.attr=function(a,c){if(this.removed)return this;if(a==null){var d={},g;for(g in this.attrs)this.attrs[H](g)&&(d[g]=this.attrs[g]);
this._.rt.deg&&(d.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(d.scale=this.scale());d.gradient&&d.fill=="none"&&(d.fill=d.gradient)&&delete d.gradient;return d}if(c==null&&q.is(a,"string")){if(a=="translation")return Ka.call(this);if(a=="rotation")return this.rotate();if(a=="scale")return this.scale();if(a=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;return this.attrs[a]}if(this.attrs&&c==null&&q.is(a,P)){var j={};g=0;for(d=a[p];g<d;g++)j[a[g]]=this.attr(a[g]);
return j}if(c!=null){d={};d[a]=c}c==null&&q.is(a,"object")&&(d=a);if(d){for(j in this.paper.customAttributes)if(this.paper.customAttributes[H](j)&&d[H](j)&&q.is(this.paper.customAttributes[j],"function")){g=this.paper.customAttributes[j].apply(this,[].concat(d[j]));this.attrs[j]=d[j];for(var f in g)g[H](f)&&(d[f]=g[f])}d.text&&this.type=="text"&&(this.node.string=d.text);xa(this,d);d.gradient&&({circle:1,ellipse:1}[H](this.type)||n(d.gradient).charAt()!="r")&&Ba(this,d.gradient);(!Da[H](this.type)||
this._.rt.deg)&&this.setBox(this.attrs)}return this};ia.toFront=function(){!this.removed&&this.Group.parentNode.appendChild(this.Group);this.paper.top!=this&&eb(this,this.paper);return this};ia.toBack=function(){if(this.removed)return this;if(this.Group.parentNode.firstChild!=this.Group){this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild);fb(this,this.paper)}return this};ia.insertAfter=function(a){if(this.removed)return this;a.constructor==sa&&(a=a[a.length-1]);a.Group.nextSibling?
a.Group.parentNode.insertBefore(this.Group,a.Group.nextSibling):a.Group.parentNode.appendChild(this.Group);gb(this,a,this.paper);return this};ia.insertBefore=function(a){if(this.removed)return this;a.constructor==sa&&(a=a[0]);a.Group.parentNode.insertBefore(this.Group,a.Group);hb(this,a,this.paper);return this};ia.blur=function(a){var c=this.node.runtimeStyle,d=c.filter;d=d.replace(Gb,"");if(+a!==0){this.attrs.blur=a;c.filter=d+aa+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+a||1.5)+")";
c.margin=q.format("-{0}px 0 0 -{0}px",ca(+a||1.5))}else{c.filter=d;c.margin=0;delete this.attrs.blur}};kb=function(a,c,d,g){var j=qa("group"),f=qa("oval");j.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";j.coordsize=Ca;j.coordorigin=a.coordorigin;j.appendChild(f);f=new ja(f,j,a);f.type="circle";xa(f,{stroke:"#000",fill:"none"});f.attrs.cx=c;f.attrs.cy=d;f.attrs.r=g;f.setBox({x:c-g,y:d-g,width:g*2,height:g*2});a.canvas.appendChild(j);return f};var rb=function(a,
c,d,g,j){return j?q.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",a+j,c,d-j*2,j,-j,g-j*2,j*2-d,j*2-g):q.format("M{0},{1}l{2},0,0,{3},{4},0z",a,c,d,g,-d)};lb=function(a,c,d,g,j,f){var o=rb(c,d,g,j,f);a=a.path(o);var s=a.attrs;a.X=s.x=c;a.Y=s.y=d;a.W=s.width=g;a.H=s.height=j;s.r=f;s.path=o;a.type="rect";return a};mb=function(a,c,d,g,j){var f=qa("group"),o=qa("oval");f.style.cssText="position:absolute;left:0;top:0;width:"+
a.width+"px;height:"+a.height+"px";f.coordsize=Ca;f.coordorigin=a.coordorigin;f.appendChild(o);o=new ja(o,f,a);o.type="ellipse";xa(o,{stroke:"#000"});o.attrs.cx=c;o.attrs.cy=d;o.attrs.rx=g;o.attrs.ry=j;o.setBox({x:c-g,y:d-j,width:g*2,height:j*2});a.canvas.appendChild(f);return o};nb=function(a,c,d,g,j,f){var o=qa("group"),s=qa("image");o.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";o.coordsize=Ca;o.coordorigin=a.coordorigin;s.src=c;o.appendChild(s);s=new ja(s,
o,a);s.type="image";s.attrs.src=c;s.attrs.x=d;s.attrs.y=g;s.attrs.w=j;s.attrs.h=f;s.setBox({x:d,y:g,width:j,height:f});a.canvas.appendChild(o);return s};ob=function(a,c,d,g){var j=qa("group"),f=qa("shape"),o=f.style,s=qa("path"),u=qa("textpath");j.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";j.coordsize=Ca;j.coordorigin=a.coordorigin;s.v=q.format("m{0},{1}l{2},{1}",ca(c*10),ca(d*10),ca(c*10)+1);s.textpathok=true;o.width=a.width;o.height=a.height;u.string=
n(g);u.on=true;f.appendChild(u);f.appendChild(s);j.appendChild(f);o=new ja(u,j,a);o.shape=f;o.textpath=s;o.type="text";o.attrs.text=g;o.attrs.x=c;o.attrs.y=d;o.attrs.w=1;o.attrs.h=1;xa(o,{font:Ea.font,stroke:"none",fill:"#000"});o.setBox();a.canvas.appendChild(j);return o};pb=function(a,c){var d=this.canvas.style;a==+a&&(a+="px");c==+c&&(c+="px");d.width=a;d.height=c;d.clip="rect(0 "+a+" "+c+" 0)";return this};var qa;e.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!e.namespaces.rvml&&
e.namespaces.add("rvml","urn:schemas-microsoft-com:vml");qa=function(a){return e.createElement("<rvml:"+a+' class="rvml">')}}catch(Pb){qa=function(a){return e.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}Na=function(){var a=db[J](0,arguments),c=a.container,d=a.height,g=a.width,j=a.x;a=a.y;if(!c)throw Error("VML container not found.");var f=new y,o=f.canvas=e.createElement("div"),s=o.style;j=j||0;a=a||0;g=g||512;d=d||342;g==+g&&(g+="px");d==+d&&(d+="px");f.width=1E3;
f.height=1E3;f.coordsize=1E4+aa+1E4;f.coordorigin="0 0";f.span=e.createElement("span");f.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";o.appendChild(f.span);s.cssText=q.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",g,d);if(c==1){e.body.appendChild(o);s.left=j+"px";s.top=a+"px";s.position="absolute"}else c.firstChild?c.insertBefore(o,c.firstChild):c.appendChild(o);
Ra.call(f,f,q.fn);return f};C.clear=function(){this.canvas.innerHTML="";this.span=e.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};C.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=ib(a);return true}}ta=navigator.userAgent.match(/Version\\x2f(.*?)\s/);navigator.vendor=="Apple Computer, Inc."&&(ta&&ta[1]<
4||navigator.platform.slice(0,2)=="iP")?C.safari=function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});h.setTimeout(function(){a.remove()})}:C.safari=function(){};var Jb=function(){this.returnValue=false},Kb=function(){return this.originalEvent.preventDefault()},Lb=function(){this.cancelBubble=true},Mb=function(){return this.originalEvent.stopPropagation()},Nb=function(){if(e.addEventListener)return function(a,c,d,g){var j=U&&D[c]?D[c]:c,f=function(o){if(U&&D[H](c))for(var s=
0,u=o.targetTouches&&o.targetTouches.length;s<u;s++)if(o.targetTouches[s].target==a){u=o;o=o.targetTouches[s];o.originalEvent=u;o.preventDefault=Kb;o.stopPropagation=Mb;break}return d.call(g,o)};a.addEventListener(j,f,false);return function(){a.removeEventListener(j,f,false);return true}};if(e.attachEvent)return function(a,c,d,g){var j=function(f){f=f||h.event;f.preventDefault=f.preventDefault||Jb;f.stopPropagation=f.stopPropagation||Lb;return d.call(g,f)};a.attachEvent("on"+c,j);return function(){a.detachEvent("on"+
c,j);return true}}}(),ua=[],Ta=function(a){for(var c=a.clientX,d=a.clientY,g=e.documentElement.scrollTop||e.body.scrollTop,j=e.documentElement.scrollLeft||e.body.scrollLeft,f,o=ua.length;o--;){f=ua[o];if(U)for(var s=a.touches.length,u;s--;){u=a.touches[s];if(u.identifier==f.el._drag.id){c=u.clientX;d=u.clientY;(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();c+=j;d+=g;f.move&&f.move.call(f.move_scope||f.el,c-f.el._drag.x,d-f.el._drag.y,c,d,a)}},Ua=function(a){q.unmousemove(Ta).unmouseup(Ua);
for(var c=ua.length,d;c--;){d=ua[c];d.el._drag={};d.end&&d.end.call(d.end_scope||d.start_scope||d.move_scope||d.el,a)}ua=[]};for(ta=l[p];ta--;)(function(a){q[a]=ja[O][a]=function(c,d){if(q.is(c,"function")){this.events=this.events||[];this.events.push({name:a,f:c,unbind:Nb(this.shape||this.node||e,a,c,d||this)})}return this};q["un"+a]=ja[O]["un"+a]=function(c){for(var d=this.events,g=d[p];g--;)if(d[g].name==a&&d[g].f==c){d[g].unbind();d.splice(g,1);!d.length&&delete this.events;break}return this}})(l[ta]);
ia.hover=function(a,c,d,g){return this.mouseover(a,d).mouseout(c,g||d)};ia.unhover=function(a,c){return this.unmouseover(a).unmouseout(c)};ia.drag=function(a,c,d,g,j,f){this._drag={};this.mousedown(function(o){(o.originalEvent||o).preventDefault();var s=e.documentElement.scrollTop||e.body.scrollTop,u=e.documentElement.scrollLeft||e.body.scrollLeft;this._drag.x=o.clientX+u;this._drag.y=o.clientY+s;this._drag.id=o.identifier;c&&c.call(j||g||this,o.clientX+u,o.clientY+s,o);!ua.length&&q.mousemove(Ta).mouseup(Ua);
ua.push({el:this,move:a,end:d,move_scope:g,start_scope:j,end_scope:f})});return this};ia.undrag=function(a,c,d){for(c=ua.length;c--;)ua[c].el==this&&ua[c].move==a&&ua[c].end==d&&ua.splice(c++,1);!ua.length&&q.unmousemove(Ta).unmouseup(Ua)};C.circle=function(a,c,d){return kb(this,a||0,c||0,d||0)};C.rect=function(a,c,d,g,j){return lb(this,a||0,c||0,d||0,g||0,j||0)};C.ellipse=function(a,c,d,g){return mb(this,a||0,c||0,d||0,g||0)};C.path=function(a){a&&!q.is(a,"string")&&!q.is(a[0],P)&&(a+="");return jb(q.format[J](q,
arguments),this)};C.image=function(a,c,d,g,j){return nb(this,a||"about:blank",c||0,d||0,g||0,j||0)};C.text=function(a,c,d){return ob(this,a||0,c||0,n(d))};C.set=function(a){arguments[p]>1&&(a=Array[O].splice.call(arguments,0,arguments[p]));return new sa(a)};C.setSize=pb;C.top=C.bottom=null;C.raphael=q;ia.resetScale=function(){if(this.removed)return this;this._.sx=1;this._.sy=1;this.attrs.scale="1 1"};ia.scale=function(a,c,d,g){if(this.removed)return this;if(a==null&&c==null)return{x:this._.sx,y:this._.sy,
toString:A};c=c||a;!+c&&(c=a);var j,f,o=this.attrs;if(a!=0){var s=this.getBBox(),u=s.x+s.width/2,w=s.y+s.height/2;j=i(a/this._.sx);f=i(c/this._.sy);d=+d||d==0?d:u;g=+g||g==0?g:w;var G=this._.sx>0,K=this._.sy>0;s=~~(a/i(a));var L=~~(c/i(c)),V=j*s,ea=f*L,W=this.node.style;u=d+i(u-d)*V*(u>d==G?1:-1);w=g+i(w-g)*ea*(w>g==K?1:-1);var S=a*s>c*L?f:j;switch(this.type){case "rect":case "image":var $=o.width*j,ka=o.height*f;this.attr({height:ka,r:o.r*S,width:$,x:u-$/2,y:w-ka/2});break;case "circle":case "ellipse":this.attr({rx:o.rx*
j,ry:o.ry*f,r:o.r*S,cx:u,cy:w});break;case "text":this.attr({x:u,y:w});break;case "path":S=Qa(o.path);var oa=true;G=G?V:j;K=K?ea:f;ea=0;for(V=S[p];ea<V;ea++){var pa=S[ea],ma=wa.call(pa[0]);if(!(ma=="M"&&oa)){oa=false;if(ma=="A"){pa[S[ea][p]-2]*=G;pa[S[ea][p]-1]*=K;pa[1]*=j;pa[2]*=f;pa[5]=+(s+L?!!+pa[5]:!+pa[5])}else if(ma=="H"){ma=1;for(var ya=pa[p];ma<ya;ma++)pa[ma]*=G}else if(ma=="V"){ma=1;for(ya=pa[p];ma<ya;ma++)pa[ma]*=K}else{ma=1;for(ya=pa[p];ma<ya;ma++)pa[ma]*=ma%2?G:K}}}f=Ia(S);j=u-f.x-f.width/
2;f=w-f.y-f.height/2;S[0][1]+=j;S[0][2]+=f;this.attr({path:S})}if(this.type in{text:1,image:1}&&(s!=1||L!=1))if(this.transformations){this.transformations[2]="scale(".concat(s,",",L,")");this.node.setAttribute("transform",this.transformations[v](aa));j=s==-1?-o.x-($||0):o.x;f=L==-1?-o.y-(ka||0):o.y;this.attr({x:j,y:f});o.fx=s-1;o.fy=L-1}else{this.node.filterMatrix=" progid:DXImageTransform.Microsoft"+".Matrix(M11=".concat(s,", M12=0, M21=0, M22=",L,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')");
W.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}else if(this.transformations){this.transformations[2]="";this.node.setAttribute("transform",this.transformations[v](aa));o.fx=0;o.fy=0}else{this.node.filterMatrix="";W.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}o.scale=[a,c,d,g][v](aa);this._.sx=a;this._.sy=c}return this};ia.clone=function(){if(this.removed)return null;var a=this.attr();delete a.scale;delete a.translation;return this.paper[this.type]().attr(a)};
var Va={},La=function(a,c,d,g,j,f,o,s,u){var w=0,G=100,K=[a,c,d,g,j,f,o,s].join(),L=Va[K],V,ea;!L&&(Va[K]=L={data:[]});L.timer&&clearTimeout(L.timer);L.timer=setTimeout(function(){delete Va[K]},2E3);if(u!=null)G=~~La(a,c,d,g,j,f,o,s)*10;for(var W=0;W<G+1;W++){if(L.data[u]>W)ea=L.data[W*G];else{ea=q.findDotsAtSegment(a,c,d,g,j,f,o,s,W/G);L.data[W]=ea}W&&(w+=r(r(V.x-ea.x,2)+r(V.y-ea.y,2),0.5));if(u!=null&&w>=u)return ea;V=ea}if(u==null)return w};l=function(a,c){return function(d,g,j){d=Ha(d);for(var f,
o,s,u,w="",G={},K=0,L=0,V=d.length;L<V;L++){s=d[L];if(s[0]=="M"){f=+s[1];o=+s[2]}else{u=La(f,o,s[1],s[2],s[3],s[4],s[5],s[6]);if(K+u>g){if(c&&!G.start){f=La(f,o,s[1],s[2],s[3],s[4],s[5],s[6],g-K);w+=["C",f.start.x,f.start.y,f.m.x,f.m.y,f.x,f.y];if(j)return w;G.start=w;w=["M",f.x,f.y+"C",f.n.x,f.n.y,f.end.x,f.end.y,s[5],s[6]][v]();K+=u;f=+s[5];o=+s[6];continue}if(!a&&!c){f=La(f,o,s[1],s[2],s[3],s[4],s[5],s[6],g-K);return{x:f.x,y:f.y,alpha:f.alpha}}}K+=u;f=+s[5];o=+s[6]}w+=s}G.end=w;f=a?K:c?G:q.findDotsAtSegment(f,
o,s[1],s[2],s[3],s[4],s[5],s[6],1);f.alpha&&(f={x:f.x,y:f.y,alpha:f.alpha});return f}};var sb=l(1),Ma=l(),Wa=l(0,1);ia.getTotalLength=function(){if(this.type=="path"){if(this.node.getTotalLength)return this.node.getTotalLength();return sb(this.attrs.path)}};ia.getPointAtLength=function(a){if(this.type=="path")return Ma(this.attrs.path,a)};ia.getSubpath=function(a,c){if(this.type=="path"){if(i(this.getTotalLength()-c)<"1e-6")return Wa(this.attrs.path,a).end;var d=Wa(this.attrs.path,c,1);return a?Wa(d,
a).end:d}};q.easing_formulas={linear:function(a){return a},"<":function(a){return r(a,3)},">":function(a){return r(a-1,3)+1},"<>":function(a){a*=2;if(a<1)return r(a,3)/2;a-=2;return(r(a,3)+2)/2},backIn:function(a){return a*a*(2.70158*a-1.70158)},backOut:function(a){a-=1;return a*a*(2.70158*a+1.70158)+1},elastic:function(a){if(a==0||a==1)return a;return r(2,-10*a)*B.sin((a-0.075)*2*z/0.3)+1},bounce:function(a){if(a<1/2.75)a*=7.5625*a;else if(a<2/2.75){a-=1.5/2.75;a=7.5625*a*a+0.75}else if(a<2.5/2.75){a-=
2.25/2.75;a=7.5625*a*a+0.9375}else{a-=2.625/2.75;a=7.5625*a*a+0.984375}return a}};var va=[],tb=function(){for(var a=+new Date,c=0;c<va[p];c++){var d=va[c];if(!(d.stop||d.el.removed)){var g=a-d.start,j=d.ms,f=d.easing,o=d.from,s=d.diff,u=d.to,w=d.t,G=d.el;d={};var K;if(g<j){g=f(g/j);for(var L in o)if(o[H](L)){switch(Oa[L]){case "along":K=g*j*s[L];u.back&&(K=u.len-K);f=Ma(u[L],K);G.translate(s.sx-s.x||0,s.sy-s.y||0);s.x=f.x;s.y=f.y;G.translate(f.x-s.sx,f.y-s.sy);u.rot&&G.rotate(s.r+f.alpha,f.x,f.y);
break;case F:K=+o[L]+g*j*s[L];break;case "colour":K="rgb("+[Xa(ca(o[L].r+g*j*s[L].r)),Xa(ca(o[L].g+g*j*s[L].g)),Xa(ca(o[L].b+g*j*s[L].b))][v](",")+")";break;case "path":K=[];f=0;for(var V=o[L][p];f<V;f++){K[f]=[o[L][f][0]];for(var ea=1,W=o[L][f][p];ea<W;ea++)K[f][ea]=+o[L][f][ea]+g*j*s[L][f][ea];K[f]=K[f][v](aa)}K=K[v](aa);break;case "csv":switch(L){case "translation":K=g*j*s[L][0]-w.x;f=g*j*s[L][1]-w.y;w.x+=K;w.y+=f;K=K+aa+f;break;case "rotation":K=+o[L][0]+g*j*s[L][0];o[L][1]&&(K+=","+o[L][1]+","+
o[L][2]);break;case "scale":K=[+o[L][0]+g*j*s[L][0],+o[L][1]+g*j*s[L][1],2 in u[L]?u[L][2]:"",3 in u[L]?u[L][3]:""][v](aa);break;case "clip-rect":K=[];for(f=4;f--;)K[f]=+o[L][f]+g*j*s[L][f]}break;default:V=[].concat(o[L]);K=[];for(f=G.paper.customAttributes[L].length;f--;)K[f]=+V[f]+g*j*s[L][f]}d[L]=K}G.attr(d);G._run&&G._run.call(G)}else{if(u.along){f=Ma(u.along,u.len*!u.back);G.translate(s.sx-(s.x||0)+f.x-s.sx,s.sy-(s.y||0)+f.y-s.sy);u.rot&&G.rotate(s.r+f.alpha,f.x,f.y)}(w.x||w.y)&&G.translate(-w.x,
-w.y);u.scale&&(u.scale+="");G.attr(u);va.splice(c--,1)}}}q.svg&&G&&G.paper&&G.paper.safari();va[p]&&setTimeout(tb)},Ob=function(a,c,d,g,j){var f=d-g;c.timeouts.push(setTimeout(function(){q.is(j,"function")&&j.call(c);c.animate(a,f,a.easing)},g))},Xa=function(a){return E(N(a,255),0)},Ka=function(a,c){if(a==null)return{x:this._.tx,y:this._.ty,toString:A};this._.tx+=+a;this._.ty+=+c;switch(this.type){case "circle":case "ellipse":this.attr({cx:+a+this.attrs.cx,cy:+c+this.attrs.cy});break;case "rect":case "image":case "text":this.attr({x:+a+
this.attrs.x,y:+c+this.attrs.y});break;case "path":var d=Qa(this.attrs.path);d[0][1]+=+a;d[0][2]+=+c;this.attr({path:d})}return this};ia.animateWith=function(a,c,d,g,j){for(var f=0,o=va.length;f<o;f++)va[f].el.id==a.id&&(c.start=va[f].start);return this.animate(c,d,g,j)};ia.animateAlong=T();ia.animateAlongBack=T(1);ia.onAnimation=function(a){this._run=a||0;return this};ia.animate=function(a,c,d,g){var j=this;j.timeouts=j.timeouts||[];if(q.is(d,"function")||!d)g=d||null;if(j.removed){g&&g.call(j);
return j}var f={},o={},s=false,u={},w;for(w in a)if(a[H](w))if(Oa[H](w)||j.paper.customAttributes[H](w)){s=true;f[w]=j.attr(w);f[w]==null&&(f[w]=Ea[w]);o[w]=a[w];switch(Oa[w]){case "along":var G=sb(a[w]),K=Ma(a[w],G*!!a.back),L=j.getBBox();u[w]=G/c;u.tx=L.x;u.ty=L.y;u.sx=K.x;u.sy=K.y;o.rot=a.rot;o.back=a.back;o.len=G;a.rot&&(u.r=Y(j.rotate())||0);break;case F:u[w]=(o[w]-f[w])/c;break;case "colour":f[w]=q.getRGB(f[w]);G=q.getRGB(o[w]);u[w]={r:(G.r-f[w].r)/c,g:(G.g-f[w].g)/c,b:(G.b-f[w].b)/c};break;
case "path":G=Ha(f[w],o[w]);f[w]=G[0];L=G[1];u[w]=[];G=0;for(K=f[w][p];G<K;G++){u[w][G]=[0];for(var V=1,ea=f[w][G][p];V<ea;V++)u[w][G][V]=(L[G][V]-f[w][G][V])/c}break;case "csv":K=n(a[w]).split(Q);L=n(f[w]).split(Q);switch(w){case "translation":f[w]=[0,0];u[w]=[K[0]/c,K[1]/c];break;case "rotation":f[w]=L[1]==K[1]&&L[2]==K[2]?L:[0,K[1],K[2]];u[w]=[(K[0]-f[w][0])/c,0,0];break;case "scale":a[w]=K;f[w]=n(f[w]).split(Q);u[w]=[(K[0]-f[w][0])/c,(K[1]-f[w][1])/c,0,0];break;case "clip-rect":f[w]=n(f[w]).split(Q);
u[w]=[];for(G=4;G--;)u[w][G]=(K[G]-f[w][G])/c}o[w]=K;break;default:K=[].concat(a[w]);L=[].concat(f[w]);u[w]=[];for(G=j.paper.customAttributes[w][p];G--;)u[w][G]=((K[G]||0)-(L[G]||0))/c}}if(s){w=q.easing_formulas[d];if(!w)if((w=n(d).match(ra))&&w[p]==5){var W=w;w=function(ka){return m(ka,+W[1],+W[2],+W[3],+W[4],c)}}else w=function(ka){return ka};va.push({start:a.start||+new Date,ms:c,easing:w,from:f,diff:u,to:o,el:j,t:{x:0,y:0}});q.is(g,"function")&&(j._ac=setTimeout(function(){g.call(j)},c));va[p]==
1&&setTimeout(tb)}else{d=[];var S,$;for($ in a)if(a[H]($)&&ub.test($)){w={value:a[$]};$=="from"&&($=0);$=="to"&&($=100);w.key=na($,10);d.push(w)}d.sort(Ab);d[0].key&&d.unshift({key:0,value:j.attrs});G=0;for(K=d[p];G<K;G++)Ob(d[G].value,j,c/100*d[G].key,c/100*(d[G-1]&&d[G-1].key||0),d[G-1]&&d[G-1].value.callback);(S=d[d[p]-1].value.callback)&&j.timeouts.push(setTimeout(function(){S.call(j)},c))}return this};ia.stop=function(){for(var a=0;a<va.length;a++)va[a].el.id==this.id&&va.splice(a--,1);a=0;for(ii=
this.timeouts&&this.timeouts.length;a<ii;a++)clearTimeout(this.timeouts[a]);this.timeouts=[];clearTimeout(this._ac);delete this._ac;return this};ia.translate=function(a,c){return this.attr({translation:a+" "+c})};ia[X]=function(){return"Rapha\u00ebl\u2019s object"};q.ae=va;var sa=function(a){this.items=[];this[p]=0;this.type="set";if(a)for(var c=0,d=a[p];c<d;c++)if(a[c]&&(a[c].constructor==ja||a[c].constructor==sa)){this[this.items[p]]=this.items[this.items[p]]=a[c];this[p]++}};sa[O][ba]=function(){for(var a,
c,d=0,g=arguments[p];d<g;d++)if((a=arguments[d])&&(a.constructor==ja||a.constructor==sa)){c=this.items[p];this[c]=this.items[c]=a;this[p]++}return this};sa[O].pop=function(){delete this[this[p]--];return this.items.pop()};for(var Ya in ia)ia[H](Ya)&&(sa[O][Ya]=function(a){return function(){for(var c=0,d=this.items[p];c<d;c++)this.items[c][a][J](this.items[c],arguments);return this}}(Ya));sa[O].attr=function(a,c){if(a&&q.is(a,P)&&q.is(a[0],"object"))for(var d=0,g=a[p];d<g;d++)this.items[d].attr(a[d]);
else{d=0;for(g=this.items[p];d<g;d++)this.items[d].attr(a,c)}return this};sa[O].animate=function(a,c,d,g){(q.is(d,"function")||!d)&&(g=d||null);var j=this.items[p],f=j,o,s=this,u;g&&(u=function(){!--j&&g.call(s)});d=q.is(d,"string")?d:u;for(o=this.items[--f].animate(a,c,d,u);f--;)this.items[f]&&!this.items[f].removed&&this.items[f].animateWith(o,a,c,d,u);return this};sa[O].insertAfter=function(a){for(var c=this.items[p];c--;)this.items[c].insertAfter(a);return this};sa[O].getBBox=function(){for(var a=
[],c=[],d=[],g=[],j=this.items[p];j--;){var f=this.items[j].getBBox();a[ba](f.x);c[ba](f.y);d[ba](f.x+f.width);g[ba](f.y+f.height)}a=N[J](0,a);c=N[J](0,c);return{x:a,y:c,width:E[J](0,d)-a,height:E[J](0,g)-c}};sa[O].clone=function(a){a=new sa;for(var c=0,d=this.items[p];c<d;c++)a[ba](this.items[c].clone());return a};q.registerFont=function(a){if(!a.face)return a;this.fonts=this.fonts||{};var c={w:a.w,face:{},glyphs:{}},d=a.face["font-family"],g;for(g in a.face)a.face[H](g)&&(c.face[g]=a.face[g]);this.fonts[d]?
this.fonts[d][ba](c):this.fonts[d]=[c];if(!a.svg){c.face["units-per-em"]=na(a.face["units-per-em"],10);for(var j in a.glyphs)if(a.glyphs[H](j)){d=a.glyphs[j];c.glyphs[j]={w:d.w,k:{},d:d.d&&"M"+d.d.replace(/[mlcxtrv]/g,function(o){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[o]||"M"})+"z"};if(d.k)for(var f in d.k)d[H](f)&&(c.glyphs[j].k[f]=d.k[f])}}return a};C.getFont=function(a,c,d,g){g=g||"normal";d=d||"normal";c=+c||{normal:400,bold:700,lighter:300,bolder:800}[c]||400;if(q.fonts){var j=q.fonts[a];
if(!j){a=RegExp("(^|\\s)"+a.replace(/[^\w\d\s+!~.:_-]/g,"")+"(\\s|$)","i");for(var f in q.fonts)if(q.fonts[H](f))if(a.test(f)){j=q.fonts[f];break}}var o;if(j){f=0;for(a=j[p];f<a;f++){o=j[f];if(o.face["font-weight"]==c&&(o.face["font-style"]==d||!o.face["font-style"])&&o.face["font-stretch"]==g)break}}return o}};C.print=function(a,c,d,g,j,f,o){f=f||"middle";o=E(N(o||0,1),-1);var s=this.set(),u=n(d).split(""),w=0;q.is(g,d)&&(g=this.getFont(g));if(g){d=(j||16)/g.face["units-per-em"];var G=g.face.bbox.split(Q);
j=+G[0];f=+G[1]+(f=="baseline"?G[3]-G[1]+ +g.face.descent:(G[3]-G[1])/2);G=0;for(var K=u[p];G<K;G++){var L=G&&g.glyphs[u[G-1]]||{},V=g.glyphs[u[G]];w+=G?(L.w||g.w)+(L.k&&L.k[u[G]]||0)+g.w*o:0;V&&V.d&&s[ba](this.path(V.d).attr({fill:"#000",stroke:"none",translation:[w,0]}))}s.scale(d,d,j,f).translate(a-j,c-f)}return s};q.format=function(a,c){var d=q.is(c,P)?[0].concat(c):arguments;a&&q.is(a,"string")&&d[p]-1&&(a=a.replace(I,function(g,j){return d[++j]==null?"":d[j]}));return a||""};q.ninja=function(){k.was?
h.Raphael=k.is:delete Raphael;return q};q.el=ia;q.st=sa[O];k.was?h.Raphael=q:Raphael=q})();(function(){function q(v){return(v+"").replace(U,"")}function Z(v,p,x){for(var B=v.length;B<p;B++)v=x?"0"+v:v+"0";return v}function M(v){return D.call(v)==="[object Array]"}function A(v,p){if(v.indexOf)return v.indexOf(p);for(var x=0,B=v.length;x<B;x++)if(v[x]===p)return x;return-1}function T(v,p,x){var B=p["-"];p=p["+"];var E;switch(x){case "n -":B=" "+B;p=" "+p;case "n-":if(v.substr(v.length-B.length)===B)E=["-",v.substr(0,v.length-B.length)];else if(v.substr(v.length-p.length)===p)E=["+",v.substr(0,
v.length-p.length)];break;case "- n":B+=" ";p+=" ";case "-n":if(v.indexOf(B)===0)E=["-",v.substr(B.length)];else if(v.indexOf(p)===0)E=["+",v.substr(p.length)];break;case "(n)":if(v.indexOf("(")===0&&v.substr(v.length-1)===")")E=["-",v.substr(1,v.length-2)]}return E||["",v]}function m(v,p){if(!p)return 0;for(var x,B=v.getTime(),E=0,N=p.length;E<N;E++){x=p[E].start;if(x===null||B>=x)return E}return 0}function Q(v){return v.split("\u00a0").join(" ").toUpperCase()}function R(v){for(var p=[],x=0,B=v.length;x<
B;x++)p[x]=Q(v[x]);return p}function I(v,p,x,B){v=v.getFullYear();if(!B&&p.eras)v-=p.eras[x].offset;return v}function O(v,p){for(var x=0,B=false,E=0,N=v.length;E<N;E++){var i=v.charAt(E);switch(i){case "'":if(B)p.push("'");else x++;B=false;break;case "\\":B&&p.push("\\");B=!B;break;default:p.push(i);B=false}}return x}function H(v,p){p=p||"F";var x;x=v.patterns;var B=p.length;if(B===1){x=x[p];if(!x)throw"Invalid date format string '"+p+"'.";p=x}else if(B===2&&p.charAt(0)==="%")p=p.charAt(1);return p}
function e(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g}function h(v,p,x){v=q(v);x=x.calendar;a:{var B=x._parseRegExp;if(B){var E=B[p];if(E){p=E;break a}}else x._parseRegExp=B={};E=H(x,p).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var N=["^"],i=[],r=0,z=0,F=e(),P;(P=F.exec(E))!==null;){var X=E.slice(r,P.index);r=F.lastIndex;z+=O(X,N);if(z%2)N.push(P[0]);else{X=P[0];var ga=X.length;switch(X){case "dddd":case "ddd":case "MMMM":case "MMM":case "gg":case "g":X=
"(\\D+)";break;case "tt":case "t":X="(\\D*)";break;case "yyyy":case "fff":case "ff":case "f":X="(\\d{"+ga+"})";break;case "dd":case "d":case "MM":case "M":case "yy":case "y":case "HH":case "H":case "hh":case "h":case "mm":case "m":case "ss":case "s":X="(\\d\\d?)";break;case "zzz":X="([+-]?\\d\\d?:\\d{2})";break;case "zz":case "z":X="([+-]?\\d\\d?)";break;case "/":X="(\\"+x["/"]+")";break;default:throw"Invalid date format pattern '"+X+"'.";}X&&N.push(X);i.push(P[0])}}O(E.slice(r),N);N.push("$");E=
{regExp:N.join("").replace(/\s+/g,"\\s+"),groups:i};p=B[p]=E}z=RegExp(p.regExp).exec(v);if(z===null)return null;F=p.groups;var ba=v=null,fa=null,la=p=null;i=N=E=B=0;P=null;r=false;X=0;for(ga=F.length;X<ga;X++){var ha=z[X+1];if(ha){var ra=F[X],ca=ra.length,Y=parseInt(ha,10);switch(ra){case "dd":case "d":p=Y;if(p<1||p>31)return null;break;case "MMM":case "MMMM":fa=x;ca=ca===3;ra=fa.months;var na=fa.monthsGenitive||fa.months,wa=fa._upperMonths;Y=fa._upperMonthsGen;if(!wa){fa._upperMonths=wa=[R(ra.names),
R(ra.namesAbbr)];fa._upperMonthsGen=Y=[R(na.names),R(na.namesAbbr)]}ha=Q(ha);fa=A(ca?wa[1]:wa[0],ha);if(fa<0)fa=A(ca?Y[1]:Y[0],ha);if(fa<0||fa>11)return null;break;case "M":case "MM":fa=Y-1;if(fa<0||fa>11)return null;break;case "y":case "yy":case "yyyy":if(ca<4){ba=x;ha=Y;Y=new Date;ra=m(Y);if(ha<100){ca=ba.twoDigitYearMax;ca=typeof ca==="string"?(new Date).getFullYear()%100+parseInt(ca,10):ca;ba=I(Y,ba,ra);ha+=ba-ba%100;if(ha>ca)ha-=100}ba=ha}else ba=Y;if(ba<0||ba>9999)return null;break;case "h":case "hh":B=
Y;if(B===12)B=0;if(B<0||B>11)return null;break;case "H":case "HH":B=Y;if(B<0||B>23)return null;break;case "m":case "mm":E=Y;if(E<0||E>59)return null;break;case "s":case "ss":N=Y;if(N<0||N>59)return null;break;case "tt":case "t":r=x.PM&&(ha===x.PM[0]||ha===x.PM[1]||ha===x.PM[2]);if(!r&&(!x.AM||ha!==x.AM[0]&&ha!==x.AM[1]&&ha!==x.AM[2]))return null;break;case "f":case "ff":case "fff":i=Y*Math.pow(10,3-ca);if(i<0||i>999)return null;break;case "ddd":case "dddd":la=ha;ha=ca===3;Y=void 0;Y=x.days;ca=x._upperDays;
if(!ca)x._upperDays=ca=[R(Y.names),R(Y.namesAbbr),R(Y.namesShort)];la=Q(la);if(ha){Y=A(ca[1],la);if(Y===-1)Y=A(ca[2],la)}else Y=A(ca[0],la);la=Y;if(la<0||la>6)return null;break;case "zzz":ca=ha.split(/:/);if(ca.length!==2)return null;P=parseInt(ca[0],10);if(P<-12||P>13)return null;ca=parseInt(ca[1],10);if(ca<0||ca>59)return null;P=P*60+(ha.indexOf("-")===0?-ca:ca);break;case "z":case "zz":P=Y;if(P<-12||P>13)return null;P*=60;break;case "g":case "gg":if(!ha||!x.eras)return null;ha=q(ha.toLowerCase());
ca=0;for(Y=x.eras.length;ca<Y;ca++)if(ha===x.eras[ca].name.toLowerCase()){v=ca;break}if(v===null)return null}}}z=new Date;F=(X=x.convert)?X.fromGregorian(z)[0]:z.getFullYear();if(ba===null)ba=F;else if(x.eras)ba+=x.eras[v||0].offset;if(fa===null)fa=0;if(p===null)p=1;if(X){z=X.toGregorian(ba,fa,p);if(z===null)return null}else{z.setFullYear(ba,fa,p);if(z.getDate()!==p)return null;if(la!==null&&z.getDay()!==la)return null}if(r&&B<12)B+=12;z.setHours(B,E,N,i);if(P!==null){x=z.getMinutes()-(P+z.getTimezoneOffset());
z.setHours(z.getHours()+parseInt(x/60,10),x%60)}return z}function k(v,p,x){function B(ca,Y){var na;na=ca+"";if(Y>1&&na.length<Y){na=X[Y-2]+na;return na.substr(na.length-Y,Y)}return na}function E(){if(ga||ba)return ga;ga=fa.test(p);ba=true;return ga}function N(ca,Y){if(ra)return ra[Y];switch(Y){case 0:return ca.getFullYear();case 1:return ca.getMonth();case 2:return ca.getDate()}}var i=x.calendar,r=i.convert;if(!p||!p.length||p==="i"){if(x&&x.name.length)if(r)x=k(v,i.patterns.F,x);else{x=new Date(v.getTime());
var z=m(v,i.eras);x.setFullYear(I(v,i,z));x=x.toLocaleString()}else x=v.toString();return x}z=i.eras;var F=p==="s";p=H(i,p);x=[];var P,X=["0","00","000"],ga,ba,fa=/([^d]|^)(d|dd)([^d]|$)/g,la=0,ha=e(),ra;if(!F&&r)ra=r.fromGregorian(v);for(;;){P=ha.lastIndex;r=ha.exec(p);P=p.slice(P,r?r.index:p.length);la+=O(P,x);if(!r)break;if(la%2)x.push(r[0]);else{P=r[0];r=P.length;switch(P){case "ddd":case "dddd":x.push((r===3?i.days.namesAbbr:i.days.names)[v.getDay()]);break;case "d":case "dd":ga=true;x.push(B(N(v,
2),r));break;case "MMM":case "MMMM":P=N(v,1);x.push(i.monthsGenitive&&E()?i.monthsGenitive[r===3?"namesAbbr":"names"][P]:i.months[r===3?"namesAbbr":"names"][P]);break;case "M":case "MM":x.push(B(N(v,1)+1,r));break;case "y":case "yy":case "yyyy":P=ra?ra[0]:I(v,i,m(v,z),F);if(r<4)P%=100;x.push(B(P,r));break;case "h":case "hh":P=v.getHours()%12;if(P===0)P=12;x.push(B(P,r));break;case "H":case "HH":x.push(B(v.getHours(),r));break;case "m":case "mm":x.push(B(v.getMinutes(),r));break;case "s":case "ss":x.push(B(v.getSeconds(),
r));break;case "t":case "tt":P=v.getHours()<12?i.AM?i.AM[0]:" ":i.PM?i.PM[0]:" ";x.push(r===1?P.charAt(0):P);break;case "f":case "ff":case "fff":x.push(B(v.getMilliseconds(),3).substr(0,r));break;case "z":case "zz":P=v.getTimezoneOffset()/60;x.push((P<=0?"+":"-")+B(Math.floor(Math.abs(P)),r));break;case "zzz":P=v.getTimezoneOffset()/60;x.push((P<=0?"+":"-")+B(Math.floor(Math.abs(P)),2)+":"+B(Math.abs(v.getTimezoneOffset()%60),2));break;case "g":case "gg":i.eras&&x.push(i.eras[m(v,z)].name);break;
case "/":x.push(i["/"]);break;default:throw"Invalid date format pattern '"+P+"'.";}}}return x.join("")}var y={},C={en:{}};C["default"]=C.en;y.extend=function(v){for(var p=arguments[1]||{},x=2,B=arguments.length;x<B;x++){var E=arguments[x];if(E)for(var N in E){var i=E[N];if(typeof i!=="undefined")if(v&&(D.call(i)==="[object Object]"||M(i))){var r=p[N];r=r&&(D.call(r)==="[object Object]"||M(r))?r:M(i)?[]:{};p[N]=this.extend(true,r,i)}else p[N]=i}}return p};y.findClosestCulture=function(v){var p;if(!v)return this.culture||
this.cultures["default"];if(D.call(v)==="[object String]")v=v.split(",");if(M(v)){var x,B=this.cultures,E=v,N,i=E.length,r=[];for(N=0;N<i;N++){v=q(E[N]);v=v.split(";");x=q(v[0]);if(v.length===1)v=1;else{v=q(v[1]);if(v.indexOf("q=")===0){v=v.substr(2);v=parseFloat(v,10);v=isNaN(v)?0:v}else v=1}r.push({lang:x,pri:v})}r.sort(function(F,P){return F.pri<P.pri?1:-1});for(N=0;N<i;N++){x=r[N].lang;if(p=B[x])return p}for(N=0;N<i;N++){x=r[N].lang;do{E=x.lastIndexOf("-");if(E===-1)break;x=x.substr(0,E);if(p=
B[x])return p}while(1)}for(N=0;N<i;N++){x=r[N].lang;for(var z in B){E=B[z];if(E.language==x)return E}}}else if(typeof v==="object")return v;return p||null};y.preferCulture=function(v){this.culture=this.findClosestCulture(v)||this.cultures["default"]};y.localize=function(v,p,x){if(typeof p!=="string")p=this.culture.name||this.culture||"default";p=this.cultures[p]||{name:p};var B=C[p.name];if(arguments.length===3){B||(B=C[p.name]={});B[v]=x}else{if(B)x=B[v];if(typeof x==="undefined"){if(B=C[p.language])x=
B[v];if(typeof x==="undefined")x=C["default"][v]}}return typeof x==="undefined"?null:x};y.format=function(v,p,x){x=this.findClosestCulture(x);if(typeof v==="number"){var B=v;if(!p||p==="i")v=x.name.length?B.toLocaleString():B.toString();else{p=p||"D";x=x.numberFormat;v=Math.abs(B);var E=-1;if(p.length>1)E=parseInt(p.slice(1),10);var N=p.charAt(0).toUpperCase(),i;switch(N){case "D":p="n";if(E!==-1)v=Z(""+v,E,true);if(B<0)v=-v;break;case "N":i=x;case "C":i=i||x.currency;case "P":i=i||x.percent;p=B<
0?i.pattern[0]:i.pattern[1]||"n";if(E===-1)E=i.decimals;b:{var r=v*(N==="P"?100:1);N=i;i=N.groupSizes;v=i[0];B=1;var z=Math.pow(10,E),F=Math.round(r*z)/z;isFinite(F)||(F=r);z="";z=(F+"").split(/e/i);F=z.length>1?parseInt(z[1],10):0;r=z[0];z=r.split(".");r=z[0];z=z.length>1?z[1]:"";if(F>0){z=Z(z,F,false);r+=z.slice(0,F);z=z.substr(F)}else if(F<0){F=-F;r=Z(r,F+1);z=r.slice(-F,r.length)+z;r=r.slice(0,-F)}z=E>0?N["."]+(z.length>E?z.slice(0,E):Z(z,E)):"";E=r.length-1;N=N[","];for(F="";E>=0;){if(v===0||
v>E){v=r.slice(0,E+1)+(F.length?N+F+z:z);break b}F=r.slice(E-v+1,E+1)+(F.length?N+F:"");E-=v;if(B<i.length){v=i[B];B++}}v=r.slice(0,E+1)+N+F+z}break;default:throw"Bad number format specifier: "+N;}i=/n|\$|-|%/g;for(B="";;){E=i.lastIndex;N=i.exec(p);B+=p.slice(E,N?N.index:p.length);if(!N)break;switch(N[0]){case "n":B+=v;break;case "$":B+=x.currency.symbol;break;case "-":if(/[1-9]/.test(v))B+=x["-"];break;case "%":B+=x.percent.symbol}}v=B}}else if(v instanceof Date)v=k(v,p,x);return v};y.parseInt=function(v,
p,x){return Math.floor(this.parseFloat(v,p,x))};y.parseFloat=function(v,p,x){if(typeof p==="string"){x=p;p=10}x=this.findClosestCulture(x);var B=NaN,E=x.numberFormat;if(v.indexOf(x.numberFormat.currency.symbol)>-1){v=v.replace(x.numberFormat.currency.symbol,"");v=v.replace(x.numberFormat.currency["."],x.numberFormat["."])}v=q(v);if(aa.test(v))B=parseFloat(v,p);else if(!p&&n.test(v))B=parseInt(v,16);else{x=T(v,E,E.pattern[0]);p=x[0];x=x[1];if(p===""&&E.pattern[0]!=="-n"){x=T(v,E,"-n");p=x[0];x=x[1]}p=
p||"+";var N;v=x.indexOf("e");if(v<0)v=x.indexOf("E");if(v<0){N=x;v=null}else{N=x.substr(0,v);v=x.substr(v+1)}var i=E["."],r=N.indexOf(i);if(r<0){x=N;N=null}else{x=N.substr(0,r);N=N.substr(r+i.length)}i=E[","];x=x.split(i).join("");r=i.replace(/\u00A0/g," ");if(i!==r)x=x.split(r).join("");p+=x;if(N!==null)p+="."+N;if(v!==null){E=T(v,E,"-n");p+="e"+(E[0]||"+")+E[1]}if(l.test(p))B=parseFloat(p)}return B};y.parseDate=function(v,p,x){x=this.findClosestCulture(x);var B,E;if(p){if(typeof p==="string")p=
[p];if(p.length){E=0;for(var N=p.length;E<N;E++){var i=p[E];if(i)if(B=h(v,i,x))break}}}else{p=x.calendar.patterns;for(E in p)if(B=h(v,p[E],x))break}return B||null};var J=y.cultures=y.cultures||{};J=J["default"]=J.en=y.extend(true,{name:"en",englishName:"English",nativeName:"English",isRTL:false,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)",
"$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul",
"Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}}},J.en);J.calendar=J.calendar||J.calendars.standard;var U=/^\s+|\s+$/g,aa=/^[+-]?infinity$/i,n=/^0x[a-f0-9]+$/i,l=/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/,D=Object.prototype.toString;
jQuery.global=y})();(function(q){var Z=q("<b/>");q.subscribe=function(M,A){function T(){return A.apply(this,Array.prototype.slice.call(arguments,1))}T.guid=A.guid=A.guid||(q.guid?q.guid++:q.event.guid++);Z.bind(M,T)};q.unsubscribe=function(){Z.unbind.apply(Z,arguments)};q.publish=function(){Z.trigger.apply(Z,arguments)}})(jQuery);timeglider=window.timeglider||{version:"0.1.0"};timeglider.TG_Date={};
(function(q){function Z(e){return parseInt(e,10)}function M(e){var h=parseInt(e,10);return h>9||h<0?String(e):"0"+h}q=timeglider;var A=jQuery,T={},m={},Q={},R={},I={},O=/^(\-?\d+)?(\-\d{1,2})?(\-\d{1,2})?(?:T| )?(\d{1,2})?(?::)?(\d{1,2})?(?::)?(\d{1,2})?(\+|\-)?(\d{1,2})?(?::)?(\d{1,2})?/;q.TG_Date=function(e,h,k){var y,C,J;k=k||0;if(typeof e=="number"){y=C=H.getDateFromSec(e);J=e+k}else if(typeof e!=="object"){if(e=="today")e=H.getToday();y=C=e}if(O.test(y)){e=H.parse8601(y);if(e.tz_ho)e=H.toFromUTC(e,
{hours:e.tz_ho,minutes:e.tz_mi},"to");A.extend(this,e);this.rd=H.getRataDie(this);this.mo_num=this.ye>0?(this.ye-1)*12+this.mo:-1*((Math.abs(this.ye)-1)*12+(12-(this.mo-1)));if(!J){J=Math.abs(this.rd)*86400;e=this.ho*3600;y=(this.mi-1)*60;k=1;if(this.rd<0)k=-1;J=k*(J+e+y)}this.sec=J;this.date_display=h?h.toLowerCase().substr(0,2):"da";this.dateStr=C}else return{error:"invalid date"};return this};var H=q.TG_Date;H.getTimeUnitSerial=function(e,h){var k=0;switch(h){case "da":k=e.rd;break;case "mo":k=
e.mo_num;break;case "ye":k=e.ye;break;case "de":k=Math.floor(e.ye/10);break;case "ce":k=Math.floor(e.ye/100);break;case "thou":k=Math.floor(e.ye/1E3);break;case "tenthou":k=Math.floor(e.ye/1E4);break;case "hundredthou":k=Math.floor(e.ye/1E5);break;case "mill":k=Math.floor(e.ye/1E6);break;case "tenmill":k=Math.floor(e.ye/1E7);break;case "hundredmill":k=Math.floor(e.ye/1E8);break;case "bill":k=Math.floor(e.ye/1E9)}return k};H.getMonthDays=function(e,h){return H.isLeapYear(h)==true&&e==2?29:H.monthsDayNums[e]};
H.twentyFourToTwelve=function(e){var h={};h.ye=e.ye;h.mo=e.mo;h.da=e.da;h.ho=e.ho;h.mi=e.mi;h.ampm="am";if(e.ho)if(e.ho>=12){h.ampm="pm";h.ho=e.ho>12?e.ho-12:12}else if(e.ho==0){h.ho=12;h.ampm="am"}else h.ho=e.ho;else{h.ho=12;h.mi=0;h.ampm="am"}return h};H.getMonthAdj=function(e,h){var k=H.getDateFromMonthNum(e);switch(k.mo){case 1:case 3:case 5:case 7:case 8:case 10:case 12:k=Math.floor(h+h/28*3);return{width:k,days:31};case 2:if(H.isLeapYear(k.ye)==true){k=Math.floor(h+h/28);return{width:k,days:29}}else return{width:h,
days:28};default:k=Math.floor(h+h/28*2);return{width:k,days:30}}};H.getDateFromMonthNum=function(e){var h=0;if(e>0){h=e%12;if(h==0)h=12;e=Math.ceil(e/12)}else{h=Math.abs(e)%12;h=12-h+1;if(h==13)h=1;e=-1*Math.ceil(Math.abs(e)/12)}return{ye:e,mo:h}};H.getMonthWidth=function(e,h,k){h=t/28;var y;switch(e){case 1:case 3:case 5:case 7:case 8:case 10:case 12:y=3;break;case 4:case 6:case 9:case 11:y=2;break;case 2:y=H.isLeapYear(yr)==true?1:0}return{width:Math.floor(k+h*y),numDays:28+y}};H.getToday=function(){var e=
new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":00"};H.getMonthFromRemDays=function(e,h){var k=0;var y=k=0;k=H.isLeapYear(h)?1:0;if(e<=31){y=1;k=e}else if(e>31&&e<=59+k){y=2;k=e-(31+k)}else if(e>59+k&&e<=90+k){y=3;k=e-(59+k)}else if(e>90+k&&e<=120+k){y=4;k=e-(90+k)}else if(e>120+k&&e<=151+k){y=5;k=e-(120+k)}else if(e>151+k&&e<=181+k){y=6;k=e-(151+k)}else if(e>181+k&&e<=212+k){y=7;k=e-(181+k)}else if(e>212+k&&e<=243+k){y=8;k=e-(212+k)}else if(e>
243+k&&e<=273+k){y=9;k=e-(243+k)}else if(e>273+k&&e<=304+k){y=10;k=e-(273+k)}else if(e>304+k&&e<=334+k){y=11;k=e-(304+k)}else{y=12;k=e-(334+k)}return{mo:y,da:k}};H.getDateFromRD=function(e){if(R[e])return R[e];for(var h=Math.floor(e),k=Math.floor(h/146097)*400,y=h-Math.floor(h/146097)*146097,C=1,J=k+1,U=J+400;J<=U;J++)if(y>365){y-=365;if(H.isLeapYear(J))y-=1;C++}else J=U;k+=C;if(y==0)y=1;y=H.getMonthFromRemDays(y,k);C=(e-h)*1440;h=Math.floor(C%60);C=Math.floor(C/60);if(H.isLeapYear(k)&&y.mo==2)y.da+=
1;h=k+"-"+y.mo+"-"+y.da+" "+C+":"+h+":00";return R[e]=h};H.getDateFromSec=function(e){if(I[e])return I[e];var h=H.getDateFromRD(e/86400);return I[e]=h};H.isLeapYear=function(e){return e%400==0?true:e%100==0?false:e%4==0?true:false};H.getRataDie=function(e){function h(n,l){if(m[n+"-"+l])return m[n+"-"+l];for(var D=0,v=n;v<l;v++)D+=H.isLeapYear(v)?366:365;return m[n+"-"+l]=D}function k(n,l){var D;switch(n){case 1:D=0;break;case 2:D=31;break;case 3:D=59;break;case 4:D=90;break;case 5:D=120;break;case 6:D=
151;break;case 7:D=181;break;case 8:D=212;break;case 9:D=243;break;case 10:D=273;break;case 11:D=304;break;case 12:D=334}if(n>2)if(H.isLeapYear(l))D+=1;return D}var y=e.ye,C=e.mo;e=e.da;var J=0;if(T[y+"-"+C+"-"+e])return T[y+"-"+C+"-"+e];if(y>=0){if(y==0)y=1;J=Math.floor(y/400)*146097;var U=parseInt(h(y-y%400,y)),aa=parseInt(k(C,y));J=J+U+aa+e-366}else if(y<0)J=H.getBCRataDie({ye:y,mo:C,da:e});return T[y+"-"+C+"-"+e]=J};H.monthNamesLet=["","J","F","M","A","M","J","J","A","S","O","N","D"];H.monthsDayNums=
[0,31,28,31,30,31,30,31,31,30,31,30,31,29];H.units=["da","mo","ye","de","ce","thou","tenthou","hundredthou","mill","tenmill","hundredmill","bill"];H.getBCRataDie=function(e){var h=e.ye,k=e.mo;e=e.da;if(Q[h+"-"+k+"-"+e])return Q[h+"-"+k+"-"+e];if(k==0)k=1;if(e==0)e=1;var y=-1*((Math.abs(h)-1)*366+[0,335,306,275,245,214,184,153,122,92,61,31,0][k]+(H.monthsDayNums[k]-e+1));return Q[h+"-"+k+"-"+e]=y};H.setCulture=function(e){jQuery.global.culture=jQuery.global.cultures[e];H.monthNames=A.merge([""],jQuery.global.culture.calendar.months.names);
H.monthNamesAbbr=A.merge([""],jQuery.global.culture.calendar.months.namesAbbr);H.dayNames=jQuery.global.culture.calendar.days.names;H.dayNamesAbbr=jQuery.global.culture.calendar.days.namesAbbr;H.dayNamesShort=jQuery.global.culture.calendar.days.namesShort;H.patterns=jQuery.global.culture.calendar.patterns};H.prototype={format:function(e,h,k){k=k||{hours:0,minutes:0};if(h==true)switch(this.date_display.substr(0,2)){case "no":return"";case "ye":e="yyyy";break;case "mo":e="MMM yyyy";break;case "da":e=
"MMM d, yyyy";break;case "ho":e="MMM d, yyyy h:mm tt";break;default:e="f"}if(this.ye>-27E4){h=H.toFromUTC(_.clone(this),k,"from");h=new Date(h.ye,h.mo-1,h.da,h.ho,h.mi,h.se,0);return A.global.format(h,e)}else return this.ye}};H.getTimeOffset=function(e){e=e.replace(/[^-\d:]/gi,"");var h=e.split(":"),k=parseInt(h[0],10);h=parseInt(h[1],10);var y=k+(k<0?-1:1)*(h/60);return{decimal:y,hours:k,minutes:h,seconds:y*3600,string:e}};H.tzOffsetStr=function(e,h){if(e){if(e.length==19)e+=h;else if(e.length==
16)e+=":00"+h;return e}};H.parse8601=function(e){var h,k,y,C,J;J=function(aa){return aa?parseInt(aa.replace("-",""),10):0};var U=e.match(O);e=parseInt(U[1]);if(!e)return{error:"invalid date; no year provided"};h=J(U[2])||1;k=J(U[3])||1;y=J(U[4])||1;C=J(U[5])||0;J=J(U[6])||0;tz_pm=U[7]||"+";tz_ho=parseInt(U[8],10)||0;if(tz_pm=="-")tz_ho*=-1;tz_mi=parseInt(U[9],10)||0;if(tz_pm=="-")tz_mi*=-1;return{ye:e,mo:h,da:k,ho:y,mi:C,se:J,tz_ho:tz_ho,tz_mi:tz_mi}};H.getLastDayOfMonth=function(e,h){var k=[0,31,
28,31,30,31,30,31,31,30,31,30,31],y=0;return y=h==2&&H.isLeapYear(e)==true?29:k[h]};H.getDateTimeStrings=function(e){var h=H.parse8601(e);e=h.ye+"-"+M(h.mo)+"-"+M(h.da);var k="pm";if(h.ho>12){h.ho-=12;k="pm"}else{if(h.ho==0)h.ho="12";k="am"}h=Z(h.ho)+":"+M(h.mi)+" "+k;return{date:e,time:h}};H.transValidateDateString=function(e){if(!e)return false;var h=e.match(/^(\-?\d+|today|now) ?(bce?)?-?(\d{1,2})?-?(\d{1,2})?/);zb=H.zeroButt;if(h){e=h[1];var k=h[2]||"",y=h[3]||"07";h=h[4]||"1";debug.log("bc:",
k);if(parseInt(e,10)<0||k.substr(0,1)=="b")e=-1*Math.abs(e);return H.validateDate(e,y,h)?e+"-"+zb(y)+"-"+zb(h):false}else return false};H.transValidateTimeString=function(e){if(!e)return"12:00:00";e=e.toLowerCase().match(/^(\d{1,2}|noon):?(\d{1,2})?:?(\d{1,2})? ?(am|pm)?/i);var h="";h=H.zeroButt;if(e[1])if(e[0]=="noon")h="12:00:00";else{var k=parseInt(e[1],10)||12,y=parseInt(e[2],10)||0,C=parseInt(e[3],10)||0;e=e[4]||"am";if(H.validateTime(k,y,C)==false)return false;if(e=="pm"&&k<12)k+=12;h=h(k)+
":"+h(y)+":"+h(C)}else h=false;return h};H.validateTime=function(e,h,k){if(e<0||e>23||h<0||h>59||k<0||k>59)return false;return true};H.validateDate=function(e,h,k){var y=H.getMonthDays(h,e);if(k>y||k<=0)return false;if(h>12||h<0)return false;if(e==0)return false;return true};H.zeroButt=function(e){e=parseInt(e,10);return e>9?String(e):"0"+e};H.toFromUTC=function(e,h,k){var y=0,C=[0,31,28,31,30,31,30,31,31,30,31,30,31,29];y={};if(k=="from"){y.ho=-1*h.hours;y.mi=-1*h.minutes}else if(k=="to"){y.ho=h.hours;
y.mi=h.minutes}else{y.ho=-1*e.tz_ho;y.mi=-1*e.tz_mi}if(y.ho==0&&y.mi==0)return e;k=e.ho+e.mi/60+(-1*y.ho+y.mi*-1/60);if(k<0){y=24+k;if(e.da>1)e.da-=1;else if(e.mo==1){e.ye-=1;e.mo=12;e.da=31}else{e.mo-=1;e.da=H.getLastDayOfMonth(e.ye,e.mo)}}else if(k>=24){y=k-24;if(H.isLeapYear(e.ye)&&e.mo==2&&e.da==28)e.da=29;else if(e.da==C[e.mo]){if(e.mo==12){e.ye+=1;e.mo=1}else e.mo+=1;e.da=1}else e.da+=1}else y=k;C=function(J){J=Math.abs(J);var U=Math.floor(J);return{ho:U,mi:Math.round((J-U)*60),se:0}}(y);e.ho=
C.ho;e.mi=C.mi;if(h){e.tz_ho=h.tz_ho;e.tz_mi=h.tz_mi}else{e.tz_ho=0;e.tz_mi=0}return{ye:e.ye,mo:e.mo,da:e.da,ho:e.ho,mi:e.mi,se:e.se}};H.timezones=[{offset:"-12:00",name:"Int'l Date Line West"},{offset:"-11:00",name:"Bering & Nome"},{offset:"-10:00",name:"Alaska-Hawaii Standard Time"},{offset:"-10:00",name:"U.S. Hawaiian Standard Time"},{offset:"-10:00",name:"U.S. Central Alaska Time"},{offset:"-09:00",name:"U.S. Yukon Standard Time"},{offset:"-08:00",name:"U.S. Pacific Standard Time"},{offset:"-07:00",
name:"U.S. Mountain Standard Time"},{offset:"-07:00",name:"U.S. Pacific Daylight Time"},{offset:"-06:00",name:"U.S. Central Standard Time"},{offset:"-06:00",name:"U.S. Mountain Daylight Time"},{offset:"-05:00",name:"U.S. Eastern Standard Time"},{offset:"-05:00",name:"U.S. Central Daylight Time"},{offset:"-04:00",name:"U.S. Atlantic Standard Time"},{offset:"-04:00",name:"U.S. Eastern Daylight Time"},{offset:"-03:30",name:"Newfoundland Standard Time"},{offset:"-03:00",name:"Brazil Standard Time"},{offset:"-03:00",
name:"Atlantic Daylight Time"},{offset:"-03:00",name:"Greenland Standard Time"},{offset:"-02:00",name:"Azores Time"},{offset:"-01:00",name:"West Africa Time"},{offset:"00:00",name:"Greenwich Mean Time/UTC"},{offset:"00:00",name:"Western European Time"},{offset:"01:00",name:"Central European Time"},{offset:"01:00",name:"Middle European Time"},{offset:"01:00",name:"British Summer Time"},{offset:"01:00",name:"Middle European Winter Time"},{offset:"01:00",name:"Swedish Winter Time"},{offset:"01:00",name:"French Winter Time"},
{offset:"02:00",name:"Eastean EU"},{offset:"02:00",name:"USSR-zone1"},{offset:"02:00",name:"Middle European Summer Time"},{offset:"02:00",name:"French Summer Time"},{offset:"03:00",name:"Baghdad Time"},{offset:"03:00",name:"USSR-zone2"},{offset:"03:30",name:"Iran"},{offset:"04:00",name:"USSR-zone3"},{offset:"05:00",name:"USSR-zone4"},{offset:"05:30",name:"Indian Standard Time"},{offset:"06:00",name:"USSR-zone5"},{offset:"06:30",name:"North Sumatra Time"},{offset:"07:00",name:"USSR-zone6"},{offset:"07:00",
name:"West Australian Standard Time"},{offset:"07:30",name:"Java"},{offset:"08:00",name:"China & Hong Kong"},{offset:"08:00",name:"USSR-zone7"},{offset:"08:00",name:"West Australian Daylight Time"},{offset:"09:00",name:"Japan"},{offset:"09:00",name:"Korea"},{offset:"09:00",name:"USSR-zone8"},{offset:"09:30",name:"South Australian Standard Time"},{offset:"09:30",name:"Central Australian Standard Time"},{offset:"10:00",name:"Guam Standard Time"},{offset:"10:00",name:"USSR-zone9"},{offset:"10:00",name:"East Australian Standard Time"},
{offset:"10:30",name:"Central Australian Daylight Time"},{offset:"10:30",name:"South Australian Daylight Time"},{offset:"11:00",name:"USSR-zone10"},{offset:"11:00",name:"East Australian Daylight Time"},{offset:"12:00",name:"New Zealand Standard Time"},{offset:"12:00",name:"Int'l Date Line East"},{offset:"13:00",name:"New Zealand Daylight Time"}];H.boil=Z;H.unboil=M})(timeglider);(function(q){var Z=q.levelHeight=10,M=jQuery;q.TG_Org=function(){var A=q.icon_folder;this.blocks=[];this.ids=[];this.vis=[];this.tree=[];var T=this;this.addBlock=function(R,I){R.right=R.left+R.width;R.bottom=R.top+R.height;R.tickScope=I;T.blocks.push(R)};this.getBorg=function(){return this};this.getBlocks=function(){return this.blocks};this.getHTML=function(R,I){if(R=="sweep"){T.tree=[];for(var O=0;O<300;O++)T.tree[O]=[];this.vis=[]}this.blocks.sort(m);var H,e="",h="";b_htm=html="";b={};blength=this.blocks.length;
for(var k=title_adj=0;k<blength;k++){b=this.blocks[k];if(b.tickScope==R)if(M.inArray(b.id,this.vis)==-1){this.vis.push(b.id);title_adj=0;if(b.html&&b.html.substr(0,4)=="<div"){b_htm="<div style='left:"+b.left+"px' id='"+b.id+"'"+b.html.substr(4);html+=b_htm}else{if(b.image){if(b.image.display_class=="layout")title_adj=b.image.height+4;e="<div class='timeglider-event-image-"+b.image.display_class+"'><img src='"+b.image.src+"'></div>"}else e="";Q(b,0);if(b.y_position>0)b.top=-1*b.y_position;b.fontsize<
10?b.opacity=b.fontsize/10:b.opacity=1;if(b.span==true){O="timeglider-event-spanning";H="<div class='timeglider-event-spanner' style='top:"+title_adj+"px;height:"+b.fontsize+"px;width:"+b.spanwidth+"px'></div>"}else H=O="";h=b.icon?"<img class='timeglider-event-icon' src='"+A+b.icon+"' style='height:"+b.fontsize+"px;left:-"+(b.fontsize+2)+"px; top:"+title_adj+"px'>":"";html+=Math.abs(b.top)>I-16?"<div class='timeglider-more-plus' style='left:"+b.left+"px; top:-"+(I-Math.floor(16/3))+"px'>+</div>":
"<div class='timeglider-timeline-event "+O+"' id='"+b.id+"' style='width:"+b.width+"px;height:"+b.height+"px;left:"+b.left+"px;opacity:"+b.opacity+";top:"+b.top+"px;font-size:"+b.fontsize+"px;'>"+h+e+H+"<div class='timeglider-event-title' style='top:"+title_adj+"px'>"+b.title+"</div></div>"}}}return html};var m=function(R,I){var O=I.importance,H=R.importance;return O<H?-1:O>H?1:0},Q=function(R,I){var O=false,H=T.tree,e=H[I],h=I+1,k=false,y=2;bump_ht=Z;if(e!=undefined){for(y=0;y<e.length;y++){a:{O=
e[y];if(!(R.left>O.right||R.right<O.left))if(R.left>=O.left&&R.left<=O.right||R.right>=O.left&&R.right<=O.right||R.right>=O.right&&R.left<=O.left||R.right<=O.right&&R.left>=O.left)if(R.bottom<=O.bottom&&R.bottom>=O.top||R.top<=O.bottom&&R.top>=O.top||R.top==O.bottom&&R.top==O.top){O=true;break a}O=false}if(O==true){R.top-=bump_ht;R.bottom-=bump_ht;Q(R,h);k=true;break}}if(k==false){R.top-=R.fontsize;e.push(R);y=Math.ceil(R.height/Z);e=0;for(e=1;e<=y;e++){h=I+e;H[h].push(R)}}}}}})(timeglider);(function(q){var Z=q.TG_Date,M=jQuery,A=Z.units,T;q.TG_EventCollection=Backbone.Collection.extend({eventHash:{},setTimelineHash:function(m,Q){this.eventHash[m]=Q},getTimelineHash:function(m){return this.eventHash[m]},model:q.TG_Event});q.TG_Event=Backbone.Model.extend({urlRoot:"/event",defaults:{title:"Untitled"},initialize:function(m){if(m.image){m.image={id:m.id,src:m.image,display_class:m.image_class||"above",width:0,height:0};this.getEventImageSize(m.image)}else m.image="";m.titleWidth=q.getStringWidth(m.title);
this.set(m)},validate:function(){},getEventImageSize:function(m){function Q(H,e){return function(){return e.apply(H,arguments)}}var R=this,I=new Image,O=I.src=m.src;I.onerror=Q(I,function(){debug.log("error loading image:"+O)});I.onload=Q(I,function(){R.get("image").height=this.height;R.get("image").width=this.width})}});q.TG_TimelineCollection=Backbone.Collection.extend({model:q.TG_Timeline});q.TG_Timeline=Backbone.Model.extend({urlRoot:"/timeline",defaults:{initial_zoom:25,focus_date:"today",timezone:"00:00",
title:"Untitled",events:[],legend:[]},_chewTimeline:function(m){T=m.mediator;m.timeline_id=m.id;var Q={all:[],da:[],mo:[],ye:[],de:[],ce:[],thou:[],tenthou:[],hundredthou:[],mill:[],tenmill:[],hundredmill:[],bill:[]};m.spans=[];m.hasImagesAbove=false;m.startSeconds=[];m.endSeconds=[];m.timeOffset=Z.getTimeOffset(m.timezone||"00:00");if(!m.color)m.color="#333333";if(m.events.length>0){for(var R,I,O,H,e=m.events.length,h=0;h<e;h++){I=m.events[h];if(I.id)O=I.id;else I.id=O="anon"+this.anonEventId++;
if(I.map)if(T.main_map){if(timeglider.mapping.ready)I.map.marker_instance=timeglider.mapping.addAddMarkerToMap(I,T.main_map)}else q.googleMapsLoad();R=I.date_display||I.date_limit||"da";I.date_display=R.toLowerCase().substr(0,2);if(m.timeOffset.seconds){I.startdate=Z.tzOffsetStr(I.startdate,m.timeOffset.string);if(I.enddate)I.enddate=Z.tzOffsetStr(I.enddate,m.timeOffset.string)}I.startdateObj=new Z(I.startdate,I.date_display);if(I.enddate&&I.enddate!==I.startdate){I.enddateObj=new Z(I.enddate,I.date_display);
I.span=true;m.spans["s_"+I.id]={id:I.id,start:I.startdateObj.sec,end:I.enddateObj.sec}}else{I.enddateObj=I.startdateObj;I.span=false}m.startSeconds.push(I.startdateObj.sec);m.endSeconds.push(I.enddateObj.sec);I.cache={span:I.span,startdateObj:_.clone(I.startdateObj),enddateObj:_.clone(I.enddateObj)};if(I.image_class=="above")m.hasImagesAbove=true;I.icon=!I.icon||I.icon==="none"?"":I.icon;Q.all.push(O);for(var k=A.length,y=0;y<k;y++){R=A[y];H=Z.getTimeUnitSerial(I.startdateObj,R);if(Q[R][H]!==undefined)Q[R][H].push(O);
else Q[R][H]=[O]}if(T.eventCollection.get(O))T.eventCollection.get(O).get("timelines").push(m.timeline_id);else{I.timelines=[m.timeline_id];I=new q.TG_Event(I);T.eventCollection.add(I)}}e=M.merge(m.startSeconds,m.endSeconds);e=_.sortBy(e,function(C){return parseInt(C)});m.bounds={first:_.first(e),last:_.last(e)};m.has_events=true}else m.has_events=false;m.hasLegend=m.legend.length>0?true:false;m.display="expanded";T.eventCollection.setTimelineHash(m.timeline_id,Q);delete m.events;return m},initialize:function(m){this.set(this._chewTimeline(m));
this.bind("change",function(){})}})})(timeglider);(function(q){var Z=q.TG_Date,M="",A="",T={},m=jQuery,Q={},R="",I,O,H;q.TG_PlayerView=function(e,h){var k=this;A=h;T=A.options;M="#"+e._id;R=e._id;this._views={PLACE:M,CONTAINER:M+" .timeglider-container",DATE:M+" .timeglider-date-display",TIMELINE_MENU:M+" .timeglider-timeline-menu",TIMELINE_MENU_UL:M+" .timeglider-timeline-menu ul",TIMELINE_LIST_BT:M+" .timeglider-list-bt",SLIDER_CONTAINER:M+" .timeglider-slider-container",SLIDER:M+" .timeglider-slider",ZOOM_DISPLAY:M+" .timeglider-zoomlevel-display",
TRUCK:M+" .timeglider-truck",CENTERLINE:M+" .timeglider-centerline",TICKS:M+" .timeglider-ticks",HANDLE:M+" .timeglider-handle",FOOTER:M+" .timeglider-footer",FILTER_BT:M+" .timeglider-filter-bt",FILTER_BOX:M+" .timeglider-filter-box",SETTINGS_BT:M+" .timeglider-settings-bt"};I=this._views.CONTAINER;O=this._views.TICKS;H=this._views.DATE;this.initTimelineVOffset=100;this.tick_height=34;this._templates={};this._templates={test:"testola",event_modal_small:"<div class='tg-modal timeglider-ev-modal ui-widget-content' id='${id}_modal'><div class='close-button-remove'></div><div class='dateline'>{{html dateline}}</div><h4 id='title'>${title}</h4><p>{{html image}}{{html description}}</p><ul class='timeglider-ev-modal-links'>{{html links}}</ul></div>",
event_modal_full:m.template(null,"<div class='tg-modal full_modal' id='ev_${id}_modal'><div class='full_modal_scrim'></div><div class='full_modal_panel'><div class='close-button full_modal_close'>x</div><div class='dateline'>{{html dateline}}</div><table><tr><td><h4>${title}</h4><div class='description'><p>{{html description}}</p></div></td><td><div>{{html image}}</div><div id='insert'></div></td></tr></table><div class='footer'><ul>{{html links}}</ul></div></div>"),filter_modal:m.template(null,"<div class='tg-modal timeglider-menu-modal timeglider-filter-box'><div class='close-button'></div><h3>filter</h3><div class='timeglider-menu-modal-content'><div class='timeglider-formline'>show: <input type='text' class='timeglider-filter-include'></div><div class='timeglider-formline'>hide: <input type='text' class='timeglider-filter-exclude'></div><ul><li class='timeglider-filter-clear'>clear</li><li class='timeglider-filter-apply'>apply</li></ul></div><div class='timeglider-menu-modal-point-right'></div>"),
timeline_list_modal:m.template(null,"<div class='timeglider-menu-modal timeglider-timeline-menu'><div class='close-button'></div><h3>timelines</h3><div class='timeglider-menu-modal-content'><ul></ul></div><div class='timeglider-menu-modal-point-right'></div>"),settings_modal:m.template(null,"<div class='timeglider-menu-modal timeglider-settings-modal'><div class='close-button'></div><h3>settings</h3><div class='timeglider-menu-modal-content'><div class='timeglider-settings-timezone'></div></div><div class='timeglider-menu-modal-point-right'></div>"),
legend_modal:m.template(null,"<div class='timeglider-menu-modal timeglider-legend timeglider-display-none'  id='${id}_legend'><div class='timeglider-menu-modal-content'><ul id='${id}'>{{html legend_list}}</ul><div class='timeglider-close-button-small timeglider-legend-close'></div><div class='timeglider-legend-all'>all</div></div></div>")};this.timelineModal=q.TG_TimelineView.extend({tagName:"div",model:q.TG_Timeline,className:"tg-modal timeglider-timeline-modal ui-widget-content",events:{"click .close-button-remove":"remove"},
template:"<div class='close-button-remove'></div><h4 id='title'>${title}</h4><p>{{html description}}</p>",initialize:function(){this.model.bind("change",this.render,this)},render:function(){m(this.el).html(m.tmpl(this.template,this.model.attributes)).attr("id",this.model.get("id")+"_timelineModal");return this},remove:function(){m(this.el).fadeOut()}});m(I).delegate(".tg-timeline-envelope .timeline-info","click",function(){var C=m(this).data("timeline_id");k.openTimelineModal(C)}).delegate(".tg-timeline-envelope .expand-collapse",
"click",function(){var C=m(this).data("timeline_id");k.expandCollapseTimeline(C)}).delegate(".tg-timeline-envelope .tg-timeline-legend-bt","click",function(){var C=m(this).data("timeline_id");k.legendModal(C)}).delegate(".close-button-remove","click",function(){var C=m(this).parent().attr("id");m("#"+C).remove()}).delegate(".full_modal_scrim, .full_modal_close","click",function(){m(".full_modal").remove()}).delegate(".timeglider-more-plus","click",function(){A.zoom(-1)}).delegate(".timeglider-legend-close",
"click",function(){var C=m(I+" .timeglider-legend");C.fadeOut(300,function(){C.remove()})}).delegate(".timeglider-legend-all","click",function(){m(I+" .timeglider-legend li").each(function(){m(this).removeClass("tg-legend-icon-selected")});A.setFilters({origin:"legend",icon:"all"})}).css("height",m(M).height());this.basicFontSize=T.basic_fontsize;T.show_footer==false&&m(this._views.FOOTER).css("display","none");this.dragSpeed=0;this.dimensions=this.getWidgetDimensions();this.ticksHandleOffset=this.rightside=
this.leftside=this.tickNum=0;this.timeoout_id=1;this.sliderActive=false;this.ztop=1E3;this.filterBoxActivated=false;this.buildSlider();this.setupFilter();this.setPanButton(m(".timeglider-pan-right"),-30);this.setPanButton(m(".timeglider-pan-left"),30);m(this._views.TRUCK).bind("dblclick",function(C){A.registerUIEvent({name:"dblclick",event:C,dimensions:k.dimensions})}).bind("mousewheel",function(C,J){var U=Math.ceil(-1*J*3),aa=A.getZoomLevel();A.setZoomLevel(aa+U);return false});m(O).draggable({axis:"x",
drag:function(){A.setTicksOffset(m(this).position().left)},stop:function(){k.resetTicksHandle();k.registerDragging();k.easeOutTicks()}}).delegate(I+" .timeglider-timeline-event","click",function(){var C=m(this).attr("id"),J=A.eventCollection.get(C).attributes;if(timeglider.mode!="authoring")if(J.click_callback){C=J.click_callback.split(".");var U=C.length;if(U==1)window[C[0]](J);else if(U==2)window[C[0]][C[1]](J);else if(U==3)window[C[0]][C[1]][C[2]](J)}else k.eventModal(C)}).delegate(".timeglider-timeline-event",
"mouseover",function(){var C=A.eventCollection.get(m(this).attr("id")).attributes;k.eventHover(m(this),C)}).delegate(".timeglider-timeline-event","mouseout",function(){var C=A.eventCollection.get(m(this).attr("id")).attributes;k.eventUnHover(m(this),C)}).delegate(".timeglider-event-collapsed","hover",function(){var C=A.eventCollection.get(m(this).attr("id")).attributes.title;debug.trace("collapsed, title:"+C,"note")});A.options.show_centerline===true?m(this._views.CENTERLINE).css({height:k.dimensions.container.height,
left:k.dimensions.container.centerx}):m(this._views.CENTERLINE).css({display:"none"});m.subscribe("mediator.ticksOffsetChange",function(){k.tickHangies();k.registerDragging();k.registerTitles()});m.subscribe("mediator.focusToEvent",function(){});m.subscribe("mediator.zoomLevelChange",function(){k.tickNum=0;k.leftside=0;var C=A.getZoomLevel();m(k._views.SLIDER).slider("value",k.invSliderVal(C));k.displayZoomLevel(C);k.castTicks("zoomLevelChange")});m.subscribe("mediator.ticksReadySignal",function(){A.ticksReady===
true&&k.freshTimelines()});m.subscribe("mediator.refreshSignal",function(){k.tickNum=0;k.leftside=0;k.castTicks("refreshSignal")});m.subscribe("mediator.ticksArrayChange",function(){});m.subscribe("mediator.focusDateChange",function(){this.displayFocusDate()});m.subscribe("mediator.timelineDataLoaded",function(){m(".timeglider-loading").fadeOut(500);k.buildSettingsMenu();k.buildTimelineMenu()});m.subscribe("mediator.activeTimelinesChange",function(){m(k._views.TIMELINE_MENU_UL+" li").each(function(){var C=
m(this).data("timeline_id");m.inArray(C,A.activeTimelines)!=-1?m(this).addClass("activeTimeline"):m(this).removeClass("activeTimeline")})});m.subscribe("mediator.filterChange",function(){});if(m.support.touch){m("#"+R).addTouch();var y=document.getElementById(R);y.addEventListener("gesturestart",function(C){C.preventDefault();m("#output").append("<br>gesture zoom:"+A.getZoomLevel())},false);y.addEventListener("gestureend",function(C){C.preventDefault();m("#output").append("<br>gesture end:"+A.getZoomLevel())},
false);y.addEventListener("gesturechange",function(C){C.preventDefault();C.preventDefault();if(A.gesturing===false){A.gesturing=true;A.gestureStartZoom=A.getZoomLevel()}A.setZoomLevel(Math.ceil(A.gestureStartZoom/C.scale))},false)}};q.TG_PlayerView.prototype={getWidgetDimensions:function(){var e=m(I),h=e.width(),k=Math.floor(h/2)+1,y=e.height(),C=Math.floor(y/2),J=this.tick_height,U=e.position().left;e=e.offset();var aa=T.show_footer==true?m(this._views.FOOTER).height():0;return{container:{width:h,
height:y,centerx:k,centery:C,left:U,offset:e},tick:{top:y-aa-J},footer:{height:aa}}},scaleToImportance:function(e,h){return e/h},displayZoomLevel:function(){var e=A.getZoomLevel();e>0&&T.display_zoom_level==true&&m(this._views.ZOOM_DISPLAY).text(e)},displayFocusDate:function(){var e=A.getFocusDate();m(H).text(e.format("d MMM yyyy",false))},setPanButton:function(e,h){var k=this;m(e).live("mousedown",function(){k.intervalMachine("pan",{type:"set",fn:k.pan,args:[h],intvl:33})}).live("mouseup",function(){k.intervalMachine("pan",
{type:"clear",fn:k.pan,callback:"resetTicksHandle"})}).live("mouseout",function(){k.intervalMachine("pan",{type:"clear",fn:k.pan,callback:"resetTicksHandle"})})},intervalMachine:function(e,h){var k=this;if(h.type==="clear"){clearInterval(Q[e]);if(h.callback)k[h.callback]()}else Q[e]=setInterval(function(){h.fn.apply(k,h.args)},h.intvl)},invSliderVal:function(e){return Math.abs(e-101)},pan:function(e){e=e||20;$t=m(O);newPos=$t.position().left+e;$t.css({left:newPos});A.setTicksOffset(newPos)},registerTitles:function(){var e,
h,k,y,C,J,U,aa,n,l=m(I).offset().left;m(".timeglider-event-spanning").each(function(){e=m(this).offset().left-l;h=m(this).outerWidth();J=m(".timeglider-event-title",this);k=J.outerWidth()+5;y=J.siblings(".timeglider-event-spanner").outerWidth();y>k&&e<0&&Math.abs(e)<h-k&&J.css({marginLeft:-1*e+5})});m.browser.msie&&parseInt(m.browser.version);m(".tg-timeline-envelope").each(function(){U=m(this);aa=U.offset().left-l;$tb=U.find(".titleBar");C=$tb.data("lef");n=-1*(C+aa);$ti=$tb.find(".timeline-title");
n>0&&$ti.css({marginLeft:n+5})})},registerDragging:function(){var e=A.startSec,h=m(O).position().left,k=A.getZoomInfo().spp;e=new Z(e-h*k);A.setFocusDate(e);this.displayFocusDate()},setupFilter:function(){var e=this;$filter=m.tmpl(e._templates.filter_modal,{}).appendTo(e._views.CONTAINER);$filter.css("z-index",e.ztop++).position({my:"right bottom",at:"right top",of:m(e._views.FILTER_BT),offset:"-8, -12"}).hide();m(I).delegate(".timeglider-filter-box .close-button","click",function(){$filter.fadeOut()});
m(e._views.FILTER_BT).click(function(){$filter.fadeIn();m(this);var h=e._views.FILTER_BOX;if(e.filterBoxActivated==false){e.filterBoxActivated=true;var k=m(h+" .timeglider-filter-apply"),y=m(".timeglider-filter-box .close-button"),C=m(h+" .timeglider-filter-clear"),J="",U="";k.click(function(){J=m(h+" .timeglider-filter-include").val();U=m(h+" .timeglider-filter-exclude").val();A.setFilters({origin:"clude",include:J,exclude:U});m(h).toggleClass("timeglider-display-block")});y.click(function(){m(h).toggleClass("timeglider-display-none")});
C.click(function(){A.setFilters({origin:"clude",include:"",exclude:""});m(h+" .timeglider-filter-include").val("");m(h+" .timeglider-filter-exclude").val("");m(h).toggleClass("timeglider-display-block")})}})},buildTimelineMenu:function(){var e=this,h;m(e._views.TIMELINE_LIST_BT);m(e._views.TIMELINE_MENU)[0]&&m(e._views.TIMELINE_MENU).remove();h=m.tmpl(e._templates.timeline_list_modal,{}).appendTo(e._views.CONTAINER);var k=Backbone.View.extend({initialize:function(){this.model.bind("change",this.render,
this)},tagName:"li",className:"timeglider-timeline-list-item",template:"${title}",events:{click:"toggleTimeline"},toggleTimeline:function(){A.toggleTimeline(this.model.get("id"))},render:function(){var y=this.model.get("id");m(this.el).html(m.tmpl(this.template,this.model.attributes)).data("timeline_id",y);return this}});m(e._views.TIMELINE_MENU_UL).html("");_.each(A.timelineCollection.models,function(y){m(e._views.TIMELINE_MENU_UL).append((new k({model:y})).render().el)});h.position({my:"right bottom",
at:"right top",of:m(e._views.TIMELINE_LIST_BT),offset:"-8, -12"}).hide();m(I).delegate(".timeglider-timeline-menu .close-button","click",function(){h.fadeOut()}).delegate(this._views.TIMELINE_LIST_BT,"click",function(){h.fadeIn()})},getTimezonePulldown:function(e,h){var k="<select name='timezone' id='"+e+"'>",y=false,C="selected";m.map(Z.timezones,function(J){if(h==J.offset&&y==false){C="selected";y=true}else C="";k+="<option value='"+J.offset+"' "+C+">"+J.name+"</option>"});k+="</select>";return k},
buildSettingsMenu:function(){var e=m.tmpl(this._templates.settings_modal,{}).appendTo(this._views.CONTAINER),h=this.getTimezonePulldown("timeglider-settings-timezone",A.timeOffset.string);e.find(".timeglider-settings-timezone").append('<p>Make changes below, then click on "save". More settings options to come!</p>').append('<span class="settings-label">timezone:</span> '+h).append("<p style='clear:both'>&nbsp;</p><div class='btn success' id='timeglider-settings-save'>save</div>");e.position({my:"right bottom",
at:"right top",of:m(this._views.SETTINGS_BT),offset:"-8, -12"}).hide();m(I).delegate(".timeglider-settings-modal .close-button","click",function(){e.fadeOut()}).delegate(this._views.SETTINGS_BT,"click",function(){e.fadeIn()}).delegate("#timeglider-settings-save","click",function(){var k=m(I+" #timeglider-settings-timezone").val();A.setTimeoffset(k)})},buildSlider:function(){var e=A.getZoomLevel();if(T.min_zoom==T.max_zoom)m(this._views.SLIDER_CONTAINER).css("display","none");else{T.display_zoom_level==
true&&m("<div>").appendTo(this._views.SLIDER_CONTAINER).addClass("timeglider-zoomlevel-display").html("&nbsp;");var h=this;e=h.invSliderVal(e);var k=A.max_zoom,y=A.min_zoom;m(this._views.SLIDER).css("height",(1+k-y)*3).slider({steps:100,handle:m(".knob"),animate:300,orientation:"vertical",min:h.invSliderVal(k),max:h.invSliderVal(y),value:e,start:function(){h.sliderActive=true},stop:function(){h.sliderActive=false},change:function(){},slide:function(C,J){A.setZoomLevel(h.invSliderVal(J.value))}})}},
getEventDateLine:function(e){var h="<span class='timeglider-dateline-startdate'>"+e.startdateObj.format("",true,A.timeOffset)+"</span>";endDateF="";if(e.span==true)endDateF=" &ndash; <span class='timeglider-dateline-enddate'>"+e.enddateObj.format("",true,A.timeOffset)+"</span>";return h+endDateF},eventHover:function(e,h){var k=m(".timeglider-event-hover-info");h.date_display!="no"&&k.position({my:"left bottom",at:"left top",of:e,offset:"1, -10",collision:"flip flip"}).html(this.getEventDateLine(h));
e.addClass("tg-event-hovered")},eventUnHover:function(e){m(".timeglider-event-hover-info").css("left","-1000px");e.removeClass("tg-event-hovered")},clearTicks:function(){this.tickNum=this.leftside=0;m(O).css("left",0);m(I+" .tg-timeline-envelope").remove();m(I+" .timeglider-tick").remove()},castTicks:function(){this.clearTicks();A.getZoomLevel();var e=A.getFocusDate(),h=A.getZoomInfo().width;h=Math.ceil(this.dimensions.container.width/h)+4;var k="l";A.setTicksReady(false);this.addTick({type:"init",
focus_date:e});for(e=1;e<=h;e+=1){this.addTick({type:k});k=k=="l"?"r":"l"}A.setTicksReady(true);this.displayFocusDate()},addTick:function(e){var h=0,k=0,y=k=0,C=0,J=0,U="";C={};J={};y={};var aa={};J={};aa="";var n=0,l=1;U="";tickUnit=A.getZoomInfo().unit;tickWidth=A.getZoomInfo().width;focusDate=A.getFocusDate();tick_top=parseInt(this.dimensions.tick.top);C=A.addToTicksArray({type:e.type,unit:tickUnit},focusDate);if(tickUnit=="mo"){J=Z.getMonthAdj(C,tickWidth);tickWidth=J.width;h=J.days}this.tickNum++;
if(e.type=="init"){J=this.tickOffsetFromDate(A.getZoomInfo(),A.getFocusDate(),tickWidth);this.leftside=k=Math.ceil(this.dimensions.container.centerx+J);this.rightside=k+tickWidth}else if(e.type=="l")this.leftside=k=Math.floor(this.leftside-tickWidth);else if(e.type=="r"){k=Math.floor(this.rightside);this.rightside+=tickWidth}A.getTickBySerial(C).width=tickWidth;A.getTickBySerial(C).left=k;U=this._views.PLACE+"_"+tickUnit+"_"+C+"-"+this.tickNum;J=m("<div class='timeglider-tick' id='"+U+"'><div class='timeglider-tick-label' id='label'></div></div>").appendTo(O);
J.css({width:tickWidth,left:k,top:tick_top});y=this.getTickMarksInfo({unit:tickUnit,width:tickWidth});y=h||y.tperu;k=tickWidth/y;if(k>5){e=Raphael(U,tickWidth,30);var D="";for(h=0;h<y;h++){U=h*k;D+="M"+U+" 20 L"+U+" 30";if(tickUnit=="da"&&k>16){U=this.getHourLabelFromHour(n,k);aa+="<div class='timeglider-tick-sub-label' style='width:"+(k-4)+"px'>"+U+"</div>";n++}if(tickUnit=="mo"&&k>16){aa+="<div class='timeglider-tick-sub-label' style='width:"+(k-4)+"px'>"+l+"</div>";l++}}e.path(D).attr({stroke:"#333",
"stroke-width":1})}aa&&J.append("<div style='width:"+(tickWidth+10)+"px;position:absolute;top:17px;left:0;overflow:hidden'>"+aa+"</div>");aa={unit:tickUnit,width:tickWidth,serial:C};C=this.getDateLabelForTick(aa);J.children("#label").text(C);return aa},getHourLabelFromHour:function(e,h){var k="";k=k="";k=e>12?e-12:e;if(k==0)k=12;return k+(h>60?":00":"")+(e>11?" pm":" am")},getTickMarksInfo:function(e){switch(e.unit){case "da":e=24;break;case "mo":e=30;break;case "ye":e=12;break;default:e=10}return{tperu:e}},
getDateLabelForTick:function(e){var h=e.serial,k=e.width;switch(e.unit){case "bill":return h==0?"1":h>0?h+" billion":h+" b.y. bce";case "hundredmill":return h==0?"1":h>0?h+"00 million":h+"00 m.y. bce";case "tenmill":return h==0?"1":h>0?h+"0 million":h+"0 m.y. bce";case "mill":return h==0?"1":h>0?h+" million":h+" m.y. bce";case "hundredthou":return h==0?"1":h>0?h+"00,000":h+"00,000 bce";case "tenthou":return h==0?"1":h>0?h+"0,000":h+"0,000 bce";case "thou":return h==0?"1("+h+")":h>0?h+"000":h+"000 bce";
case "ce":return h==0?"1("+h+")":h>0?h+"00":h+"00 bce";case "de":return h>120?h*10+"s":h*10;case "ye":return h;case "mo":e=Z.getDateFromMonthNum(h);return k<120?Z.monthNamesAbbr[e.mo]+" "+e.ye:Z.monthNames[e.mo]+", "+e.ye;case "da":e=new Z(Z.getDateFromRD(h));return k<120?Z.monthNamesAbbr[e.mo]+" "+e.da+", "+e.ye:Z.monthNames[e.mo]+" "+e.da+", "+e.ye;default:return e.unit+":"+h+":"+k}},tickHangies:function(){var e=m(O).position().left,h=this.rightside+e-this.dimensions.container.width;if(this.leftside+
e>-100){e=this.addTick({type:"l"});this.appendTimelines(e)}else if(h<100){e=this.addTick({type:"r"});this.appendTimelines(e)}},tickOffsetFromDate:function(e,h,k){switch(e.unit){case "da":h=h.ho/24+h.mi/1440;k*=h;break;case "mo":e=Z.getMonthDays(h.mo,h.ye);h=(h.da-1)/e+h.ho/(24*e)+h.mi/(1440*e);k*=h;break;case "ye":h=((h.mo-1)*30+h.da)/365;k*=h;break;case "de":h=h.ye%10/10+h.mo/120;k*=h;break;case "ce":h=h.ye%100/100+h.mo/1200;k*=h;break;case "thou":h=h.ye%1E3/1E3;k*=h;break;case "tenthou":h=h.ye%
1E4/1E4;k*=h;break;case "hundredthou":h=h.ye%1E5/1E5;k*=h;break;default:k=0}return-1*k},resetTicksHandle:function(){m(this._views.HANDLE).offset({left:m(I).offset().left})},easeOutTicks:function(){Math.abs(this.dragSpeed)>5&&m("#TimegliderTicks").animate({left:"+="+5*this.dragSpeed},400,function(){debug.trace("ticks stopped!","note")})},getTimelineEventsByTick:function(e){var h=e.tick.unit,k=e.tick.serial;e=A.eventCollection.getTimelineHash(e.timeline.timeline_id);return e[h][k]&&e[h][k].length>0?
e[h][k]:0},passesFilters:function(e,h){var k=true,y="",C=[],J;y="";C=[];if(h<e.low_threshold||h>e.high_threshold)return false;if(y=A.filters.include){C=y.split(",");k=false;for(J=0;J<C.length;J++){y=RegExp(m.trim(C[J]),"i");if(e.title.match(y))k=true}}if(y=A.filters.exclude){C=y.split(",");for(J=0;J<C.length;J++){y=RegExp(m.trim(C[J]),"i");if(e.title.match(y))k=false}}y=e.icon;if(A.filters.legend.length>0)if(m.inArray(y,A.filters.legend)==-1)k=false;return k},freshTimelines:function(){var e,h,k,y=
A.activeTimelines,C=A.ticksArray,J="",U;h="";var aa=this.dimensions.container.centerx;e=this.dimensions.container.width;var n=A.getFocusDate().sec,l=A.getZoomInfo().spp;A.getZoomInfo();h=[];var D=[],v=n-Math.floor(l*(e/2));k=U=0;for(var p,x=0,B=this.dimensions.container.height,E=x=0;E<y.length;E++){D=[];h=A.timelineCollection.get(y[E]);e=h.attributes;p=e.display;x=e.top?parseInt(e.top.replace("px","")):B-this.initTimelineVOffset;h=new q.TG_TimelineView({model:h});U=A.timeOffset.seconds/l;$tl=m(h.render().el).appendTo(O);
$tl.draggable({axis:"y",handle:".titleBar",stop:function(){var N=m(this).css("top"),i=m(this).attr("id");A.timelineCollection.get(i).set({top:N});A.refresh()}}).css({top:x,left:U});U=$tl.find(".titleBar");h=aa+(e.bounds.first-n)/l;k=aa+(e.bounds.last-n)/l;k-=h;U.css({top:void 0,left:h,width:k}).data({lef:h,wid:k});if(p=="expanded")e.borg=J=new timeglider.TG_Org;for(U=0;U<C.length;U++){h=this.getTimelineEventsByTick({tick:C[U],timeline:e});m.merge(D,h)}_.each(e.spans,function(N){N.start<v&&N.end>v&&
m.inArray(N.id,D)==-1&&D.unshift(N.id)});h=this.compileTickEventsAsHtml(e,D,0,"sweep");x=e.hasImagesAbove?x-56:x;if(p=="expanded"){h=J.getHTML("sweep",x);e.borg=J.getBorg()}h!="undefined"&&$tl.append(h);this.registerEventImages($tl)}this.registerTitles()},appendTimelines:function(e){for(var h=A.activeTimelines,k,y="",C=0;C<h.length;C++){k=A.timelineCollection.get(h[C]).attributes;idArr=this.getTimelineEventsByTick({tick:e,timeline:k});y=this.compileTickEventsAsHtml(k,idArr,e.serial,"append");if(k.display==
"expanded")y=k.borg.getHTML(e.serial,k.top);k=m(I+" .tg-timeline-envelope#"+k.id).append(y);this.registerEventImages(k)}},compileTickEventsAsHtml:function(e,h,k,y){var C;C=0;var J=this.dimensions.container.centerx,U=e.display,aa=$tl.height();stuff="";foSec=A.startSec;spp=A.getZoomInfo().spp;zl=A.getZoomInfo().level;buffer=20;borg=e.borg;block_arg="sweep";if(y=="append")block_arg=k;for(k=0;k<h.length;k++){ev=A.eventCollection.get(h[k]).attributes;if(this.passesFilters(ev,zl)===true){C=J+(ev.startdateObj.sec-
foSec)/spp;if(U=="expanded"){impq=e.size_importance!==false?this.scaleToImportance(ev.importance,zl):1;ev.width=ev.titleWidth*impq+buffer;ev.fontsize=this.basicFontSize*impq;ev.left=C;ev.spanwidth=0;if(ev.span==true){ev.spanwidth=(ev.enddateObj.sec-ev.startdateObj.sec)/spp;if(ev.spanwidth>ev.width)ev.width=ev.spanwidth}C=0;if(ev.image&&ev.image.display_class==="layout"){C=ev.image.height+2;ev.width=ev.image.width>ev.width?ev.image.width:ev.width}ev.height=Math.ceil(ev.fontsize)+C;ev.top=aa-ev.height;
borg.addBlock(ev,block_arg)}else if(U=="collapsed")stuff+="<div id='"+ev.id+"' class='timeglider-event-collapsed' style='top:"+(aa-2)+"px;left:"+C+"px'></div>"}}return U=="collapsed"?stuff:""},registerEventImages:function(e){m(I+" .timeglider-event-image-bar").each(function(){m(this).position({my:"top",at:"bottom",of:e,offset:"0, 0"}).css("left",0)});m(I+" .timeglider-event-image-above").each(function(){m(this).position({my:"top",at:"top",of:m(I),offset:"0, 12"}).css("left",0)})},expandCollapseTimeline:function(e){e=
A.timelineCollection.get(e).attributes;e.display=e.display=="expanded"?"collapsed":"expanded";A.refresh()},openTimelineModal:function(e){e=new this.timelineModal({model:A.timelineCollection.get(e)});m(e.render().el).appendTo("body").position({my:"left top",at:"left top",of:this._views.CONTAINER,offset:"32, 32",collision:"fit fit"}).css("z-index",this.ztop++).draggable({stack:".timeglider-modal"})},createEventLinksMenu:function(e){if(!e)return"";var h="",k=0,y="",C="";if(typeof e=="string")h="<li><a href='"+
e+"' target='_blank'>link</a></li>";else if(typeof e=="object")for(k=0;k<e.length;k++){y=e[k].url;C=e[k].label;h+="<li><a href='"+y+"' target='_blank'>"+C+"</a></li>"}return h},eventModal:function(e){m(I+" #"+e+"_modal").remove();var h=this,k=false,y=false,C="";C={};C=0;var J=T.event_modal.type;C=m("#"+e);var U=A.eventCollection.get(e).attributes,aa=U.image&&U.image.src?"<img src='"+U.image.src+"'>":"",n=this.createEventLinksMenu(U.link);e={title:U.title,description:U.description,id:e,dateline:h.getEventDateLine(U),
links:n,image:aa,video:U.video};if(U.video){e.video=U.video;J="full";y=true}else if(U.map)if(U.map.latlong){k=true;J="full"}switch(J){case "full":e=m.tmpl(h._templates.event_modal_full,e);e.appendTo(I).css({"z-index":h.ztop++}).position({my:"left top",at:"left top",of:I,offset:"0, 0",collision:"none none"});if(k==true){e.find("#insert").append("<div id='map_modal_map'></div>");C=U.map.zoom||12;llarr=String(U.map.latlong).split(",");map_ll=new google.maps.LatLng(parseFloat(llarr[0]),parseFloat(llarr[1]));
C={zoom:C,center:map_ll,mapTypeId:google.maps.MapTypeId.ROADMAP};C=new google.maps.Map(m("#map_modal_map")[0],C);if(U.map.markers)for(k=0;k<U.map.markers.length;k++){y=U.map.markers[k];new google.maps.MarkerImage(y.image,new google.maps.Size(24,32),new google.maps.Point(0,0),new google.maps.Point(0,32));e=y.latlong.split(",");e=new google.maps.LatLng(e[0],e[1]);y=new google.maps.Marker({position:e,map:C,icon:y.icon,title:y.title,zIndex:y.zIndex})}}else y==true&&e.find("#insert").append("<iframe width='100%' height='300' src='"+
U.video+"'></iframe></div>");U=h.dimensions.container.height;k=h.dimensions.container.width;y=m(I+" .full_modal_panel");e=y.width();C=y.height();y.css({top:(U-C)/2+"px",left:(k-e)/2+"px"});break;case "video":e=m.tmpl(h._templates.event_modal_video,e);e.appendTo(O).css("z-index",h.ztop++).position({my:"right center",at:"left center",of:C,offset:"-12, -1",collision:"flip fit"}).hover(function(){m(this).css("z-index",h.ztop++)});break;default:e=m.tmpl(h._templates.event_modal_small,e);e.appendTo(O).css("z-index",
h.ztop++).position({my:"right center",at:"left center",of:C,offset:"-12, -1",collision:"flip fit"}).draggable().hover(function(){m(this).css("z-index",h.ztop++)})}},legendModal:function(e){var h=A.timelineCollection.get(e).attributes.legend,k,y,C,J="";for(k=0;k<h.length;k++){y=T.icon_folder+h[k].icon;C=h[k].title;J+="<li><img src='"+y+"'>"+C+"</li>"}e={id:e,legend_list:J};m(I+" .timeglider-legend").remove();m.tmpl(this._templates.legend_modal,e).appendTo(I).css("z-index",this.ztop++).toggleClass("timeglider-display-none").position({my:"left top",
at:"left top",of:I,offset:"16, -4",collision:"none none"});m(I+" .timeglider-legend li").click(function(){m(this).parent().attr("id");var U=m(this).children("img").attr("src");m(this).toggleClass("tg-legend-icon-selected");A.setFilters({origin:"legend",icon:U})})},parseHTMLTable:function(e){var h={},k=+new Date,y=[];m("#"+e).find("tr").each(function(C){var J=m(this).children(),U;if(C===0)y=J.map(function(){return m(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get();else{U={};J.each(function(aa){U[y[aa]]=
m(this).text()});h["prefix"+k++]=U}});return h}};q.TG_TimelineView=Backbone.View.extend({initialize:function(){var e=this;this.model.bind("change:title",function(){m(e.el).find(".timeline-title-span").text(e.model.get("title"))});this.model.bind("destroy",this.remove,this)},tagName:"div",events:{"click .timeline-title-span":"titleClick"},className:"tg-timeline-envelope",getTemplate:function(){var e="<div class='titleBar'><div class='timeline-title'><span class='timeline-title-span'>${title}</span><div class='tg-timeline-env-buttons'>";
if(this.model.get("description"))e+="<span class='timeline-info' data-timeline_id='${id}'>info</span>";if(this.model.get("hasLegend"))e+="<span class='tg-timeline-legend-bt' data-timeline_id='${id}'>legend</span>";e+="<span class='expand-collapse' data-timeline_id='${id}'>exp/col</span>";e+="</div></div></div>";return e},render:function(){this.model.get("id");this.model.get("title");var e=this.getTemplate();m(this.el).html(m.tmpl(e,this.model.attributes)).attr("id",this.model.get("id"));return this},
setText:function(){},titleClick:function(){A.timelineTitleClick(this.model.get("id"))},remove:function(){m(this.el).remove()}});q.zoomTree=[{},{unit:"da",width:35E3,level:1,label:"5 hours"},{unit:"da",width:17600,level:2,label:"7 hours"},{unit:"da",width:8800,level:3,label:"10 hours"},{unit:"da",width:4400,level:4,label:"12 hours"},{unit:"da",width:2200,level:5,label:"14 hours"},{unit:"da",width:1100,level:6,label:"17 hours"},{unit:"da",width:550,level:7,label:"22 hours"},{unit:"da",width:432,level:8,
label:"1 DAY"},{unit:"da",width:343,level:9,label:"1.5 days"},{unit:"da",width:272,level:10,label:"2 days"},{unit:"da",width:216,level:11,label:"2.5 days"},{unit:"da",width:171,level:12,label:"3 days"},{unit:"da",width:136,level:13,label:"3.5 days"},{unit:"da",width:108,level:14,label:"4 days"},{unit:"mo",width:2509,level:15,label:"6 days"},{unit:"mo",width:1945,level:16,label:"1 WEEK"},{unit:"mo",width:1508,level:17,label:"10 days"},{unit:"mo",width:1169,level:18,label:"2 weeks"},{unit:"mo",width:913,
level:19,label:"2.5 weeks"},{unit:"mo",width:719,level:20,label:"3 weeks"},{unit:"mo",width:566,level:21,label:"3.5 weeks"},{unit:"mo",width:453,level:22,label:"1 MONTH"},{unit:"mo",width:362,level:23,label:"5.5 weeks"},{unit:"mo",width:290,level:24,label:"7 weeks"},{unit:"mo",width:232,level:25,label:"2 months"},{unit:"mo",width:186,level:26,label:"2.5 months"},{unit:"mo",width:148,level:27,label:"3 months"},{unit:"mo",width:119,level:28,label:"4 months"},{unit:"mo",width:95,level:29,label:"5 months"},
{unit:"mo",width:76,level:30,label:"6 months"},{unit:"ye",width:723,level:31,label:"9 months"},{unit:"ye",width:573,level:32,label:"1 YEAR"},{unit:"ye",width:455,level:33,label:"1.25 years"},{unit:"ye",width:361,level:34,label:"1.5 years"},{unit:"ye",width:286,level:35,label:"2 years"},{unit:"ye",width:227,level:36,label:"2.5 years"},{unit:"ye",width:179,level:37,label:"3 years"},{unit:"ye",width:142,level:38,label:"4 years"},{unit:"ye",width:113,level:39,label:"5 years"},{unit:"ye",width:89,level:40,
label:"6 years"},{unit:"de",width:705,level:41,label:"8 years"},{unit:"de",width:559,level:42,label:"10 years"},{unit:"de",width:443,level:43,label:"13 years"},{unit:"de",width:302,level:44,label:"16 years"},{unit:"de",width:240,level:45,label:"20 years"},{unit:"de",width:190,level:46,label:"25 years"},{unit:"de",width:150,level:47,label:"30 years"},{unit:"de",width:120,level:48,label:"40 years"},{unit:"de",width:95,level:49,label:"50 years"},{unit:"de",width:76,level:50,label:"65 years"},{unit:"ce",
width:600,level:51,label:"80 years"},{unit:"ce",width:480,level:52,label:"100 years"},{unit:"ce",width:381,level:53,label:"130 years"},{unit:"ce",width:302,level:54,label:"160 years"},{unit:"ce",width:240,level:55,label:"200 years"},{unit:"ce",width:190,level:56,label:"250 years"},{unit:"ce",width:150,level:57,label:"300 years"},{unit:"ce",width:120,level:58,label:"400 years"},{unit:"ce",width:95,level:59,label:"500 years"},{unit:"ce",width:76,level:60,label:"600 years"},{unit:"thou",width:603,level:61,
label:"1000 years"},{unit:"thou",width:478,level:62,label:"1200 years"},{unit:"thou",width:379,level:63,label:"1800 years"},{unit:"thou",width:301,level:64,label:"160 years"},{unit:"thou",width:239,level:65,label:"xxx years"},{unit:"thou",width:190,level:66,label:"xxx years"},{unit:"thou",width:150,level:67,label:"xxx years"},{unit:"thou",width:120,level:68,label:"xxx years"},{unit:"thou",width:95,level:69,label:"8,000 years"},{unit:"thou",width:76,level:70,label:"10,000 years"},{unit:"tenthou",width:603,
level:71,label:"15,000 years"},{unit:"tenthou",width:358,level:72,label:"20,000 years"},{unit:"tenthou",width:213,level:73,label:"30,000 years"},{unit:"tenthou",width:126,level:74,label:"60,000 years"},{unit:"tenthou",width:76,level:75,label:"100,000 years"},{unit:"hundredthou",width:603,level:76,label:"180,000 years"},{unit:"hundredthou",width:358,level:77,label:"300,000 years"},{unit:"hundredthou",width:213,level:78,label:"500,000 years"},{unit:"hundredthou",width:126,level:79,label:"800,000 years"},
{unit:"hundredthou",width:76,level:80,label:"1 million years"},{unit:"mill",width:603,level:81,label:"1.2 million years"},{unit:"mill",width:358,level:82,label:"2 million years"},{unit:"mill",width:213,level:83,label:"3 million years"},{unit:"mill",width:126,level:84,label:"5 million years"},{unit:"mill",width:76,level:85,label:"10 million years"},{unit:"tenmill",width:603,level:86,label:"15 million years"},{unit:"tenmill",width:358,level:87,label:"30 million years"},{unit:"tenmill",width:213,level:88,
label:"50 million years"},{unit:"tenmill",width:126,level:89,label:"80 million years"},{unit:"tenmill",width:76,level:90,label:"100 million years"},{unit:"hundredmill",width:603,level:91,label:"120 million years"},{unit:"hundredmill",width:358,level:92,label:"200 million years"},{unit:"hundredmill",width:213,level:93,label:"300 million years"},{unit:"hundredmill",width:126,level:94,label:"500 million years"},{unit:"hundredmill",width:76,level:95,label:"1 billion years"},{unit:"bill",width:603,level:96,
label:"15 million years"},{unit:"bill",width:358,level:97,label:"30 million years"},{unit:"bill",width:213,level:98,label:"50 million years"},{unit:"bill",width:126,level:99,label:"80 million years"},{unit:"bill",width:76,level:100,label:"100 billion years"}];q.calculateSecPerPx=function(e){for(var h=1;h<e.length;h++){var k=e[h],y=0;switch(k.unit){case "da":y=86400;break;case "mo":y=2419200;break;case "ye":y=31536E3;break;case "de":y=31536E4;break;case "ce":y=31536E5;break;case "thou":y=31536E6;break;
case "tenthou":y=31536E7;break;case "hundredthou":y=31536E8;break;case "mill":y=31536E9;break;case "tenmill":y=31536E10;break;case "hundredmill":y=31536E11;break;case "bill":y=31536E12}k.spp=y/parseInt(k.width)}}(q.zoomTree);q.getStringWidth=function(e){if(e)return m("#timeglider-measure-span").html(e).width()};String.prototype.removeWhitespace=function(){return this.replace(RegExp("\\n","g"),"")};if(debug)debug.trace=function(e,h){m("#"+h).text(e)};q.googleMapsInit=function(){};q.googleMapsLoaded=
false;q.googleMapsLoad=function(){if(q.googleMapsLoaded==false){var e=document.createElement("script");e.type="text/javascript";e.src="http://maps.googleapis.com/maps/api/js?sensor=false&callback=timeglider.googleMapsInit";document.body.appendChild(e);q.googleMapsLoaded=true}}})(timeglider);(function(q){var Z={},M=q.TG_Date,A={},T=jQuery;q.TG_Mediator=function(m){this.options=A=m;this._focusDate={};this._zoomInfo={};this._zoomLevel=1;this.ticksReady=false;this.ticksArray=[];this.startSec=0;this.activeTimelines=[];this.max_zoom=A.max_zoom;this.min_zoom=A.min_zoom;this.icon_folder=q.icon_folder=A.icon_folder||"js/timeglider/icons/";this.timeOffset=M.getTimeOffset(A.timezone);this.fixed_zoom=this.max_zoom==this.min_zoom?true:false;this.gesturing=false;this.gestureStartScale=this.gestureStartZoom=
0;this.filters={include:"",exclude:"",legend:[]};this.timelineCollection=new q.TG_TimelineCollection;this.eventCollection=new q.TG_EventCollection;this.imagesToSize=this.imagesSized=0;this.timelineDataLoaded=false;this.initial_timeline_id=A.initial_timeline_id||"";this.focusedEvent=this.sole_timeline_id="";if(A.max_zoom===A.min_zoom)this.fixed_zoom=A.min_zoom;if(A.main_map){this.main_map=A.main_map;timeglider.mapping.setMap(this.main_map,this)}Z=this};q.TG_Mediator.prototype={focusToEvent:function(m){this.focusedEvent=
m;this.setFocusDate(m.startdateObj);T.publish("mediator.focusToEvent")},gotoDateZoom:function(m,Q){var R=false;this.setFocusDate(new M(m));if(Q)R=this.setZoomLevel(Q);if(!Q||R==false)this.refresh()},zoom:function(m){this.setZoomLevel(this.getZoomLevel()+parseInt(m))},loadTimelineData:function(m){var Q=this;if(m)if(typeof m==="object")Q.parseData(m);else if(m.substr(0,1)=="#"){m=[Q.getTableTimelineData(m)];Q.parseData(m)}else T.getJSON(m,function(R){Q.parseData(R)});else{this.timelineDataLoaded=true;
this.setZoomLevel(Math.floor((this.max_zoom+this.min_zoom)/2));this.tryLoading()}},mapMarkerClick:function(m){this.focusToEvent(m)},getTimelineCollection:function(){return this.timelineCollection},timelineTitleClick:function(m){T.publish("mediator.timelineTitleClick",{timeline_id:m})},getTableTimelineData:function(m){var Q={},R=0,I=[],O,H,e="",h=T(m);Q.id=m.substr(1);Q.title=h.attr("title")||"untitled";Q.description=h.attr("description")||"";Q.focus_date=h.attr("focus_date")||M.getToday;Q.initial_zoom=
h.attr("initial_zoom")||20;Q.events=[];h.find("tr").each(function(k){var y=T(this).children(),C;if(k===0)I=y.map(function(){return T(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get();else{C={};y.each(function(J){O=I[J];H=T(this).text();C[O]=H});e="ev_"+R++;C.id=e;Q.events.push(C)}});h.css("display","none");return Q},parseData:function(m){var Q=0,R=m.length,I={};I={};for(var O=0;O<R;O++){I=m[O];I.mediator=this;I=(new q.TG_Timeline(I)).toJSON();if(I.id.length>0){Q++;this.swallowTimeline(I)}}if(Q===
0)alert("ERROR loading data: Check JSON with jsonLint");else{this.timelineDataLoaded=true;this.tryLoading()}},tryLoading:function(){var m=this.timelineDataLoaded==true;if(this.imagesSized==this.imagesToSize&&m){this.setInitialTimelines();T.publish("mediator.timelineDataLoaded")}},swallowTimeline:function(m){this.sole_timeline_id=m.id;this.timelineCollection.add(m);T.publish("mediator.timelineListChangeSignal")},setInitialTimelines:function(){var m=this.initial_timeline_id||this.sole_timeline_id;if(timeglider.mode==
"authoring")this.setZoomLevel(40);else m?setTimeout(function(){Z.toggleTimeline(m)},500):this.setZoomLevel(40)},refresh:function(){this.startSec=this._focusDate.sec;T.publish("mediator.refreshSignal")},setTicksReady:function(m){this.ticksReady=m;m===true&&T.publish("mediator.ticksReadySignal")},setTimeoffset:function(m){this.timeOffset=M.getTimeOffset(m);this.refresh()},getTimeoffset:function(){return this.timeOffset},setFocusDate:function(m){if(m!=this._focusDate)this._focusDate=m},getFocusDate:function(){return this._focusDate},
getZoomLevel:function(){return parseInt(this._zoomLevel)},setZoomLevel:function(m){if(m<=this.max_zoom&&m>=this.min_zoom){this.startSec=this._focusDate.sec;if(m!=this._zoomLevel){this._zoomLevel=m;this._zoomInfo=q.zoomTree[m];T.publish("mediator.zoomLevelChange");return true}else return false}else return false},getZoomInfo:function(){return this._zoomInfo},registerUIEvent:function(m){switch(m.name){case "dblclick":m=m.event.pageX-m.dimensions.container.offset.left-m.dimensions.container.width/2;var Q=
this.getZoomInfo().spp,R=this.getFocusDate().sec;m=new M(Math.floor(R+m*Q));T.publish("mediator.dblclick",{date:m})}},setFilters:function(m){switch(m.origin){case "clude":this.filters.include=m.include;this.filters.exclude=m.exclude;break;case "legend":var Q=m.icon;if(Q=="all"){this.filters.legend=[];T.publish("mediator.legendAll")}else if(T.inArray(Q,this.filters.legend)==-1)this.filters.legend.push(Q);else{m=[];m=T.grep(this.filters.legend,function(R){return R!=Q});this.filters.legend=m}}T.publish("mediator.filtersChange");
this.refresh()},getTicksOffset:function(){return this._ticksOffset},setTicksOffset:function(m){this._ticksOffset=m;T.publish("mediator.ticksOffsetChange")},getTickBySerial:function(m){for(var Q=this.ticksArray,R=Q.length,I=0;I<R;I++){var O=Q[I];if(O.serial==m)return O}return false},addToTicksArray:function(m,Q){if(m.type=="init"){m.serial=M.getTimeUnitSerial(Q,m.unit);this.ticksArray=[m]}else if(m.type=="l"){m.serial=this.ticksArray[0].serial-1;this.ticksArray.unshift(m)}else{m.serial=this.ticksArray[this.ticksArray.length-
1].serial+1;this.ticksArray.push(m)}T.publish("mediator.ticksArrayChange");return m.serial},toggleTimeline:function(m){var Q=this.timelineCollection.get(m).attributes,R=T.inArray(m,this.activeTimelines);if(R==-1){this.activeTimelines.push(m);this.setFocusDate(new M(Q.focus_date));this.setZoomLevel(Q.initial_zoom)}else this.activeTimelines.splice(R,1);this.refresh();T.publish("mediator.activeTimelinesChange")},reportImageSize:function(m){var Q=Z.eventCollection.get(m.id);if(Q.has("image")){if(m.error){Q.attributes.image=
{};debug.log("WHOOPS: MISSING IMAGE: "+m.src)}else{Q.attributes.image.width=m.width;Q.attributes.image.height=m.height}this.imagesSized++;this.imagesSized==this.imagesToSize&&this.tryLoading()}}};q.getLowHigh=function(m){m=_.sortBy(m,function(Q){return parseInt(Q)});return{low:_.first(m),high:_.last(m)}};q.validateOptions=function(m){this.optionsMaster={initial_focus:{type:"date"},timezone:{type:"timezone"},editor:{type:"string"},backgroundColor:{type:"color"},backgroundImage:{type:"color"},min_zoom:{type:"number",
min:1,max:100},max_zoom:{type:"number",min:1,max:100},initial_zoom:{type:"number",min:1,max:100},show_centerline:{type:"boolean"},display_zoom_level:{type:"boolean"},data_source:{type:"url"},basic_fontsize:{type:"number",min:9,max:100},mouse_wheel:{type:"string",possible:["zoom","pan"]},initial_timeline_id:{type:"string"},icon_folder:{type:"string"},show_footer:{type:"boolean"},display_zoom_level:{type:"boolean"},event_modal:{type:"object"}};var Q=this,R="";T.each(m,function(I,O){if(Q.optionsMaster[I])switch(Q.optionsMaster[I].type){case "string":if(typeof O!=
"string")R+=I+" needs to be a string.\n";if(Q.optionsMaster[I].possible)if(T.inArray(O,Q.optionsMaster[I].possible)==-1)R+=I+" must be: "+Q.optionsMaster[I].possible.join(" or ");break;case "number":if(typeof O!="number")R+=O+" needs to be a number.\n";if(Q.optionsMaster[I].min)if(O<Q.optionsMaster[I].min)R+=I+" must be greater than or equal to "+Q.optionsMaster[I].min+"\n";if(Q.optionsMaster[I].max)if(O>Q.optionsMaster[I].max)R+=I+" must be less than or equal to "+Q.optionsMaster[I].max+"\n";break;
case "timezone":var H=/[+|-]?[0-9]+:[0-9]+/;if(T.inArray(O,["New York","Denver","Chicago","Los Angeles"])==-1&&O.match(H)==-1)R+="The timezone is not formatted properly";break;case "boolean":if(typeof O!="boolean")R+=O+" needs to be a number.\n"}});return R}})(timeglider);(function(q){var Z,M,A=timeglider,T=timeglider.TG_Date;q.widget("timeglider.timeline",{options:{timezone:"00:00",initial_focus:A.TG_Date.getToday(),editor:"none",min_zoom:1,max_zoom:100,show_centerline:true,data_source:"",culture:"en",basic_fontsize:12,mouse_wheel:"zoom",initial_timeline_id:"",icon_folder:"js/timeglider/icons/",show_footer:true,display_zoom_level:true,event_modal:{href:"",type:"default"}},_create:function(){this._id=q(this.element).attr("id");this.element.html("<div class='timeglider-container'><div class='timeglider-loading'>loading</div><div class='timeglider-centerline'></div><div class='timeglider-date-display'></div><div class='timeglider-truck' id='tg-truck'><div class='timeglider-ticks'><div class='timeglider-handle'></div></div></div><div class='timeglider-slider-container'><div class='timeglider-slider'></div><div class='timeglider-pan-buttons'><div class='timeglider-pan-left'></div><div class='timeglider-pan-right'></div></div></div><div class='timeglider-footer'><div class='timeglider-logo'></div><div class='timeglider-footer-button timeglider-filter-bt'></div><div class='timeglider-footer-button timeglider-settings-bt'></div><div class='timeglider-footer-button timeglider-list-bt'></div></div><div class='timeglider-event-hover-info'></div></div><span id='timeglider-measure-span'></span>")},
_init:function(){var m=timeglider.validateOptions(this.options);if(m==""){A.TG_Date.setCulture(this.options.culture);M=new A.TG_Mediator(this.options);Z=new A.TG_PlayerView(this,M);M.setFocusDate(new T(this.options.initial_focus));M.loadTimelineData(this.options.data_source)}else alert("Rats. There's a problem with your widget settings:"+m)},goTo:function(m,Q){M.gotoDateZoom(m,Q)},getMediator:function(){return M},zoom:function(m){switch(m){case "in":m=-1;break;case "out":m=1}if(m>99||m<-99)return false;
M.zoom(m)},load:function(m){M.loadTimelineData(m)},panButton:function(m,Q){var R=0;switch(Q){case "left":R=30;break;case "right":R=-30;break;default:R=Q}Z.setPanButton(m,R)},destroy:function(){q.Widget.prototype.destroy.apply(this,arguments);q(this.element).html("")}})})(jQuery);

