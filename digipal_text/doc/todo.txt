Version 3 (Jan 17)

pm extxt uploadfrag 'exon/source/rekeyed/word/jan17/edb-*.odt'

[DONE] convert all docs to odt
[DONE] commit repo
[DONE] upload
[DONE] new issues in wordlist
[DONE] new issues in text
[DONE] nested brackets
[DONE] margins
    64b41,84b5,84b6,84b7,84b8,84b9,85b2,85b3,85b4,85b5,85b6,85b7,89b3,107a1,126b3,161a3,170a3,224a4,270a2,309a3,315b1,350a3,409a3,434b4,490a4,500a1,509a9,520a4
. tables
    two table located in 63b16, fol 64 in document 63-82
    .   63b16, 
        63b17, 63b27, 63b36, 
        63b18, 63b28, 63b37, 
        63b19, 63b29, 63b38, 
    [DONE] display as a table if page 
    [DONE] display as <p>s if selected individually

REMAINING PB is interlineation in 63b24/42 (only one not well-formed), 63b38 not displayed properly {} 

</p><p>...</td><td></p><p>...</td><td>

    
63b26
u'<p>\xa7<span data-dpt="location" data-dpt-loctype="entry">63b26</span> Sud <span data-dpt="abbr">Peretonn\u0119</span>
<span data-dpt="exp">Peretonn<i>a</i>e</span> <span data-dpt="abbr">hun\u0111</span><span data-dpt="exp">hund<i>ret</i></span>.</td><td></p>\n'
63b35
u'<p>\xa7<span data-dpt="location" data-dpt-loctype="entry">63b35</span> Briytone <span data-dpt="abbr">hund<sup>4</sup></span>
<span data-dpt="exp">hund<i>ret</i></span></td><td></p>\n'
    
. generate a revised Latin text;
. generate an updated word-list;
. generate a plain text.

. verify plain text (indexing)
    [DONE] e.g. liberaæ (217a2)
        http://localhost:8080/digipal/manuscripts/1/texts/transcription/entry/217a2/?ds=&format=plain
        [DONE] a should not be there
        [OK] æ, how to search for it?
    [DONE] 200b3, join up hyphenated parts, archidi-||diachonus
--

Pb:

Supplied:
    http://localhost:8080/digipal/manuscripts/1/texts/transcription/entry/81b2/?ds=&format=html
    81b2:  〈tenet Serlo de Burceio〉 
    81b2:  〈et .i uirga〉 
    77a1: </et/
        => pb1: not converted into supplied, why???
Ellipis:
    134b4, is it an issue?
    

89a1
    redd[un]t̃{ider̃[unt]}   with un]t̃ strokethrough
        => redd[</text:span><text:span text:style-name="T10">un]t̃</text:span><text:span text:style-name="T1">{ider̃[unt]}
        => redd[<span data-dpt="del" data-dpt-rend="underlined">un]t̃</span>{ider̃[unt]}
        => redd(<span data-dpt="del" data-dpt-rend="underlined">un)<span data-dpt="abbr">t̃</span><span data-dpt="exp">t</span></span><span data-dpt="interlineation"><span data-dpt="abbr">ider̃</span><span data-dpt="exp">ider<i>unt</i></span></span>
        => redd(un)tiderun with un)t strokethrough
        why ()?

entry number within a <margin> element
64b41,84b5,84b6,84b7,84b8,84b9,85b2,85b3,85b4,85b5,85b6,85b7,89b3,107a1,126b3,161a3,170a3,224a4,270a2,309a3,315b1,350a3,409a3,434b4,490a4,500a1,509a9,520a4

------

7b8
G〈isłł[eberti〉

Entries which are not well formed XML

2a3, 2b6, 8b5, 63b42, 63b24, 64b40, 64b41, 84b4, 84b9, 85b1, 85b7, 89b2, 89b3, 106b2, 107a1, 126b2, 126b3, 
161a2, 161a3, 170a2, 170a3, 170b1, 224a3, 224a4, 309a2, 309a3, 315a5, 315b1, 350a2, 350a3, 409a2, 409a3, 
425a3, 434b3, 434b4, 490a3, 490a4, 499b11, 509a8, 509a9, 520a3, 520a4, 

Unique tags:
    u'</i>'
    u'<i>'
    u'</span>'

    u'<span data-dpt="del" data-dpt-rend="underlined">'
    u'<span data-dpt="del" data-dpt-type="supplied">'

    u'<span data-dpt="note" data-dpt-place="margin">'
    u'<span data-dpt="supplied">'

    u'<span data-dpt="g" data-dpt-ref="#tironian">'

    Not to be ascii formatted:
    u'<span data-dpt="interlineation">'
    u'<span data-dpt="exp">'
    u'<span data-dpt="lb" data-dpt-src="ms">'
    u'<span data-dpt="lb" data-dpt-src="prj">'
    u'<span data-dpt="location" data-dpt-loctype="entry">'
    u'<span data-dpt="location" data-dpt-loctype="locus">'
    u'<span data-dpt="del" data-dpt-rend="erasure">'
    u'<span data-dpt="abbr">'
    u'</fn>'
    u'<fn>'
    u'</p>'
    u'<p>'
    u'</sub>'
    u'<sub>'
    u'</sup>'
    u'<sup>'
    

Empty elements (104 occurrences):
    pm dptext search 1 transcription '(?musi).{20}<[^/>]+></.{70}'
    Mostly due to [blank]
    [REPORT] 8a8: Malmesᵬ[er]iens̃[ is]
    202b4: <i>ar</i></span></span>arari ab
    238b3: ined">a</span><span data-dpt="abbr"></span><span data-dpt="exp"><i>abe</i></span><sp
    515a5: u'pt="interlineation"><span data-dpt="abbr"></span><span data-dpt="exp"><i>ni</i></span></span>catu <span data-dpt="'
    519a3: u'>er</i>at</span> ab <span data-dpt="abbr"></span><span data-dpt="exp"><i>a</i></span> <span data-dpt="abbr">\u0119cl 

(ex) jeff@jeff-UX303UA:~/src/workspace/exon/django$ sort tags.txt | uniq
done
[DONE] REMOVE TAG: u'</f>'u'<f>'
[DONE] REMOVE TAG: u'<symbol>': 438a4, 475a5
[DONE] REMOVE TAG: u'<gildum>': 397a4
[DONE] REMOVE TAG: u'<nsc>': 366a4
[DONE] u'</st>': 343 occurences, first in 
    [DONE] u'<st>P</st>', 1b4
    [DONE] u'<st>S</st>', 8a3
    [DONE] u'<st>B</st>', 15b8
    [DONE] u'<st><span data-dpt="abbr">p\u0303</span><span data-dpt="exp">p</span></st>', 270b1
    [DONE] u'<st><span data-dpt="abbr">q\u0303</span><span data-dpt="exp">q</span></st>', 399b1
u'</fn>'
u'<fn>'
u'</i>'
u'<i>'
u'</p>'
u'<p>'
u'</span>'
u'<span data-dpt="abbr">'
u'<span data-dpt="del" data-dpt-rend="erasure">'
u'<span data-dpt="del" data-dpt-rend="underlined">'
u'<span data-dpt="del" data-dpt-type="supplied">'
u'<span data-dpt="exp">'
u'<span data-dpt="g" data-dpt-ref="#tironian">'
u'<span data-dpt="interlineation">'
u'<span data-dpt="lb" data-dpt-src="ms">'
u'<span data-dpt="lb" data-dpt-src="prj">'
u'<span data-dpt="location" data-dpt-loctype="entry">'
u'<span data-dpt="location" data-dpt-loctype="locus">'
u'<span data-dpt="note" data-dpt-place="margin">'
u'<span data-dpt="supplied">'
u'</sub>'
u'<sub>'
u'</sup>'
u'<sup>'
 

pm extxt missing
    106b1, missing reference?
    138a1, blank page, no text, no reference
    243a2, reference mislabelled as '242a2', corrected in working doc
    304b4, translation has a 304b4 (In WONFORD Hundred § Baldwin of Exeter, the sheriff ...) but not visible on MS
    342a5, same, translation has an entry 342a5, In KERSWELL Hundred § Ralph of La Pommeraye has 1 manor which is called BERRY 
    358a4, entry reference 358a3 is directly followed by 358a5. Should 358a5 be relabelled 385a4? 
    365b1, blank page, no text, no reference
    453b4, reference to last entry on 453v is '453b3', the same number as the previous entry. Should be changed to 453b4.
    456a2, entry 456a2 was mislabelled as '445a2' 
    494b4, seems correct as only one entry on that page (Consumatum est), correctly labelled 494b1, not sure why translation has an entry 494b4.
    532b5, mislabelled as 532b6 (532b6 used twice).

csslint --ignore=adjoining-classes,order-alphabetical $(find exon -iname 'tinymce_custom*') | less

pm dptext search 1 transcription "(?i)[a-z]+7\w*"
pm extxt uploadfrag exon/source/rekeyed/word/dec16/edb-117-155.odt
pm extxt uploadfrag "exon/source/rekeyed/word/dec16/edb-*.odt"
pm dptext unit 4 entry 141a1

1. regen index and clear caches on the stg server
2. regen Wordlist
    2.1 Excel
    2.2 CSV for offline DB
    2.3 Instruction on how to upload it in access and crosstab
3. regen PDF of text
4. regen plain text
5. regen segments


[DONE] Word List
    . create a form to select what we want from the Word List

. Import revised transcription fragments
    . Not all { are converted to interlineation:
        e.g. 7a4: {Barones is plain {
            {dimidia isn't 
    . 9a7: {d <ignum> : too much margin before <

. Word List
    . http://localhost:8080/lab/wordlist/?l=full&format=csv&analysis=1
    [REPORT] Correct entries
    [REPORT] fix errors with words stuck together and special chars
        abbasSanctae, 275a1 = joint in the Word Doc
        abstulitSancto, 258b3 =>
        => happens with a handful of sanct* words being joint to the previous word 
        aHas, 351a1
    . still special chars in the expanded text
        coliƀertos, 99a2
    [?] <span data-dpt="abbr">collegert̃</span><span data-dpt="exp">colleger<i>un</i>t</span> <span data-dpt="abbr">geldũ</span><span data-dpt="exp">geldu<i>m</i></span>
    [check] barro-|nes is encoded barro-<span MS>|</span>nes
        . how is that indexed? => cesure is removed before indexing; see digipal_text.models#get_plain_content()
        [OK] why is it encoded like that?
    . Export to Excel
    . Send to Eleonora

Transcription version 2:
    Points to Note:
NO 6. All letters and words occurring in angle brackets 〈〉 should be in italic, because thay are not in the text but supplied by the editor.
NO 13. The hand of the GDB main scribe is found in entries 153b1-2 and 436b1-3. I have used a different type-face, but an ugly one. Can you choose something different but better?
() 1. I have removed all occurences of [---] and […] which were used to indicate erasures and blank spaces respectively. The [---] survives to mark an erased entry after a paraph.
() 2. The first SOM hundred list on folios 63b-64a is, as Chris has pointed out, arranged in columns. I have renumbered it and laid it out in tabular form. It will need converting and the grid removing, but it should remain in columns.
() 3. I have also renumbered folio 228, after we decided that the heading CORN’ was contemporary. I will bring the corrected Ellis photocopies with me to London for the next meeting.

[DONE] 4. I notice that the ÷ symbol remains in the text. It should appear as est (in italics).
    GN: b/c/ conversion expected '[est]' to follow ÷
[DONE] 5. In a few cases an ampersand (&) begins a new sentence. I have converted these to italic Et. They appear thus in my text and need to be kept as such.
[NOT FOUND] 7. In Iohanne, Iohannes and Iohannis the ħ appears to have remained. It should be a plain h. Is it possible to spot and convert all such instances?
[DONE] 8. Similarly, the ᵬ symbol seems to have survived in some cases, where it should have been converted to a plain b. I noted 97b1, 97b4, 98a1, 98a2 98a3 (x 2) 99a2, 103b2, 509b2, but there may be others.
[DONE] 9a. I noticed nem9usculi on 152a2, where the 9 should disappear 
[DONE] 9b. and praati on 196b1 where the second a is a superscript and should disappear as it has in all (?) other cases.
[DONE] 10. We are used to an ampersand being used as a word termination, thus, ten& becomes tenet. The tironian nota (7) is also used like this sometimes (ten7 becomes tenet) but I noticed that on 141a1 the 7 was not reproduced as part of the word. In my original there was: Hã[n]c ten7 Folcheram9[us].
    . display et by default, display 7 as TIRONIAN if user wants it
        54b1 u'lib7'
        54b2 u'lib7'
        55b1 u'lib7'
        56a2 u'lib7'
        141a1 u'ten7'
        355a2 u'ti7'
        419b1 u'lib7'
        503a8 u'ual7'
    . 
[DONE] 11. In 117a3 clamat was struck through in my original: Cũ[m] hac mansione clamat {habet} ep̃[iscopu]s, but that has not come out in the finished text.
[NOT FOUND] 12. An occasional superscript 4 survives as an abbreviation sign. All should be eliminated, but not, of course the 4 in folio references etc.
[DONE] 14. I may have failed to update you on the h-with abbreviation sign. The lower case is unicode 0127 (ħ) and the capital is unicode 0126 (Ħ)

PLAIN TEXT version: remove all italics and all brackets, underline and strikthrough

Outcomes.

1. It would be good to have a new wordlist, if possible, before your work ends, and (possibly the same thing) all the information from the wordlist laid out on an Excel spreadsheet, with two blank columns on the left-hand side. These are to indicate (a) if the word is an ordinary one or a personal name or a place-name, and (b) the head form for the diverse spellings to be used in indices and lists
2. It would be useful to have a version of the revised text.
3. It would be surprising if there were no more corrections to be made, but if anything is noticed, I will list it for a final session, possibly done by me on the master text itself.

FRT 
6.12.2016


TextSeg 2.0:
    . improvements:
        [DONE] concurrent editing level 1 (due to chaneg to particular patterns)
        [DONE] concurrent editing level 2 (due to date check)
        [DONE] interface is up to date all the time, no need to press update
        . name spaces
    . refactoring
        . JSON storage    
            [DONE] use KeyVal to store the patterns in the database
            [DONE] convert legacy data structure
            [DONE] id:
                generate new id if none
                more compact? recordid-relid (relid is a counter)
            [DONE] decide array or hash?
            . order?
            (). data structure version?
            [DONE] session data:
                . conditions
                . search options
                . selection
        . rest API
            . improve API: get, set, search
            [DONE] get all patterns
            (). set all patterns
            [DONE] set a pattern
            [DONE] apply patterns
        . new UI with vue.js
            [DONE] show list of patterns
            [DONE] show a pattern
            [DONE] select pattern
            [DONE] edit a pattern
            [DONE] save session, directly
            [DONE] save changes to server
            [DONE] delete a pattern
            [DONE] add new pattern
            [DONE] Show results
            [DONE] message
            [DONE] validate patterns on the fly
            [DONE] use compact form
            ** Grouping
                [DONE] expand-collapse
                [DONE] show stats per group
                . add to group
            [DONE] apply conditions
            [DONE] conflict detection
            * generate slug automatically from the title
                . change as long as they don't deviate
            ** expose internal patterns
                [DONE] add when loading from legacy
                    . helper_P
                . recognise _ as group separator
                    [DONE] in UI
                    . server side
                [DONE] convert references <P> -> helper_P 
                [DONE] validate references 
                [DONE] special pattern: <Ps>
                [DONE] don't apply helpers
            * reorder patterns
                . can't move group after another
                [DONE] pb1: need to move groups as well
                [DONE] prevent dropping in the middle of a group
                [DONE] reordering?
                [DONE] pb2: need to be able to move without clicking first
                [DONE] pb3: the li won't move to all possible places
            . bulk conditions:
                . exclude other|all pattern in group
                . ignore other goups
            * add ad-hoc segments to group
            [DONE] error management
                [DONE] server error
                [DONE] invalid pattern expression
                . duplicate keys
                . wrong references
    . use namespace
    . problems:
        . avoid request each time blur... check if value actually changed
        . conditions change not immediatelly reflected in the the patetrn list
        . GET may actually add a new pattern, not very restful behaviour
        . the way the changes are transfered to the server has some issues:
            . lots of small requests
            . data is updated twice: by the user action and then the response
                from the server. Make sure this doesn't cause two redraw. 
        . expansion of groups of patterns and change in conditions don't 
            trigger a redraw -> vue.js not listening to new items added to object
            under data. <- not listening to those changes?
        . very slow rendering of long list of results
            . due to adblock plugin!
         

Todo:
. navigation
    . toc above images
    . toc above text editor?
. UI
    [DONE] remove rekeyed text
. patterns:
    . detect concurrent changes


These are probably matters for the next team meeting but I wanted to record my thoughts now before I forget them.

1. How do I edit the scribal profiles? They are currently in draft form and will need tidying up, amplifying and aligning with the rest of the database (e.g. name-forms) before the website is ready for general release.

Next, please see the screenshot attached.

2. The Codicology tab links straight through to the 3-screen view of image/text/translation. You probably are aware of this already but I thought I should mention it.

3.  I suggest that we think seriously about the TEXTS tab. I imagine that that's a simple matter of typing in a box,
so not an issue for you at all. `Texts' here means something like `view', but to most of the users of the website
the word`text' means something equivalent to `type of entry'. They will expect it to refer to the original contents
of the manuscript, not to supplementary information which we have provided. Version/information/source/resource/view
might be less confusing.

. patterns:
    . detect concurrent changes
    . fix bug with the creation of a new pattern

--
Pattern analysis
--

Problems:
    Quality TEXT: e.g. et dimidia et dimidia, htenuit, [---]
Question:
    Where should the categorisation into variants occur? the patterns or subsequently with database query about the pattern content?
    Related question: how strict are the patterns and what is the logic for having multiple patterns that cover similar type of formulas

qua Eduuardus rex fuit uiuus et mortuus
qua rex Eduuardus fuit uiuus et mortuus
reddidit gildum pro hida et dimidia

#232b3


TRE Holder: do we separate them off?



BNF
    Upgrade
    Time estimates
    Send email
MOA
    [DONE] Publish to STG
    [DONE] Ask for review -> Confluence
    Publish to Live
EXON
    Patterns
        finish all patterns for first two entries
        send email with explanation and offer to meet

<person> (habet|habuit) <number> mansionem

Guides:
use et not 7
use u not v

Duplicate transcription entries!
226a5
230b4
242a2
263b3
264b4
345a3
445a2
453b3


. Pattern detection
    . UI
        [DONE] Show patterns
        [DONE] Edit patterns
        [DONE] add drop down with condition about the pattern: |ignore|include|exclude
        [DONE] show the units
        [DONE] show the formulas
        [DONE] highlight formulas in text? (pb if overlap!)
        [DONE]. stats: show % for each pattern
        . Compact Pattern List:
            [DONE] expand only one selected pattern in the list
            [DONE] show condition in the collapsed view
            . edit condition in the collapsed view
            . change all conditions in one go
        [DONE] reorder patterns
    . Server
        [DONE] Define the rule model
        [DONE] select only transcription and specific range
        [DONE] basic segmentation
        [DONE] pattern error management
        [DONE] apply pattern conditions
        [DONE] cache the entry extra data instead of querying the DB for each record
        ** expose facility patterns
        . detect matches which are too long
        . detect overlaps
            . apply smaller patterns first? 
        [DONE] numbers: et dimidia: #232b3 "reddidit gildum pro i ferlino et dimidia"
        . save patterns as a single json object: easier to update
    . General
        . add pattern types
        !!!! Find all variants of a pattern with stats
    . Bugs
        [DONE] why does cache.get return None? Because default cache is dummy and forgetful.
        [DONE] . why does Entry.objects.all() go through each unit twice?! Translation and Transcription units!
        [DONE] . why does plain_contents[unit.unitid] return the wrong entry? See above
        !!!! Prevent overwriting old patterns
        . conditions are easily lost
    . Xtras:
        [DONE] Ajax load to speed up iterations
        ! state transition matrix/Markov Chain
        . API
        . Dockerise (separate instance for API and Client)
        . Vue.js

. Pattern discovery:
    Aim: we have a very formulaic corupus and want to semi-automatically discover frequent patterns and their occurences
    Methodology:
        . normalise spelling and word variants in the text to have broader patterns
        . replace pattern variables with label: numbers, dates, names (places, person)
            . using regexp for numbers, capitals for names
            . but capital is not reliable so may have to categorise based on most frequent spelling
        . Create coocurrence matrix, Markov model of degree 1 or 2
        . then what???

[DONE]. annotations with different coordinate systems
    [DONE] change the OL3 coordinates to be compatible with OL2
    [DONE] data migration script to convert existing OL3 annotation to new system
    [DONE] hide text annotations from annotator
    [DONE] hide graph annotations from text viewer

    . e.g.
        . http://localhost:8080/digipal/page/3200/
        . [Xleft, Ybottom]
        . salutem: {"geometry": {"type": "Polygon", "coordinates": [[
            [2221.6762980702492, -251.55895691609987],
            [2221.6762980702492, -423.54314174649465],
            [2442.432117404786, -423.54314174649465],
            [2442.432117404786, -251.55895691609987],
            [2221.6762980702492, -251.55895691609987]]]}, "type": "Feature", "properties": {"elementid": [["", "clause"], ["type", "salutation"], ["@text", "salutem"]]}}
        . address: {"geometry": {"type": "Polygon", "coordinates": [[[590.5013244364804, -200.60866912362624], [590.5013244364804, -430.33795150713377], [2428.3355835045404, -430.33795150713377], [2428.3355835045404, -200.60866912362624], [590.5013244364804, -200.60866912362624]]]}, "type": "Feature", "properties": {"elementid": [["", "clause"], ["type", "address"]]}}
        . dispo:   {"geometry": {"type": "Polygon", "coordinates": [[[538.1924198250731, -217.34693877551027], [538.1924198250731, -1407.580174927114], [3177.405247813412, -1407.580174927114], [3177.405247813412, -217.34693877551027], [538.1924198250731, -217.34693877551027]]]}, "type": "Feature", "properties": {"elementid": [["", "clause"], ["type", "disposition"]]}}
        . S of salutem: graph=223
            . {'type':'Feature','properties':{'saved':0},'geometry':{'type':'Polygon','coordinates':[[[2380,3045.8750000000055],[2380,3218.3750000000055],[2542,3218.3750000000055],[2542,3045.8750000000055],[2380,3045.8750000000055]]]},'crs':{'type':'name','properties':{'name':'EPSG:3785'}}}
        . OL2: projection = EPSG:3785
        . OL3: projection.code = ZOOMIFY
        . =>
            . in TV, if geo_json.Y < 0, Ybottom = Height + Y
            . in annotator, if geo_json < 0, Ybottom = -Y (i.e. below the bottom if the image)
            . why is it intepreted differently? *OL version diff or diff settings?
            . why are the Y obtained from OL different?
    . map
        . view
            . projection
                . code: EPSG:3785
                . unit: m
                . axisOrientation: enu
        . layers
            . ol.layer.Tile
            . ol.layer.Vector
            . layer
                . source (e.g. ol.source.Vector)

Codicological Model


1-281 + 495-525



[DONE]. show sequence with properties

[DONE]. show all basic properties
    [DONE]. H
    [DONE]. W
    [DONE]. Number of ruled lines
    [DONE]. H text
    [DONE]. W text
    [DONE]. Quire
    [DONE]. locus

. missing data
    [DONE]. quires
        [done] 80% from cod. desc.
        [done] rest can be obtained from Ker's table
            see: pm extxt csv2quires exon/source/analysis/working/quires.csv
    [DONE]. hundreds
        . autocomplete based on other (shire, hundred, vill) tuples?
        -- Fill in missing hundred name
        update exon_master
        set exonhundname = hundred
        where exonentrytype = 'F'
        and length(exonellisref) > 1
    . ruling space
    ***. alternative locii
    (). separate folio number and folio side
    * . quire structure (see Ker, also the cod desc for singleton)

[DONE]. sticky headers
    . stickiness on scroll
    . offset the scrolling position to show the page with clicked on in the scrollbar

. jump to next discontinuity for the selected property

[DONE]. highlight discontinuities

[DONE]. represent values in a way that helps spotting discontinuities

[DONE]. show discontinuities next to scrollbar

. alternative order based on properties
    ** . sorting if single column with locus
    . glob opt of quires
        . operators adapted should move entire quires not individual pages

** . comparison of two sequences

[DONE] . work with only a section of the document

. clustering!

Optional

. contextual info
    [DONE]. add image preview
    . add codicological desc?

Case studies:
    Investigate highlights in Written Height and Parchment Side


----------------------------------------------------------------

MOA

http://localhost:8080/digipal/manuscripts/650/texts/view/?above=location/face/&center=transcription/sync/location&east=translation/sync/location&north=image/sync/location#text-viewer

http://localhost:8080/digipal/manuscripts/650/texts/view/?above=location/face/;subl:%5B%5B%22%22%2C+%22clause%22%5D%2C+%5B%22type%22%2C+%22disposition%22%5D%5D&center=transcription/sync/location&east=translation/sync/location&north=image/sync/location#text-viewer



https://confluence.dighum.kcl.ac.uk/display/MOA/2016-02-17+PAS,+GN+and+SJB

Add clause facets to text
NB limitations: eg. if you want a single bar per document, then can't filter by text in a given clause

Popup on mouseover:
    Ideally have different content in popup depending on result type
    Ideally have different tabs in popup to allow user to set content
--

Bugs

    ** The search results for the visualisation need to be checked. I have noticed
    some weird issues: e.g. select an option under a facet and categorise by that
    facet => not all bars under that category are highlighted, why?
    Make sure the results are reliable, or as reliable as the underlying data.

    ** Date list showing up

    ** Viewer

--

7/4

Arranging results by date: The default setting for results orders by shelf mark.
When results are ordered by date, documents with date ranges use the mid-point.
 To arrange graphs by date, results must be changed in the table view first, and
 then they will be arranged by date in the grid view. SB suggested this could be
 made more obvious to users.

Intitulatio: This was decided as the most appropriate term (despite being the
only example of a Latin term). This, along with other terms (such as ‘arenga’)
will appear in the glossary.

Clauses: In the table view, ‘clause type’ should be added as a column so that
you can arrange results by clause type.

** Displaying faces only as default: to be completed.

Issuer: to be completed. Categories should be as follows: royal, episcopal,
papal, other ecclesiastical, private. The ‘Hammond numbers’ can be used to
establish most groups: see http://www.poms.ac.uk/information/numbering-system-for-documents/.

Date and summary of MS: to be added to all image page below shelf mark

Medieval archive: now called ‘institutional beneficiary’. Dates of foundation
have been removed from names that include it, e.g. ‘Dunfermline Abbey (fd.1128)’.

** GN will experiment with different ways of presenting the bars to make closely
dated documents more prominent than those with large date ranges. These will then
be presented for initial feedback to the Glasgow team on Monday 6 June at 2pm.

    Ideas included: hatching the bars with long date ranges; having thicker bars
    for more precise dates; allowing users to filter by different dates (e.g.
    day/month/year, 5-year range, 10-year range). There was a preference for the
    latter.
    There is an issue with presenting results of graphs. At the moment they are
    attached to the bottom right corner of the bar. DB suggested having thumbnails
    presented above the barcode, and in a rough chronological sequence. The
    thumbnail would highlight the bar in the charter when you hover over it.

GN: in the table view, add a ‘clause type’ column so that you can arrange results by clause type.
GN: add date and summary of each MS to the image page below the shelf mark.

--

Requests from the project team:

    [done]

    Don't hide histogram when "all records" are hidden.
    New search with "save copy":  keep old results in original colour. (ii) Explain
        the meaning of combined colours on screen – 3 or more searches, colour combinations become confusing.
    Use slider rather than numbers for scale on visualisation settings.
    Add "remove" to each search query.
    [done] Use "Hide" and "show" rather than "visible" "hidden"
    For "save copy", have "new query" as a separate button. Remove "save copy" option.
    [done] For "Count", use ? "Hits" or "Total"
    [done] For "Color" use "Colour"
    Results display filter only working for document type. On attached screenshot, document types are being included in medieval archive view.
    [done] Also, we think only the following filters would be useful: Document type; clause type; medieval archive; issuer; issuer type.
    When searching for graphs the links to document images highlights random letters, and not the ones searched for.
    How will combined searches for graphs be displayed? At the moment only one thumbnail per document is visible.
    Add reset button.


TOC

[OK] change all the ampersands (&) to italic <et>.

There are two slight complications here.
[OK] One is ual&{ent} in 270a1. Here the ampersand has been underlined by me as it is replaced by the {ent}.
So the resulting italic <et> should also be underlined.
* Similar, but not identical, is ual&{en〈t〉} on 271a2. This is my stop-gap until we turn the <&>
into an italic <et>. In effect the {en} belongs in the middle of the ampersand so the result should
be uale{n}t, with the <e> and the <t> being in italics as they are halves of the converted ampersand.

* A letter <q> has appeared with a wiggle on the left
as opposed to the ordinary letter struck through which is <q>.
This “q with a wiggle” is represented by a <ɋ> which is Unicode 024B.
This appears in ɋ:[uae] and ɋ:[uam] and ɋ4[uae]
Obviously, as usual, the <ɋ> becomes a normal <q> and the colon (:)
and the figure (4) are lost and what is in brackets becomes italicised,

---

Done:
    fixed some important problems with the excessive resource usage by the framework on the server
        which made the site crash, run very slowly or fail to index the content for the search page.
    worked on porting the visualisation from MoA to Exon
    automatically detected the pages in the images, which means that the thumbnails show the page only
        ** the viewers will benefit from it by showing the meaningful portion of the image
    * working on usability enhancement of the text viewer
        [done] scrolling issues
        ** navigation: prev / nex
        * sync will work differently:
            One location for the whole TE at the top
            By default all panels are sync'ed with that location
            Sync is BOTH WAYS, so moving in one panel will move the master location
            Possibility to unsync and go free
            => MUCH SIMPLER UI, enables bidir sync, - can't sync a-b then c-d
    ** working on the TOC

Bugs:
. entry search results
    [done] quire not showing
    [done] hand not showing
    [done] Entry type facets is like the TIC facets
[done] empty hands and texts results
.
search history
poms document url

.

Bug with segmentation of the text fragments: it doesn't return the closing tag </p>
=> A new one gets added on save: => </p></p>
=> Breaks the templating system for the codicological desc because it expects a </p> when remonving the locations

---

Text conversion:
    Converted ƥ -> p in expansions
    Removed space after hypenation
    Convert & -> et (in italics)

Visualisation for MoA
    [done] add a new view to the faceted search result page
    [done] show clauses with Y=clause type and X=date range
    [done] compute Y after Xs
    [done] stack date ranges! [1]
    [done] remove empty vert space
    ****. clean up dates [2]
    [done] category selector .5
    [done] add labels to axis
        [done] x
        [done] y
    [DONE] . add hover with info 1 [1]
        * . add label
        . snippet/text
    . fix the scaling and proportion of the canvas
        . use bigger marks for the data points
            . use range for dates
    [done] add hits for each cat and
    [done] add % bar for categories
    [done] date projection of the hits
    [done] click -> link to record

  Eclipse Quick Bookmarks   1.2.1.201404032042  to.etc.eclipse.editor.bookmarks.feature.feature.group   domui.org
  LESS  1.0.22  net.vtst.ow.eclipse.less.feature.feature.group  Vincent Simonet
  LiClipse  2.0.0.201504092214  com.brainwy.liclipse.rcp.product    null
  Tail Console  1.0.1   name.schedenig.eclipse.tailconsole.feature.group    Marian Schedenig
  TypeScript    1.7.0.v20151201-1631    com.palantir.typescript.feature.feature.group   Palantir Technologies, Inc.

. calibrate the mark up
    . display settings for image
        ** . discreet markup
            . only box the selected feature, but with less vivid colors
        . visible markup
            . show current view
            . change yellow to something more visible
. text-image linking
    [done] . not selected when the image is just loaded
    [done] . click -> load and zoom on image:
        . when click on entry number in text
        . when load the entry number in the text panel
    . load entry in text
        . when click on entry in image
            . harder: because panels are synced one way only
. navigation:
    *. on page load, zoom to the smallest frame comprising all the boxes
    * scroll up to sublocation
    . pgup / pgdn
        ** . don't move web page
        ** . same with mouse scroll
        . go to previous/next unit in the sequence
        . on image as well
    . shift pgup / pgdn
        . go to previous/next unit in the sequence
    . expand one panel
    . features obstructing nested ones or ambiguity with partial overlap
        . reorder the features so we can click on nested ones
        . better would be to focus on the feature with nearest center
            among all features intersecting with the pointer
    . switch location type doesn't trigger a reload of the content
. show images in the search results for entries
. bugs
    [fixed] . bug when clicking the entry number in Exon, it loads the wrong page
        . the panel location wasn't passed when syncing from the mouseup event
        . ok but might be an issue if the panel is synced...
    [fixed] . click on any dpt- element would be synced: not efficient
         . only clause, person and location are synced
    [fixed] . change location type doesn't reload panel content
    [fixed] clicking on 1b1 when address is whole or 1r or 1a1 won't load the right image
    . text: whole; image: synced and showing face; user clicks clause on dorse => not loading it
    . sync always generate a request from the image panel
        . ok: except when addres = 1r and click on entries
        . ko: change @ from 1a1 to 1a2 => reload
        * . ko: click from 1a1 to 1a2 when @ = whole => reload

approx 2 mins for 6 entries
=> 3000 / 6 * 2 / 60 => 16 hours => approx. three days
=> TO: 816 => 5 hours

--------------------------------------------------
eta
Invalid format
{'note': u'', 'x': [], 'extent': u'465r2v7', 'hand': 'eta'}
--------------------------------------------------
sigma
Invalid format
{'note': u'', 'x': [], 'extent': u'9r7v10', 'hand': 'sigma'}
--------------------------------------------------

Odd stuff in stints desc:

    Alpha: 110v18 but 20 lines on that page. Cod desc also seem
    CORRECT! Page written by three hands: epsilon (lines 1-8 and 18-20), gamma (lines 10-17) and alpha (line 18).

-----------------------------------------

Graphical Annotation on the Text Viewer Image Pane

. drawing actions:
    [DONE] draw box
    [DONE] select box
    . transform box
    . move box
    [DONE] delete box
    . (copy box)
    [DONE] select multiple boxes
    . undo
. persistence:
    . image editing mode
    . display selectors:
        . e.g. 1 annotation | markup/clause/address/1
        . : <annotation selection> | <definition>
    . create new table: TextViewLink
    . save box
    . display saved boxes

-----------------------------------------

[DONE] display settings
    margin
    line breaks

[DONE] Fix the sync

(1) the p and the q  are not real letters but created by me by using a strike through.
This is entirely my fault. At the moment these do not appear in the text at all.
I suggest replacing the p with ṕ (unicode IE55) and the q with a ƣ (unicode 01A3).
They will then appear as p and q in the final text.
The ṕ should appear before all occurrences of ro as a separate word in italics.
Restoring the ƣ is more complicated. I would happily do both these operations on Sunday morning and send a new text to you
(I'm away this afternoon and all tomorrow)

See 12b1: defendit se #p#ro .x. hidis. exceptis consuetudinibus #q#uae ƥertinent ad firmam

(2) The machine does not seem to have coped with the occurences of qui+superscript i etc where
we wanted to lose the superscript to give plain qui.
Other examples are –rr (for rr –aa (for –a+superscript a) -ii (for i+superscript i) –oo (for o+superscript o).
It seems to me that you will need to instruct the programme to eliminate the superscripts, if that is possible.
If not, maybe we need a new way of dealing with these letters for the future.
I could go through mechanically and eliminate these spare letters from the text I sent you.
While we might manage a global to eliminate ii et cetera, we cant simply eliminate ii as that
would remove numbers (= 2) and things like denarii where the double i is part of the word, not a textual device.

    fixed, pb with sup/sub styles not detected properly

(3) All the line breaks (|) seem to have disappeared!

    fixed

(4) A few rogues remain in the finished text. I noticed some superscript 4s and also some ᵬᵬ (for bb).

    GN: ᵬᵬ found in beginning of 23r, converted to b but why is it not expanded? Isn't ᵬ an abbreviation mark?

    4 & 5

        reddit4e
            original contains both expension and abbreviations. Now removed.

        .iii. hidas. &4 dimidiam.
            That's an Ellis mistake, there is no abbrv. mark in 9b3

        §20a2 In berę hundr& st̃ .xlix. hiđ 7 .i. uirga. Inde h&5 rex .
            where is the 5 coming from? not in rekeyed text
(G1) double strikethrough
    9a7: Barones regis. =de his h[abe]ñt= .xxxv.
        => seems to be dashed underlined in MS and Ellis but not in RT
    §[9a2] In hund de Stafort st. c. 7 .v.. hiđ[ae] =7 dim4[idia]= Inde
        => single ST in Ellis, thivk in MS
    PB1: double-strikethrough in MSW is exported as an empty class in XHTML which is ambiguous
        this is because there is no CSS equivalent
        => one solution would be to use dashed underlined or single-strikethrough
        => could manually set class T5 to strikethrough
        => PB1.1: single-strikethrough is used for special chars such as p and q
        => PB1.2: the span doesn't surround the whole word, it is split around the superscripts, etc.
            Which will disrupt the conversion because the words are split across spans


gnoel@digipal2:~$ sudo strace -p 27948
[sudo] password for gnoel:
Process 27948 attached - interrupt to quit
restart_syscall(<... resuming interrupted call ...>

Bookmarks

    http://localhost/digipal/manuscripts/1/texts/view/?east=transcription-sample/locus/1r/&center=transcription-sample/locus/1r/&north=image/locus/1r/&#text-viewer


1. convert MS Word into XHTML
    1.1 Used MSWord 360 to save as html page (NOT single page) with utf8 encoding
    1.2 convert to XML/TEI
        pm dpxml convert exon\source\rekeyed\word\july\sample.htm exon\source\rekeyed\conversion\whtml2xml.xslt > exon\source\rekeyed\word\july\sample.xml
    1.3 use existing XSLT to convert to XHTML
2. import into DB
3. rendering
4. abbreviated rendering
5. save layout and @s into URL
6. load ... from URL



Upper Left Triangle
Geometric Shapes
U+25F8 &#9720;


http://www.tei-c.org/release/doc/tei-p5-doc/en/html/MS.html

Codicology
    [DONE] Insert template into empty entry
    [DONE] When saving, keep entry empty if same as template
    Markup some template element
        q
        ?*ink/pencil
        hand
        (@type borrowed from dimension but dimension content is strictly a dim value)
        coddesc
            object="perforation" property="count"
            object="perforation" property="shape"
            object="perforation" property="location"
            object="column" property="count"
            object="written-block" property="size"
            object="ruling" property="size"
            object="ruling" property="count"
            object="ruling" property="distance"
            object="ruling" property="method"
            object="page" property="color"

            object="quire|folio|line|page-area|side" property="location"

    Can't turn status to X if there are $ left
    Button to move to the next dollar sign
    pgn down/up

Fix the layout bugs with the scroll bar appearing on the right of the image.

() Fix slug

1. implement PanelText
    display text fragment
    rendering
        add buttons to show/hide parts of the mark-up
            clauses
            expansions
            deleted
            by default: plain text with deletion struck, expansions in italics and supplied in [].
        add button to see all markups with labels (like write mode)
            only for editors
            by default
2. show it by default
3. add a pencil button to switch to write view
    only for editors
[DONE] 4. add a status drop down
    [DONE] for editors only
    [DONE] save immediately
[DONE] 5. add order to status table

! text not shown on opera: http://localhost/digipal/manuscripts/553/texts/view/#text-viewer
! V-scrollbar appears next to the image

Set up live server for MOA
MOA 66 - CT visibility
     DP:    - Text
     MOFA:  - Scribe, Hand, Graph
     EXON:  - IP, Scribe, Graph

     Affects:
        [DONE] Faceted
        [DONE] Adv. Search
        [DONE] Browser
        Record vis
            [DONT] IP
            [DONE]  Tabs
            [DONE] Images
            [DONE]  Tabs
            [DONE] Text
            [DONE] Scribe
            [DONE]  Tabs
            [DONE] Hand
            [DONE]  Tabs
            [DONE] Graph on the Image annotator page
            [DONE]  Tabs

Review Faceted search customisations
    MOA
    Exon

[DONE] 1. find structure in form
[DONE] 2. map structure to DP data model
    Hand
    HandDescription
        +Label
        Description
    Stint?
[DONE] 3. modify DP data model
    + HandDescription.label
[DONE] 3.1 Add tinymce to admin
[DONE] 3.2 Paste text from word and remove all elements
4. mark-up text
    [DONE] Formatting & Structure
        [DONE] H1/H2/H3
    + improve the H1
        [DONE] auto mark-up with button
        () render as h4
        () generate the number automatically
    Fields
        () Idiosyncrasies
        [DONE] Stints
        ! prevent double markup
    Soft References
        [DONE] Scribe/Hand
    [DONE] Render char in italics and bold?
[DONE] 4.5. display links on front end
[DONE] 4.6. Assign images to hand based on the stints locations
[DONE] 5. locus: automatic detection
[DONE] 6. display description on front end
Search menu links to faceted search page
[DONE] Convert characters to link to search page
Add missing detectable characters
7. Convert DigiPal & co data to the new format
    Data
        [LATER] Hand.ker/... -> HandDescription.Label
        !! Description:
            conversion script TEI -> new XML format
            make sure all the TEI elements are supported and have a button
    Forms (admin)
    Display


Scribe/Hand
    Project ID
        1
    EXON ID
        U-1
    Flight�s siglum
        alpha
    Locations
        Content (= General description of the locations)
            Found only in Wiltshire geld accounts.
            /
            Only Devon entries.
        Stints
            Flight
                175 (+1)
            || Stint
                Location: e.g. 29v14-16 (Q.6) or 263r1-4r20 (Q.54) or 37v3-19; 38r1-7 (Q.7)
                Note: Very similar to 'iota' + Identified by Webber (1989, p.12) as 'zeta'
    Main idiosyncrasies
        v-shaped cauda in e and q; -us suspension detached from letter on top of which is supposed to be; finishing strokes on baseline r and s.
    Other relevant info
        Very few stints, but some are rather long. F found on margin next to beginning of each entry. Not exclusive to this scribe (quires 48-54)

        Probably author of unidentified stint on 61v18-20 [OF287v]
        /
        No use of round d; no use of et nota; frequent erasures, corrections and insertions
        /
        No use of ampersand; frequent erasures and corrections. Probably author of unidentified stint on 373r3-14 [OF11rv]

        5 full pages (20 lines each).

        Second part of line 13 and lines 14 and 15 are clearly the work of �eta�. The first (10) words may initially seem the work of a different hand, but after detailed analysis they seem to be by �eta�: overlines; e-cauda; ampersand; shapes of a, t; tail of g is uncommon, but occasionally found in �eta� (520r1 and 4, 522v12). Gallows mark by �mu� however.
    Identified?






        http://localhost/admin/digipal/hand/2/
        http://severedheads.bandcamp.com/album/cuisine-w-piscatorial

TODO

1. upload images
    . need to create ssh connection
    . port issue: 2222 -> 22 on b2d doesn't work, windows not listening to 2222
    . b2d listening for 2222
    => VB port mapping not working OR b2d blocking port.
    . same with 8081, used to work though
        . removing port from VB is effective immediately, but not when adding
        . port still not available after saving then starting machine or powering it down and restarting

2. convert images to compatible format
3. check manual upload format
4. pack up the VM & move it to the server
5. send instructions on how to download and use it

http://localhost/digipal/manuscripts/553/texts/view/#text-viewer
http://localhost/digipal/manuscripts/199/texts/view/

XML-HTML -> XML

    <span data-dpt="tag" data-dpt-attr1="val1">content</span>

    ->

    <tag attr1="val1">content</tag>

XML

    H<expan>enry</expan>
        () H<expan abbrev="">enry</expan>
        Different from TEI

BOTH

    invalid location or error
        reset the content of the panel, prevent edition


    Save the name of the last person to save the text
    Save the person in the backup as well

    Pipes
        auto-markup: convert them into span
        key press: convert them into span
        display spans as pipe (content)
            as line break as well (toggle it on/off)


    () . read only mode

    () Image Panel
        zoom inset on click
            OR zoomify
        !!Bypass image size quota:
            Zoomify?
            Open Layer?

    () Addressability
        Expose and resolve URL leading directly to translation or transcription

MOFA

EXON Progress

    Points for the meeting
        Manual Review of the mark-up and segmentation
            Easy export of the XML for review
            Export of the entry numbers

EXON

    1. folio numbers
        load/save folio text
        sync with images
        drop down to say if we want to sync of not
    [DONE] 2. save changes
    3. pg down, ...
    4. show snippets on search results


    !!!
        enforce structure:
            flat structure: p and no divs
            p at the top level
            locations within ps

    If select 520, show 520, 520a1, ...
        e.g. 210a exists but 170a not

    Bug with segmentation
        4 hides under 14a1 is interpreted as an entry number
        Search for 4

    [DONE] Upload text

    Improve the loading of the locations:
        request and refresh the locations each time the location type is changed

    customise
        the buttons
        the conversion of the notations (), [] etc.
            [DONE] <p style="margin-bottom: 0cm;">&nbsp;</p>
            [DONE] <span style="text-decoration: line-through;">of these</span>

    Split long texts into small parts
        [DONE] mark up scheme
            entry
            folio
            section
        [DONE] splitting by entry
        [DONE] pull locations from database
        [DONE] display one piece
        [DONE] location change

    Mark up
        entry
        folio
            automate the sequence update in case of change

    Sync images and text

    Search
        show hits
        go to specific location

    () Attach information to an entry
        people
        places
        etc.

    ? mark-up records
        person
        place
        Q: should we use an intermediary record to represent any type of entity? There are some commonalities among rec types such as normalised name, name before and after conquest, etc.
        Or do we link directly to a Person/Place record?
        Q: what about the distinction between identified entity and occurrence of an entity name?

PUBLIC VIEW

    ***** DON'T SHOW THE FULL SIZE VERSION OF THE IMAGE!
    Switch edit/view

BUGS

    Make sure we can't save the content before it is loaded
    What if you edit the same text in different panels?
    Fix the slug in the admin:
        the slug should be read only
        for the moment we always update the slug automatically on save
    TinyMCE will not work well (setContent and editing mode fails) when the panel is collapse at the time of the loading


Presentation
    resizing a panel doesn't work smoothly when the mouse goes over TinyMCE
    Fix the panelset being a few pixels too tall
    Layout switches
    Put the digipal style sheets back
        put them back
        fix the banner/nav
    [DONE] relative size of the panels. e.g. 50% split centre and south
    Improve the layout so if the set ratios are preserved even when resizing the browser window
    (Re)design:
        decide if the layout is completely managed by the viewer
        would be nice if west is on the left of south: that would require to nest one layout inside another
    BUG: when you close the south pane the iframe managed by the nested tinymce will loose the content of its head and body.

Improvements
    Panel asks for location list and types. Populate and show controls accordingly (e.g. Text may not want to display it at this stage, Image only shows locations not types).
    Status messages should come from the server?
    auto-save before large operations

    saving
        saving bugs
            requirements:
                don't count loading as a modification of the text
                don't save too many times
                save all changes

            method:
                use on change event on tinmyce
                    => not triggered until the cursor is moved out of the current line
                        e.g. append chars at the end of a line => nothing, move cursor up => triggered
                        => we may miss changes if the user closes the tab after writing
                compare the size of the content every x seconds
                    => it won't catch modifications which preserve the same length
                    => not the most efficient as we have to get the content each time that's extra processing
                use both
                    => save is triggered twice

        regular saving
            avoid simultaneous savings
            avoid too frequent savings

        [DONE] backup button
            add a new table: TextContentXMLBackup
            add a button to save to this table


Performance
    The full Exon translation (experiment with FireFox):
        can be added with tinymce, pasted from Word it will strip almost all styles and keep minimal HTML
        pasting takes a long time (~20s) but it is decent given the size of the text however it freezes the browser and we can get javascript performance warnings
        the size is 310KB
        loading the text takes just 150ms but setting it into TinyMCE make the browser freeze for a few seconds
        sending the text and saving it to the DB takes less than 1 seconds however the browser tends to freeze and be very laggy after a few operations

Maybe
    Image Panel
        layout selection (width fit, height fit, best fit)
    ? show address selector
    Let panels from different browser tabs communicate
        synchronise position
        edition + refresh views, etc.
    Name tables in the admin: in the future we may want to
        make the slug input writable
        keep the slug as it is even when the name changes
        but if the slug is blanked (or add an icon for that) we reset it.
    Generalise API:
        query for the list of locations and this can be handled by the custom function on server side
    Show status bar at the bottom of each panel:
        duration of the request
        icon to show the message in full

~DONE. Export to TEI (MOA
    DONE 1 Transcription
    DONE 2 Translation
    3 Customisation per content_type
    4 Documentation
    5 Check if valid TEI against DTD
    . generate a list of all possible markup with example and source
         ()1 [a href="#_ftn1" name="_ftnref1"] TCX #5 (IP #510)
         ()1 [br /] TCX #108 (IP #248)
        -14 [em] TCX #351 (IP #127)
       -174 [p] TCX #84 (IP #238)
       -143 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="address"] TCX #84 (IP #238)
         -3 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="arenga"] TCX #128 (IP #263)
        -10 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="boundaries"] TCX #305 (IP #17)
       -147 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="disposition"] TCX #84 (IP #238)
        -35 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="holding"] TCX #84 (IP #238)
         -3 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="injunction"] TCX #363 (IP #339)
        -63 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="intitulatio"] TCX #84 (IP #238)
         -1 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="malediction"] TCX #98 (IP #242)
        -11 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="narration"] TCX #351 (IP #127)
        -69 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="notification"] TCX #84 (IP #238)
         -1 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="prohibition"] TCX #361 (IP #710)
        -83 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="salutation"] TCX #84 (IP #238)
        -20 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="sealing"] TCX #61 (IP #602)
         -1 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="title"] TCX #276 (IP #5)
         -1 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="undefined"] TCX #350 (IP #192)
        -13 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="warrandice"] TCX #305 (IP #17)
       -143 [span data-dpt="clause" data-dpt-cat="words" data-dpt-type="witnesses"] TCX #84 (IP #238)
      -1143 [span data-dpt="ex" data-dpt-cat="chars"] TCX #84 (IP #238)
      -1768 [span data-dpt="lb" data-dpt-cat="sep"] TCX #84 (IP #238)
         -5 [span data-dpt="location" data-dpt-loctype="locus"] TCX #84 (IP #238)
        -32 [span data-dpt="person" data-dpt-cat="chars" data-dpt-type="name"] TCX #61 (IP #602)
        -40 [span data-dpt="person" data-dpt-cat="chars" data-dpt-type="title"] TCX #61 (IP #602)
        -89 [span data-dpt="supplied" data-dpt-cat="chars"] TCX #10 (IP #598)
    . for each one find a way to express it in TEI
    . then test them all

[DONE]. let the user resize and move the annotations on the Text Editor
    [DONE] Had to upgrade OL3 to latest version (3.18.2) to make use of Translate interaction
    [DONE]. Image panel broken on my laptop
    [DONE]. Impossible to select annotation nested inside the currently selected one (caused by OL3 upgrade)
    [DONE] The drawing interaction is broken
    [DONE]. Add a Translation interaction
        . Basic interaction
        . Only one save: at the end of the translation, not many times while the shape is draged around
    [DONE]. Add a basic Modify interaction
    [DONE] Make the basic Modify interaction that preserves the rectangular shape
        [DONE] Moving vertex reshape the rectangle
            . force a change to the feature geometry in a Modify translating event handler
            https://github.com/openlayers/ol3/issues/5095#event-601814603
        [DONE] show resize cursor when near a vertex
    [DONE] Add an editing mode to the image panel, similar to the editing mode on the text panel. This is to avoid accidental changes to the annotations.


http://localhost/digipal/patterns/?p_1_order=1&p_1_key=trw-holder&p_1_title=TRW+holder&p_1_condition=ignore&p_1_pattern=%5E.*%3F+(habet%7Chabuit%7Ctenet%7Ctenuit)+(%3Cnumber%3E)%3F+(mansionem%7Cmanerium)&p_3_order=2&p_3_key=tre-holder2&p_3_title=TRE+Holder2&p_3_condition=ignore&p_3_pattern=quam+(tenuit%7Ctenetuit%7Ctenuerunt)+(mater)%3F+%3Cperson%3E+(tegni+pariter%7Cpariter%7Ccomes%7Ccomitis)%3F+ea+die+qua+rex+(Eduuardus%7CEdwardus)+fuit+uiuus+et+mortuus&p_2_order=3&p_2_key=manor-name&p_2_title=Manor+name&p_2_condition=ignore&p_2_pattern=(q%7Cque%7Cquae%7Cqui%7Cquo%7Cquod%7Cqu%C3%A6)+(uocat%7Cuocatur)+%3Cname%3E&p_4_order=4&p_4_key=tre-holder&p_4_title=TRE+Holder&p_4_condition=ignore&p_4_pattern=(quam%7Chas)+(tenuit%7Ctenetuit%7Ctenuerunt)+.*%3F+(Eduuardus%7CEdwardus)+.*%3F+(mortuus%7Cdominum)&p_5_order=5&p_5_key=hidage&p_5_title=Hidage&p_5_condition=&p_5_pattern=reddi%25+(geldum%7Cgildum%7Cghildum%7Cgeuldum%7Cgueldum)+(tempore)%3F+(regis+Ea%3Fduuardi)%3F+pro+%3Chide%3E&p_None_order=10000&p_None_key=new-pattern&p_None_title=New+pattern&p_None_condition=&p_None_pattern=&units_range=&units_limit=800&action=update&jx=1

http://localhost/digipal/patterns/?p_1_order=1&p_1_key=trw-holder&p_1_title=TRW+holder&p_1_condition=&p_1_pattern=%5E.*%3F+(habet%7Chabuit%7Ctenet%7Ctenuit)+(%3Cnumber%3E)%3F+(mansionem%7Cmanerium)&p_3_order=2&p_3_key=tre-holder&p_3_title=TRE+Holder&p_3_condition=&p_3_pattern=quam+(tenuit%7Ctenetuit%7Ctenuerunt)+(mater)%3F+%3Cperson%3E+(tegni+pariter%7Cpariter%7Ccomes%7Ccomitis)%3F+ea+die+qua+rex+(Eduuardus%7CEdwardus)+fuit+uiuus+et+mortuus&p_2_order=3&p_2_key=manor-name&p_2_title=Manor+name&p_2_condition=&p_2_pattern=(q%7Cque%7Cquae%7Cqui%7Cquo%7Cquod%7Cqu%C3%A6)+(uocat%7Cuocatur)+%3Cname%3E&p_4_order=4&p_4_key=tre-holder-general&p_4_title=TRE+Holder+(too+general%3F)&p_4_condition=&p_4_pattern=(quam%7Chas)+(tenuit%7Ctenetuit%7Ctenuerunt)+.*%3F+(Eduuardus%7CEdwardus)+.*%3F+(mortuus%7Cdominum)&p_5_order=5&p_5_key=hidage&p_5_title=Hidage&p_5_condition=&p_5_pattern=reddi%25+(geldum%7Cgildum%7Cghildum%7Cgeuldum%7Cgueldum)+(tempore)%3F+(regis+Ea%3Fduuardi)%3F+pro+%3Chide%3E&p_None_order=6&p_None_key=new-pattern&p_None_title=New+pattern&p_None_condition=&p_None_pattern=&units_range=&units_limit=10&action=update&jx=1

xinput --set-prop 9 263 0.5


habet .*? <hide> (in dominio)? et uillani <hide>

